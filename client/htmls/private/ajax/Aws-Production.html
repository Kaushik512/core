<div class="row">

    <article class="col-sm-12 col-md-12 col-lg-12">

        <div class="widget-body" style="font-size:12px;">

            <ul id="myTab3" class="nav nav-tabs tabs-pull-left">
                <!--<li class="active">
                    <a href="#l1" data-toggle="tab">Domains</a>
                </li>-->
                <li class="pull-left active">
                    <a href="#l2" id="tabheader" data-toggle="tab">Choose Template Type</a>
                </li>
            </ul>

            <div id="myTabContent3" class="nav tab-content">


                <div class="tab-pane fade in active" id="l2">


                    <section id="widget-grid" class="">


                        <div class="row">


                            <article class="col-sm-12 col-md-12 col-lg-12">


                                <div class="jarviswidget jarviswidget-color-darken" id="wid-id-1" data-widget-editbutton="false" data-widget-deletebutton="false">



                                    <div role="content">


                                        <div class="jarviswidget-editbox">


                                        </div>

                                        <div class="widget-body">

                                            <div class="row">
                                                <form id="wizard-1" novalidate="novalidate">
                                                    <div id="bootstrap-wizard-1" class="col-sm-12">
                                                        <div class="form-bootstrapWizard">
                                                            <ul class="bootstrapWizard form-wizard" style="margin-left:13%;display:none">
                                                                <li class="active" data-target="#step1">
                                                                    <a href="#tab1" data-toggle="tab"> <span class="step">1</span>  
                                                                        <span class="title"><b></b></span> 
                                                                    </a>
                                                                </li>
                                                                <li data-target="#step2">
                                                                    <a id="addlink" data-target='#tab2' data-toggle="tab" onclick="">

                                                                        <span class="step">2</span>  
                                                                        <span class="title"><b></b></span>
                                                                    </a>
                                                                </li>
                                                                <li data-target="#step3">
                                                                    <a href="#tab3" data-toggle="tab">
                                                                        <span class="step">3</span>  <span class="title"><b></b></span> 
                                                                    </a>
                                                                </li>
                                                                <li data-target="#step4">
                                                                    <a href="#tab4" data-toggle="tab">
                                                                        <span class="step">4</span>  <span class="title"><b></b></span> 
                                                                    </a>
                                                                </li>
                                                                <!-- <li data-target="#step5">
                                                                    <a href="#tab5" data-toggle="tab">
                                                                        <span class="step">4</span>  <span class="title"><b></b></span> 
                                                                    </a>
                                                                </li> -->

                                                            </ul>
                                                            <div class="clearfix"></div>
                                                        </div>
                                                        <div class="tab-content">
                    <div class="tab-pane active" id="tab1" style="padding-bottom:20px;overflow-y: auto;">

                        <div id="templateContent" class="row " style="margin:0px;min-height:200px;">
                        
                        </div>
                    </div>
                    <div class="tab-pane" id="tab2" style="padding-bottom:20px;overflow-y: auto;">
                        <div class="row " style="margin:0px">
                            <div id="individualTemplateNameGrid" class="templatesAppfactory templates">

                            </div>
                            <div id="templatesDevopsRole" class="templatesdevopsrole templates" style="display:none">

                            </div>
                            <div class="templatesCloudformation templates" style="display:none">

                            </div>
                        </div>
                    </div>
                    <div class="tab-pane" id="tab3" style="padding-bottom:20px;">

                        <div class="row">
                          <div class="col-lg-12">
                          <div class="col-lg-2">
                             <div class="row  selectedTemplateArea" style="margin-bottom:10px;padding-left:10px;margin-left:0px;margin-right:0px;"> Test
                             </div>
                          </div>
                          <div class="col-lg-10">
                            <div class="panel-group smart-accordion-default" id="accordion-Design">
                              <div class="panel panel-default divconfigureparameterrunlist">
                                  <div class="panel-heading">
                                      <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseConfigureproviderParameter"> <i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Configure Provider Parameters</a>
                                      </h4>
                                  </div>
                                  <div id="CollapseConfigureproviderParameter" class="panel-collapse collapse in">
                                    <div class="panel-body" style="padding-left: 20px;">
                                       <div class="widget-body no-padding">
                                            <form action="" id="checkout-form">

                                                <div class="row " style="margin:0px;">
                                                    
                                                   <div class="col-lg-6">
                                                    <label for="">Choose Operating System:<span style="color:red">*</span></label>
                                                    <select id="instanceOS" class="chooseOS width-100">
                                                    </select>

                                                                                              
                                                </div>
                                                <div class="col-lg-6">
                                                    <label for="">Choose Security Group:<span style="color:red">*</span></label>
                                                    
                                                    
                                                        <select class="chooseSecurity width-100">
                                                            <option value="0">default-d4d</option>
                                                            <!--<option value="1">default-d4d</option>-->
                                                            <option value="2">Vpc-1</option>
                                                            <option value="3">Vpc-2</option>
                                                            <option value="4">Default VPC</option>

                                                        </select>
                                                    
                                                </div>
                                            </div>
                                            <div class="col-lg-6" style="margin-top:15px;">
                                                <label for="">Choose Instance Size:<span style="color:red">*</span></label>
                                                
                                                
                                                  <select id="intanceTypeControl" class="instanceType chooseInstance width-100">
                                                  </select>
                                                
                                            </div>
                                            <div class="col-lg-6">
                                                    <label for="">Choose Image:<span style="color:red">*</span></label>
                                                    <select id="imagename" class="chooseImage width-100">
                                                    </select>

                                                                                              
                                                </div>
                                            <!--To add the Swipe Functionality-->                            
                                            
                                            </form><!--end-->
                                        </div> 
                                    </div>
                                  </div>
                              </div>

                              <div class="panel panel-default divchefrunlist">
                                      <div class="panel-heading">
                                          <h4 class="panel-title">
                                            <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseConfigurechefRunlist" class="collapsed"><i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Configure Chef Runlist</a>
                                          </h4>
                                      </div>
                                      <div id="CollapseConfigurechefRunlist" class="panel-collapse collapse">
                                          <form action="" id="checkout-form">
                                                
                                                    <div class="col-lg-6" style="padding-left: 20px;">
                                                        <label for="">Choose Organization <span style="color:red">*</span></label>
                                                        <select id="orgnameSelect" class="chooseOrgselect2 width-100">
                                                        </select>
                                                    </div>
                                                    <div class="col-lg-12" style="margin-top:10px;padding-left:8px">
                                                       <div class="cookbookShow">

                                                       </div>
                                                   </div>
                                                   
                                                
                                            </form>
                                      </div>
                              </div>

                              <div class="panel panel-default divOrganizationParameter">
                                  <div class="panel-heading">
                                      <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseEditorgParam" class="collapsed"><i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Edit Organization Parameters</a>
                                      </h4>
                                  </div>
                                  <div id="CollapseEditorgParam" class="panel-collapse collapse">
                                      <div class="panel-body" style="padding-left: 8px;">
                                            <form action="" id="checkout-form">
                                              <div class="row" style="margin:0px">
                                  <div class="col-lg-6">
                                    <label for="name">Blueprint Name:
                                    <span style="color:Red;" class="control-label">&nbsp;*</span></label>
                                    <input  id="blueprintNameInput" class="form-control" type="text" autofocus="autofocus">
                                    <span data-val-controltovalidate="orgname" id="MainContent_Req_orgname" data-val="true" data-val-initialvalue="" style="visibility:hidden;">Required</span>
                                 </div>
 
                                                    <div class="col-lg-6">
                                                        <label for="">Business Group <span style="color:red">*</span>
                                                        </label>
                                                         
                                                            <select id="bgListInput" class="chooseBG width-100">
                                                             
                                                            </select>
                                                          
                                                    </div>
                                               
                                            
                                             

                                          </div>
                                          <div class="col-lg-6" style="margin-top:5px;">
                                                <label for="">Assign Users<span style="color:red">*</span></label>
                                                
                                                    <div class="userListLoadingContainer">
                                                        
                                                    </div>
                                                        <select class="custom-scroll width-100" multiple="" id="userListSelect" style="display:none">

                                                        </select> 
                                                  
                                                </div>
                                              <div class="col-lg-6" style="margin-top:5px">
                                                <label for="category">Project <span style="color:red">*</span>
                                                </label>
                                                
                                                  <select id="projectListInput" class="chooseProject width-100">
                                                    
                                                  </select>
                                               
                                              </div>

                                              
                                              <div class="col-lg-6" style="margin-top:5px">
                                                <label for="category">Environment <span style="color:red">*</span>
                                                </label>
                                                
                                                    <select  id="envList" class="chooseEnv width-100">
                                                      
                                                    </select>
                                                
                                                
                                              </div>

                                              <!--<div class="col-lg-6 notFordocker" style="margin-top:15px;display:none">

                                                <label for="">Application Name<span style="color:Red;" class="control-label">&nbsp;*</span></label>

                                                <input type="text" name="appNameInput" class="form-control" id="appName1">
                                                <b class="tooltip tooltip-top-right">
                                                    <i class="fa fa-user txt-color-teal"></i> Please enter Username</b>


                                               </div>

                                               <div class="col-lg-6 notFordocker" style="margin-top:15px">

                                                <label for="">Application URL<span style="color:Red;" class="control-label">&nbsp;*</span></label>

                                                <input type="text" name="appNameURL" class="form-control" id="appURL1">
                                                <b class="tooltip tooltip-top-right">
                                                    <i class="fa fa-user txt-color-teal"></i> Please enter Username</b>


                                              </div>-->
                                             
                                                 
                                            
                   
                                           <div class="col-lg-6 fordocker">
                                                <label for="category">Select Docker Image <span style="color:red">*</span>
                                                </label>
                                                
                                                    <select id="dockerrepoListInput" class="chooseDockerContainer width-100">

                                                    </select>
                                                   
                                            </div>
                                            <div class="col-lg-6 fordocker">
                                                <label for="category">Available Repo Tags <span style="color:red">*</span>
                                                </label>                 
                                                <div id="dockerrepotagsdiv">

                                                </div>       
                                            </div>
                                            <br>
                                            <div class="col-lg-6 fordocker">

                                                <label for="category" class="pull-left">Launch Parameters<a id="launchParamDocker" href="javascript:void(0);" onclick="$('[dockerparamkey]').val('');loadLaunchParams();"><i title="Add" class="icon-append fa fa-plus" ></i></a>
                                                </label>               
                                                 <div class="btn-group pull-left">

                                                
                                                   </div> <br/>
                                                   
                                                    <input type="text" id="dockerlaunchparameters" class="form-control" disabled="disabled" title="To edit click add"/>
                                                  
                                            </div>
                                            </form>            
                                       </div>
                                  </div>
                              </div>
                            </div>
                          </div>
                         </div>
                        </div>
                    </div>
                     <div class="tab-pane" id="tab4" style="padding-bottom:20px;overflow-y: auto;">
                        
                        

                        <div class="blueprintSaveSuccess blueprintMsgContainer">
                            <h3 class="alert alert-success">Blueprint Saved.</h3>
                        </div>

                        <div class="blueprintSaveFail blueprintMsgContainer">

                            <h3 class="alert alert-danger">Unable to save blueprint. Please try again later.</h3>
                        </div>
                    </div>


                                    <footer class="footer">
                                        
                                            <div style="text-align:center;" class="clearfix form-actions no-padding">

                                                <div class="btn-group">
                                                    <ul class="pager wizard no-margin" style="margin-left:200px">

                                                        <li class="previous disabled">
                                                            <a style="border-radius:0px" class="btn btn-primary" href="javascript:void(0);"> Previous </a>
                                                        </li>

                                                        <li class="next" id="nextSpecificValue">
                                                            <a style="border-radius:0px;margin-left:5px;" class="btn btn-primary" href="javascript:void(0);"> Next </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        
                                    </footer>

                                                        </div>
                                                    </div>
                                                </form>
                                            </div>

                                        </div>


                                    </div>


                                </div>


                            </article>

                        </div>

                    </section>

                </div>

            </div>

        </div>

    </article>
    

</div>

<div class="modal fade bs-example-modal-lg" id="myModalLabelDockerContainer" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="DockerLaunch">Launch Parameters-Docker Blueprints</h4>
      </div>
      <div class="modal-body dockerModalHeight">
      <section>
        <form id="dockerparamsform" action="">
          
              
                <div style="margin:0px;">
                    <div class="col-lg-6">
                        <label for="category">Container Name<span style="color:red">*</span><span class="dockerparamrequired hidden" style="color:red">&nbsp;Required</span>
                        </label>
                        
                            <input type="text" id="Containernamefield" name="namefield" class="required form-control" placeholder="" dockerparamkey="--name" onclick="$('.dockerparamrequired').addClass('hidden')">
                        
                    </div>
                    <div class="col-lg-6">
                        <label for="category">Port Mappings
                        </label>
                        
                            <input type="text" id="Portmappingfield" name="Portmappingfield" class=" form-control" placeholder="Map host ports to container ports" dockerparamkey="-p">
                        
                    </div>
                    <div class="col-lg-6 dockerModal">
                        <label for="category">Volumes
                        </label>
                        
                            <input type="text" id="Volumesfield" name="Volumesfield" class=" form-control" placeholder="Map host folders to container folders"  dockerparamkey="-v">
                        
                    </div>
                    <div class="col-lg-6 dockerModal">
                        <label for="category">Volumes-from
                        </label>
                        
                            <input type="text" id="Volumes-fromfield" name="Volumes-fromfield" class=" form-control" placeholder="Comma separated container names" dockerparamkey="--volumes-from">
                        
                    </div>
                    <div class="col-lg-6 dockerModal">
                        <label for="category">Linked Container
                        </label>
                        
                            <input type="text" id="Linkedcontainerfield" name="Linkedcontainerfield" class=" form-control" placeholder="The name of a container this one links to"  dockerparamkey="--link">
                        
                    </div>
                    <div class="col-lg-6 dockerModal">
                        <label for="category">Startup Command
                        </label>
                        
                            <input type="text" id="Startupcommandfield" name="Startupcommandfield" class=" form-control" placeholder="Optional startup command for the container" dockerparamkey="-c">
                        
                    </div>
                    <div class="col-lg-6 dockerModal">
                        <label for="category">Additional Startup
                        </label>

                            <input type="text" id="additionalStartupcommandfield" name="additionalStartupcommandfield" class=" form-control" placeholder="Additional startup command for the container" dockerparamkey="-exec">

                        
                    </div>
                    <div class="col-lg-6 hidden">
                        <label for="category">Removed Linked Containers on Exit
                        </label>
                        
                            <select class="chooseSelect width-100" id="Removelinkedcontainersonexitfield" placeholder="Should this & linked containers be removed on exit">
                              <option>False</option>
                              <option>True</option>
                              
                            </select>
                        
                    </div>
                    <div class="col-lg-6 dockerModal hidden">
                        <label for="category">Remove on Exit
                        </label>
                        
                            <select class="chooseSelectExit width-100 " id="Removeonexitfield" placeholder="Should this container be removed when it exits">
                              <option>False</option>
                              <option>True</option>
                              
                            </select>
                       
                    </div>
                    <div class="col-lg-6 hidden">
                      <label for="">Startup Script</label>
                      <label class="input input-file" for="file">
                        <div class="button"><input type="file" id="Startupscriptfield" name="Startupscriptfield">Browse</div><input type="text" readonly="">
                      </label>
                    </div> 
                </div>
           
            
         
        
        </form>
      </section>
      </div>
      <div class="modal-footer">
         <button type="button" class="btn btn-default btn-primary" onclick="if(generateDockerLaunchParams()!=''){$('#myModalLabelDockerContainer').modal('hide');}else{return(false);}">
          <i class="fa fa-save fa-1x" ></i>&nbsp;Add</button>
        <button type="button" class="btn btn-default btn-primary" data-dismiss="modal">
          <i class="fa fa-undo fa-1x"></i>&nbsp;Cancel</button>
      </div>
    </div>
  </div>
</div>


<script type="text/javascript">
$('#launchParamDocker').click(function(){
  $('#dockerparamsform')[0].reset();
  $('.chooseSelectExit').change();
});
function generateDockerLaunchParams(){
  if($('#Containernamefield').val() == ''){
    $('.dockerparamrequired').removeClass('hidden');
    return('');
  }

    var launchparams = '';
    $('[dockerparamkey]').each(function(){
      if($(this).val() != ''){
        var itms = $(this).val().split(',');
        for(itm in itms)
          launchparams += ' ' + $(this).attr('dockerparamkey') + ' ' + itms[itm];
      }
    });
    $('#dockerlaunchparameters').val(launchparams);
    return(launchparams);
}

function loadLaunchParams(){
  if($('#dockerlaunchparameters').val() != ''){
      $('[dockerparamkey]').val('');
      var params = $('#dockerlaunchparameters').val().split(' -');
      for(para in params){
        var subparam = params[para].split(' ');
        if(subparam.length > 0){
          $inp = $('[dockerparamkey="-' + subparam[0] + '"]').first();
          if($inp.val() != '')
            $inp.val($inp.val() + ',' + subparam[1]);
          else
            $inp.val(subparam[1]);
        }
        //alert(params[para]);
      }
    }
    $('#myModalLabelDockerContainer').modal('show');
}

   
$(document).ready(function(){

    $('.chooseSelect').select2();
    console.log("Orgname===>" + localStorage.getItem('selectedOrgName'));
    $.get('../aws/ec2/amiids',function(data){
       var $instanceOS = $('#instanceOS');
       for(var i=0;i<data.length;i++) {
          $option = $('<option data-amiid="'+data[i].amiid+'" data-amiid-username="'+data[i].username+'" data-instanceOS="'+data[i].osType+'" value="'+data[i].name+'">'+data[i].name+'</option>');
          $option.data('supportedInstanceType',data[i].supportedInstanceType);
          $instanceOS.append($option);
       }
        var $instanceType = $('#intanceTypeControl');
       $instanceOS.change(function(e){
         $instanceType.empty();
       
        $selectedOption = $(this).find('option:selected');
        var supportedInstanceType = $selectedOption.data('supportedInstanceType');
        console.log(supportedInstanceType);
        if(typeof supportedInstanceType != 'undefined')
        {
          for(var i=0;i<supportedInstanceType.length;i++) {
                    var $option = $('<option></option>').val(supportedInstanceType[i]).html(supportedInstanceType[i]);
                    $instanceType.append($option);
                }
            }
        $instanceType.select2(); 
      

       });
       $instanceOS.select2();
       $instanceOS.trigger('change');
       
    }); 

    $(".chooseOrgselect2").select2();    
    $(".chooseOS").select2();
    $(".chooseSecurity").select2();
    $(".chooseInstance").select2();
    $(".chooseImage").select2();
    $(".chooseBG").select2();
    $(".chooseProject").select2();
    $(".chooseEnv").select2();
    $(".chooseDockerContainer").select2();
    $(".chooseSelectExit").select2();

    $.ajax({
      url: "/d4dMasters/readmasterjsonnew/22",
      dataType: "json",
      type: "GET",
      cache: "true",
       
       //async: false,
       
       success: function(data) {
        //alert(data);
          //console.log("Image Data>>>>>>>>>>>> "+data);
           var data = JSON.parse(JSON.stringify(data));
           //alert(data);
           var $imgListInput = $('#imagename');
          // console.log("Image Json>>>>>>>>>>  "+data);
           for (var i = 0; i < data.length; i++) {
              //alert(data[i].imagename);
            $imgListInput.append($('<option></option>').val(data[i].rowid).html(data[i].imagename));
           }

           }
         });
   $.ajax({
    url: "/d4dMasters/readmasterjsonnew/16",
    dataType: "json",
    type:"GET",
    cache: "true",
    success: function(data){
        var rowLength = JSON.stringify(data.length);
        var containerTemp = "";
        var selectedrow = false;
        var getDesignTypeImg; var getDesignTypeRowID;
        //alert(JSON.stringify(data));
        for(var i=0; i<rowLength; i+=1){

             getDesignTypeImg= data[i]['designtemplateicon_filename'];
             getDesignTypeRowID= data[i]['rowid'];
            // for(var x=0;x < data.masterjson.rows.row[i].field.length;x++){
               

            //     if(data.masterjson.rows.row[i].field[x].name == "rowid"){
            //       getDesignTypeRowID = data.masterjson.rows.row[i].field[x].values.value;
            //     }
            //  if(data.masterjson.rows.row[i].field[x].name == "designtemplateicon_filename"){
            //       getDesignTypeImg = data.masterjson.rows.row[i].field[x].values.value;
                  
            //     }
                    

            // }
        containerTemp += '<div class="" style="width:222px;float:left">'+
                            ' <div id=grid'+i+' class="blueprintdiv appfactory" data-'+
                            'templateType="'+data[i]['templatetypename']+'">'+
                            '<div style="">'+
                            '<img  style="height:25px;padding:2px" alt="" src="img/app-store-'+
                            'icons/Logoheader.png"><span style="padding-top:4px;position:absolute;'+
                            'padding-left: 4px;">'+
                            '<b>'+data[i]['templatetypename']+'</b>'+
                            '</span></div>'+
                            '<div style="padding-top:10px;padding-left:27px;">'+
                             '<img alt="JBoss Stack" '+
            //'src="/d4dMasters/image/'+getDesignTypeRowID+'__designtemplateicon__'+getDesignTypeImg+'">'+
            'src="/d4dMasters/image/'+getDesignTypeRowID+'__designtemplateicon__'+getDesignTypeImg+'" style="height:60px;width:auto;">'+
                            '</div></div></div>';
                           
         }

         $("#templateContent").append(containerTemp);   
         $("#templateContent #grid0").addClass("role-Selected");
        }
      });

      $('#templateContent').on("click",'.blueprintdiv', function () {
          $('#templateContent .role-Selected').removeClass('role-Selected');
              $(this).addClass('role-Selected');
          
          });
      $('#individualTemplateNameGrid').on("click",'.productdiv2', function () {
        console.log(this);
          $('#individualTemplateNameGrid .role-Selected').removeClass('role-Selected');
              $(this).addClass('role-Selected');
          
          });
});

</script>


<script type="text/javascript">
   var reqBody;
   var $wizard = $('#bootstrap-wizard-1').bootstrapWizard({
       'tabClass': 'form-wizard',
       'onNext': function(tab, navigation, index) {

           console.log(navigation, index)
           if (index === 1) {
              $("#tabheader").html('Choose Templates');
               var $selectedItem = $('.role-Selected');
               if (!$selectedItem.length) {
                   alert('please choose a blueprint design');
                   return false;
               }
               var $clone = $selectedItem.clone().removeClass('role-Selected');
               var selectedText = $clone.attr("data-templateType");
               var getID = parseInt($clone.attr("id").replace("grid", ""), 10);

               // var getParent = '<div class="" style="width:222px;float:left">'+
               //                   ' <div class="blueprintdiv appfactory" data-'+
               //                   'templateType="">'+
               //                   '<div style="">'+
               //                   '<img  style="height:25px;padding:2px" alt="JBoss Stack" src="img/app-store-'+
               //                   'icons/Logoheader.png"><span style="padding-top:4px;position:absolute;'+
               //                   'padding-left: 4px;">'+
               //                   '<b>'+selectedText+'</b>'+
               //                   '</span></div>'+
               //                   '<div style="padding-top:10px;padding-left:27px;">'+
               //                   '<img  style="" alt="JBoss Stack" src="img/app-store-icons/Appfactory.png">'+
               //                   '</div></div></div><div cls=="clearfix"></div>';

               $.ajax({
                   url: "/d4dMasters/readmasterjsonnew/17",
                   dataType: "json",
                   type: "GET",
                   cache: "true",
                   success: function(data) {
                       var rowGridLength = (data.length);
                       var getIndividualData = "";
                       var getTempName;
                       var getRowID, getImage;
                       //alert(JSON.stringify(data));
                       for (var z = 0; z < rowGridLength; z += 1) {
                           //iterate thhrough columns to get correct column and value
                           var selectedrow = false;
                           var currField = null;

                           getTempName = data[z]['templatename'];


                           getRowID = data[z]['rowid'];
                           getImage = data[z]['templatesicon_filename'];
                           getTemplateType = data[z]['templatetypename'];

                           if(selectedText != getTemplateType)
                              continue;

                           gettemplatescookbooks = data[z]['templatescookbooks'].replace(/"/g, "");
                           dockercontainerpathstitle = data[z]['dockercontainerpathstitle'];
                           dockercontainerpaths = data[z]['dockercontainerpaths'];
                           dockerreponame = data[z]['dockerreponame'];
                           //To be removed and converted to reference when the new master model is implemented.
                           dockerusername = '';
                           dockercred = '';
                           dockeremail = '';
                          
                           //alert(JSON.stringify(data));
                           // for (var x = 0; x < data.masterjson.rows.row[z].field.length; x++) {
                           //     if (data.masterjson.rows.row[z].field[x].name == "templatesicon_filename") {
                           //         getImage = data.masterjson.rows.row[z].field[x].values.value;
                           //         //alert(getImage);
                           //     }
                           //     if (data.masterjson.rows.row[z].field[x].name == "rowid") {
                           //         getRowID = data.masterjson.rows.row[z].field[x].values.value;
                           //     }
                           //     if (data.masterjson.rows.row[z].field[x].name == "templatetypename") {
                           //         getTemplateType = data.masterjson.rows.row[z].field[x].values.value;
                           //     }
                           //     if (data.masterjson.rows.row[z].field[x].name == "templatescookbooks") {
                           //         gettemplatescookbooks = data.masterjson.rows.row[z].field[x].values.value;
                           //         //clearing additional double quotes
                           //         gettemplatescookbooks = gettemplatescookbooks.replace(/"/g, "");
                           //     }

                           //     if (data.masterjson.rows.row[z].field[x].name == "templatename") {
                           //         getTempName = data.masterjson.rows.row[z].field[x].values.value;
                           //     }
                           //     if (data.masterjson.rows.row[z].field[x].name == "templatetypename") {
                           //         if (data.masterjson.rows.row[z].field[x].values.value == selectedText) {
                           //             selectedrow = true;
                           //         }
                           //     }

                           //     //For docker 
                           //     if (data.masterjson.rows.row[z].field[x].name == "dockercontainerpathstitle") {
                           //         dockercontainerpathstitle = data.masterjson.rows.row[z].field[x].values.value;
                           //     }
                           //     if (data.masterjson.rows.row[z].field[x].name == "dockercontainerpaths") {
                           //         dockercontainerpaths = data.masterjson.rows.row[z].field[x].values.value;
                           //     }
                           //     if (data.masterjson.rows.row[z].field[x].name == "dockerreponame") {
                           //         dockerreponame = data.masterjson.rows.row[z].field[x].values.value;
                           //         //

                           //     }

                           // }
                           console.log('here end');

                           
                               getIndividualData += '<div class="col-sm-3 col-lg-2 col-md-3">' +
                                   '<div class="productdiv2" data-templateId="' + getTempName + '" data-' +
                                   'templateComponent="component' + z + '" ' +
                                   'dockercontainerpathstitle="' + dockercontainerpathstitle + '" ' +
                                   'dockercontainerpaths="' + dockercontainerpaths + '" ' +
                                   'dockerreponame="' + dockerreponame + '" ' +
                                   'data-templateName="' + getTempName + '" data-' +
                                   'templateType="' + getTemplateType + '" templatetype="' + getTemplateType + '" templatename="' + getTempName + '" templatescookbooks="' + gettemplatescookbooks + '">' +
                                   '<ul class="list-unstyled system-prop" style="text-align:center;">' +
                                   '<li><img style="height:40px;width:auto;" alt="" ' +
                                   'src="/d4dMasters/image/' + getRowID + '__templatesicon__' + getImage + '">' +
                                   '</li><li style="font-size:12px;"><u><b>' + getTempName + '</b></u></li>';
                               //If standard template
                               if (getTemplateType != "Docker") {
                                   var cb = gettemplatescookbooks.split(',');
                                   var licb = '';
                                   //alert(cb.length);
                                   for (var cbi = 0; cbi < cb.length; cbi++) {
                                       licb += '<li style="font-size:10px;" blueprinttype="other">' + cb[cbi] + '</li>';
                                   }
                               } else //when template type is docker
                               {
                                 //  alert(dockerreponame);
                                   var cb = dockercontainerpathstitle.split(',');
                                   var cbpath = dockercontainerpaths.split(',');
                                   var licb = '';
                                   //alert(cb.length);
                                   for (var cbi = 0; cbi < cb.length; cbi++) {
                                       licb += '<li style="font-size:10px;" path="' + cbpath[cbi] + '" title="Container" blueprinttype="dockercontainer">' + cb[cbi] + '</li>';
                                   }
                               }

                               getIndividualData += licb + '</ul></div></div>';

                           
                       }
                       $("#individualTemplateNameGrid").html("");
                       //$("#individualTemplateNameGrid").append(getParent);
                       $("#individualTemplateNameGrid").append(getIndividualData).find('.productdiv2').first().click();
                       //$("#grid0").addClass("role-Selected");
                   }


               });
               //console.log('in here')
               //alert('here');
               // var $selectedItem = $('.role-Selected');
               // if (!$selectedItem.length) {
               //     alert('please choose a blueprint design')
               //     return false;
               // }
               // var $clone = $selectedItem.clone().removeClass('role-Selected');
               $('#tab' + (index + 1)).find('.temp').empty().append($clone);
               $('.' + $selectedItem.attr('data-templateType')).find('.productdiv2:first').trigger('click');

           } else if (index == 2) {
            $("#tabheader").html('Choose Template');
               //   var $selectedTemplateArea = $('.selectedTemplateArea')
               //   var $selectedItem = $selectedTemplateArea.find('.productdiv2');
               //   console.log($selectedItem.length);
               //   if(!$selectedItem.length) {
               //     alert('please choose a template');
               //     return false;

               // }
               //alert('kickin 2');

               //If a docker type of template selected then select the Org 
               var $selectedItem = $('.role-Selected');
               // alert('in ' + $selectedItem.length);
               if (!$selectedItem.length) {
                   alert('please choose a blueprint design');
                   return false;
               }
               //Selection of Orgname from localstorage 
            //   $('#orgnameSelect').val($('li[class*="orgSelected"]').text().trim());
               $('#orgnameSelect').val(localStorage.getItem('selectedOrgId'));
               console.log('role-Selected before ==> ',$('#tab2 .role-Selected').length);
               if ($('.productdiv2.role-Selected').length > 0) {
                   //Setting controls connected to docker to hidden
                   $('.fordocker').hide();
                   $('.notFordocker').show();

                   $('.divconfigureparameterrunlist').show();
                   $('.divchefrunlist').show();

                   if ($('.productdiv2.role-Selected').first().attr('templatetype') == "Docker") {
                      //Checking if docker then only Edit organization paramerters are to be shown
                        if(!$('#CollapseEditorgParam').hasClass('in')){
                          $('a[href="#CollapseEditorgParam"]').click();
                        }
                      $('.divconfigureparameterrunlist').hide();
                      $('.divchefrunlist').hide();
                       //When docker stepping to 4th tab

                       $('#orgnameSelect').trigger('change');
                       //$('a[href="#tab3"]').first().trigger('click');

                       //populating the docker repo titles
                       var $dockerrepotitles = $('.productdiv2.role-Selected').attr('dockercontainerpathstitle').split(',');
                       var $dockerrepopaths = $('.productdiv2.role-Selected').attr('dockercontainerpaths').split(',');
                       var $dockerreponame = $('.productdiv2.role-Selected').attr('dockerreponame');
                       var $dockerrepoListInput = $('#dockerrepoListInput');
                       $dockerrepoListInput.empty();

                       $dockerrepotitles.forEach(function(k, v) {
                           var $opt = $('<option value="' + $dockerrepotitles[v] + '" repopath="' + $dockerrepopaths[v] + '">' + $dockerrepotitles[v] + '</option>');
                           $dockerrepoListInput.append($opt);
                       });

                       //Setting the appropriate tags
                       //Attaching the change event to pull tags for the select repo
                       $dockerrepoListInput.change(function(e) {
                           //tutum/centos
                           //alert('Docker Query -> ' +  '/d4dmasters/getdockertags/' + encodeURIComponent($(this).find('option:selected').attr('repopath')) + '/' + $dockerreponame);
                           $.get('/d4dmasters/getdockertags/' + encodeURIComponent($(this).find('option:selected').attr('repopath')) + '/' + $dockerreponame, function(data) {
                               //Sample json given below
                               //[{"layer": "cddde0cd", "name": "latest"}, {"layer": "3baf8932", "name": "6.4"}, {"layer": "d1c0a07f", "name": "6.5"}, {"layer": "a9dd9e89", "name": "centos5"}, {"layer": "02398e09", "name": "centos6"}, {"layer": "4e5b3b2f", "name": "centos7"}]

                               if (data) {
                                   var tagJson = JSON.parse(data);
                                   var $dockerrepotagsdiv = $('#dockerrepotagsdiv');

                                   $dockerrepotagsdiv.empty();
                                   var dockerrepotags = [];
                                   tagJson.forEach(function(k, v) {
                                       //<p class="bg-success"><i style="padding-left:10px;padding-right:10px" class="ace-icon fa fa-check"></i>CentOS</p>
                                       if (v < 3) {
                                           $('#dockerrepotagsdiv').append('<div class="codelistitem" style="margin-top:2px;padding-top:2px;border:1px solid #eeeeee; background-color:#eeeeee !important;height:26px;"><p class="bg-success"><i style="padding-left:10px;padding-right:10px" class="ace-icon fa fa-check"></i>' + tagJson[v].name + '</p></div>');
                                           if (dockerrepotags == '')
                                               dockerrepotags += tagJson[v].name;
                                           else
                                               dockerrepotags += ',' + tagJson[v].name;
                                       }
                                       //limiting the number to the top 5
                                   });
                                   $('.productdiv2.role-Selected').first().attr('dockerrepotags', dockerrepotags);
                                   $('.productdiv2.role-Selected').first().attr('dockerimagename', $dockerrepoListInput.val());
                               }
                           });
                       });
                       //dockerrepotagsul
                       $dockerrepoListInput.trigger('change');

                       //End Setting appropriate tags
                       //polulate the docker tags
                       var $dockerrepotagsul = $('#dockerrepotagsul');
                       $('.fordocker').show();
                       $('.notFordocker').hide();
                       //return (true);
                     } else {
                     
                        if(!$('#CollapseConfigureproviderParameter').hasClass('in')){
                          $('a[href="#CollapseConfigureproviderParameter"]').click();
                        }
                     }
                  }

               console.log('role-Selected after ==> ',$('#tab2 .role-Selected').length);
               
               var $clone = $selectedItem.clone().removeClass('role-Selected');
               var selectedText = $clone.attr("data-templateType");
               if ($selectedItem.attr('data-templateType') == 'desktopProvisoning') {
                   wizard.show(4);
                   return false;
               }
               if ($('#tab2 .role-Selected').length > 0) {
                   console.log('cloning');
                   $('#tab3 .selectedTemplateArea').empty().append($('#tab2 .role-Selected').clone());
               }
               //force clicking orgnameSelect
               $('#orgnameSelect').trigger('change');


           } else if (index == 3) {
              $("#tabheader").html('Create Blueprint');
               var $selectedTemplateArea = $('.selectedTemplateArea');
               var $selectedItem = $selectedTemplateArea.find('.productdiv2');
               console.log($selectedItem.length);
               if (!$selectedItem.length) {
                   alert('please choose a template');
                   return false;
               }

               if ($('#orgnameSelect').val() === 'choose') {
                   alert('please choose an Organization');
                   return false;
               }


               reqBody = {};
               reqBody.templateId = $selectedItem.attr('data-templateId');
               reqBody.templateType = $selectedItem.attr('data-templateType');
               reqBody.templateComponents = $selectedItem.attr('data-templateComponent').split(',');
               reqBody.dockercontainerpathstitle = $selectedItem.attr('dockercontainerpathstitle');
               reqBody.dockercontainerpaths = $selectedItem.attr('dockercontainerpaths');
               reqBody.dockerlaunchparameters = $('#dockerlaunchparameters').val();
               reqBody.dockerreponame = $('.productdiv2.role-Selected').attr('dockerreponame');
               //dockerreponame
               /*if(!$('.deploymentsCookbookList').length) {
                alert('Please wait while we are fetching cookbooks.');
                return false;
              }*/
               //Get all the runlist 
               var cbs = [];
               $('.deploymentSelectedRunList input').each(function() {
                   cbs.push($(this).val());
               });
               reqBody.runlist = cbs.join(); //$('#cookbookSelect').val();
               //reqBody.chefServerId = $('#cookbookSelect').data('chefServerId',);
               reqBody.chefServerId = $('.deploymentSelectedRunList').first().data('chefServerId');
               reqBody.instanceType = $('select.instanceType').val();
               reqBody.instanceOS = $('#instanceOS').val();
               console.log(reqBody);


               console.log("reqBody ==>", reqBody);
               if (!reqBody || reqBody == "undefined") {
                   console.log('resetting');
                   var reqBody = {};
               }
               //reqBody.runlist = $('#cookbookSelect').val();
               var cbs = [];
               $('.deploymentSelectedRunList input').each(function() {
                   cbs.push($(this).val());
               });
               reqBody.runlist = cbs; //$('#cookbookSelect').val();
               //reqBody.chefServerId = $('#cookbookSelect').data('chefServerId');
               reqBody.chefServerId = $('.deploymentSelectedRunList').first().data('chefServerId');
               console.log("instanceType ==>", $('select.instanceType').val());
               reqBody.instanceType = $('select.instanceType').val();

               var $instanceOsoptionsSelected = $('#instanceOS').find('option:selected');
               console.log($('#instanceOS').val());
               console.log($instanceOsoptionsSelected);
               reqBody.instanceOS = $instanceOsoptionsSelected.attr('data-instanceOS');
               reqBody.instanceAmiid = $instanceOsoptionsSelected.attr('data-amiid');
               reqBody.instanceUsername = $instanceOsoptionsSelected.attr('data-amiid-username');
               // reqBody.instanceOS = $('#instanceOS').val();
               reqBody.templateId = $('.productdiv2.role-Selected').attr('data-templateId');
               reqBody.templateType = $('.productdiv2.role-Selected').attr('data-templateType');
               reqBody.templateComponents = $('.productdiv2.role-Selected').attr('data-templateComponent').split(',');

               //    reqBody.dockercontainerpathstitle = $('.productdiv2.role-Selected').attr('dockercontainerpathstitle');
               reqBody.dockercontainerpaths = $('#dockerrepoListInput :selected').attr('repopath'); //$('.productdiv2.role-Selected').attr('dockercontainerpaths');
               reqBody.dockerrepotags = $('.productdiv2.role-Selected').attr('dockerrepotags');
               reqBody.dockerimagename= $('#dockerrepoListInput').val();
               reqBody.dockerlaunchparameters = $('#dockerlaunchparameters').val();
               reqBody.dockerreponame = $('.productdiv2.role-Selected').attr('dockerreponame');
               //alert(reqBody.dockerreponame);
               reqBody.iconpath = $('.productdiv2.role-Selected').find('img[src*="__templatesicon__"]').first().attr('src');
               reqBody.orgId = $('#orgnameSelect').val();
               reqBody.bgId = $('#bgListInput').val();
               reqBody.projectId = $('#projectListInput').val();
               reqBody.envId = $('#envList').val();

               reqBody.name = $('#blueprintNameInput').val();
               //alert('in');
               if (!reqBody.name) {
                   alert("Please enter a blueprint name");
                   return false;
                   $('#blueprintNameInput').focus();

               }
               if (!reqBody.bgId || reqBody.bgId === 'choose') {
                   alert("Please choose a business group");
                   return false;
               }
               if (!reqBody.projectId || reqBody.projectId === 'choose') {
                   alert("Please choose a project");
                   return false;
               }

               if (!reqBody.envId || reqBody.envId === 'choose') {
                   alert("Please choose an environment");
                   return false;
               }
               reqBody.users = $('#userListSelect').val();

               if (!reqBody.users) {
                   alert("Please choose users");
                   return false;
               }
               //alert(JSON.stringify(reqBody));
            var appName = $('#appName1').val();
            var appURL = $('#appURL1').val();
            if (appName && appURL) {
                reqBody.appUrl1 = {
                    name: appName,
                    url: appURL
                }
            }
               
               $('.blueprintMsgContainer').hide();
               
               $.post('/organizations/'+reqBody.orgId+'/businessgroups/'+reqBody.bgId+'/projects/' + reqBody.projectId + '/environments/' + reqBody.envId + '/blueprints', {
                   blueprintData: reqBody
               }, function(data) {
                   console.log(data);
                   $('.blueprintSaveSuccess').show();
                   var wizard = $wizard.data('bootstrapWizard');
                    wizard.disablePreviouBtn();
               }).error(function(){
                  $('.blueprintSaveFail').find('h3').first().html('Insufficient permission to perform operation.')
                  $('.blueprintSaveFail').show();
               });
               console.log('final', reqBody);

           } 




       
           //$('#tab'+(index)).removeClass('active');
           //$('#tab'+(index+1)).addClass('active');
           //return true;


       },
       'onPrevious': function(tab, navigation, index) {
        //console.log(index);
       if (index === 0) {
        $("#tabheader").html('Choose Template Type');
        }
        else if (index === 1) {
            $("#tabheader").html('Choose Templates');
        }
        else if (index === 2) {
            $("#tabheader").html('Choose Template');
        }
        else if (index === 3) {
            $("#tabheader").html('Create Blueprint');
        }
      
       }
   });


   var $rolesCards = $('.blueprintdiv')

    $('.blueprintdiv').on("click", function() {
       //alert("Inside");
       $rolesCards.removeClass('role-Selected');
       if ($(this).hasClass('role-Selected')) {
           $(this).removeClass('role-Selected');
       } else {
           $(this).addClass('role-Selected');
       }
       // $('.templates').hide();
       // console.log($(this).attr('data-templateType'));
       // $('.'+$(this).attr('data-templateType')).show();
       //$('.next a').attr('disabled',false);
   });

   var $selectedTemplate = $('.productdiv2').click(function(e) {
       $selectedTemplate.removeClass('role-Selected');
       console.log("this ==> ",this); 
       var $this = $(this);
       $('.selectedTemplateArea').empty().append($this.clone(false).css({
           'cursor': 'auto'
       }));

       $this.addClass('role-Selected');
   });

   $.ajax({
       type: "get",
       dataType: "json",

       async: false,
       url: "../organizations/getTreeNew",
       success: function(data) {
          //alert(JSON.stringify(data));
          //alert(typeof data);
          console.log(data);
           data = JSON.parse(JSON.stringify(data));
           var $orgListInput = $('#orgnameSelect');
           //$orgListInput.append($('<option></option>').val('choose').html('Choose'));
           $bgList = $('#bgListInput');
           var $envList = $('#envList');
          // alert(data.length);
           for (var i = 0; i < data.length; i++) {
             // alert('BG:' + JSON.stringify(data[i].businessGroups));
               console.log(data[i].businessGroups);
               $orgListInput.append($('<option></option>').val(data[i].rowid).html(data[i].name).data('bglist', data[i].businessGroups).data('envList', data[i].environments));
           }
           $orgListInput.change(function(e) {
               // alert('trigged org selection');
               var orgName = $(this).val();
              // alert(orgName);
               if (orgName == 'choose') {
                   return;
               }
               var $selectedOrgOption = $(this).find(":selected");
               $bgList.empty();
               $bgList.append($('<option></option>').val('choose').html('Choose'));
               //alert('in' + JSON.stringify($selectedOrgOption.data('bglist')));

               var getBGs = $selectedOrgOption.data('bglist');
               if(getBGs != null){
                  for (var i = 0; i < getBGs.length; i++) {
                     $bgList.append($('<option></option>').val(getBGs[i].rowid).html(getBGs[i].name).data('projList', getBGs[i].projects));
                 }
               }

               //alert('out');
               $envList.empty();
               var getEnv = $selectedOrgOption.data('envList');
               if(getEnv != null){
                  //alert(JSON.stringify(getEnv));
                  $envList.append($('<option></option>').val('choose').html('Choose'));
                      //alert(getEnv.length);
                      for (var i = 0; i < getEnv.length; i++) {
                          $envList.append($('<option></option>').val(getEnv[i].rowid).html(getEnv[i].name));
                      }
                }

               var $cookbookShow = $('.cookbookShow').empty();
               $cookbookShow.append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />');
               //alert('here');
               var tcb = [];
               var $card = $('#tab3').find('div[class*="productdiv2"]').first();
               if($card.length){
                var templatescookbooks = $card.attr('templatescookbooks');
                if(templatescookbooks){
                  tcb = templatescookbooks.split(',');
                }
               }
              /*var tcb = $('#tab3').find('div[class*="productdiv2"]').first().attr('templatescookbooks').split(',');*/

              console.log(tcb);
               console.log('tcbdhd == >',tcb);
               var $ccrs = $chefCookbookRoleSelector(orgName, function(data) {
                   
               },tcb);
               $cookbookShow.empty();
               $cookbookShow.append($ccrs);



           });

           var $projectList = $('#projectListInput');
           $bgList.change(function(e) {
               var bgName = $(this).val();
               if (bgName == 'choose') {
                   return;
               }
               var $selectedOrgOption = $(this).find(":selected");
               $projectList.empty();
               $projectList.append($('<option></option>').val('choose').html('Choose'));
               var getProjs = $selectedOrgOption.data('projList');
              // alert(getProjs.length);
               for (var i = 0; i < getProjs.length; i++) {

                   $projectList.append($('<option></option>').val(getProjs[i].rowid).html(getProjs[i].name));
               }
           });

       }
   });


   (function() {

       var $loadingContainer = $('.userListLoadingContainer').empty().append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />').show();
       $.get('../users', function(userList) {
           var $userListSelect = $('#userListSelect').empty();
           userList = JSON.parse(userList);
           userList.sort(function(a, b) {
               var keyA = Object.keys(a);
               var keyB = Object.keys(b);

               if (keyA[0] < keyB[0]) return -1;
               if (keyA[0] > keyB[0]) return 1;
               return 0;
           });
           for (var i = 0; i < userList.length; i++) {
               var keys = Object.keys(userList[i]);
               var $option = $('<option></option>').append(keys[0]).val(keys[0]);
               $userListSelect.append($option);
           }
           $loadingContainer.hide();
           $userListSelect.show();
       }).error(function() {
           $loadingContainer.empty().append('Unable to load users. Please try again later.');
       });
   })();

$(document).ready(function () {
      $("#blueprintNameInput").focus();
   });
</script>
