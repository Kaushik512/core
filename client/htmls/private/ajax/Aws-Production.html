	<div class="row">

 <article class="col-sm-12 col-md-12 col-lg-12">

 <div class="widget-body" style="font-size:12px;">

 <ul id="myTab3" class="nav nav-tabs tabs-pull-left">
 <!--<li class="active">
 <a href="#l1" data-toggle="tab">Domains</a>
 </li>-->
 <li class="pull-left active">
 <a href="#l2" id="tabheader" data-toggle="tab">Choose Template Type</a>
 </li>
 </ul>

 <div id="myTabContent3" class="nav tab-content">
 
 
 <div class="tab-pane fade in active" id="l2">


 <section id="widget-grid" class="">


 <div class="row">


 <article class="col-sm-12 col-md-12 col-lg-12">


 <div class="jarviswidget jarviswidget-color-darken" id="wid-id-1" data-widget-editbutton="false" data-widget-deletebutton="false">



 <div role="content">


 <div class="jarviswidget-editbox">


 </div>

 <div class="widget-body">

 <div class="row">
 <form id="wizard-1" novalidate="novalidate">
 <div id="bootstrap-wizard-1" class="col-sm-12">
 <div class="form-bootstrapWizard">
 <ul class="bootstrapWizard form-wizard" style="margin-left:13%;display:none">
 <li class="active" data-target="#step1">
 <a href="#tab1" data-toggle="tab"> <span class="step">1</span>  
 <span class="title"><b></b></span> 
 </a>
 </li>
 <li data-target="#step2">
 <a id="addlink" data-target='#tab2' data-toggle="tab" onclick="">

 <span class="step">2</span>  
 <span class="title"><b></b></span>
 </a>
 </li>
 <li data-target="#step3">
 <a href="#tab3" data-toggle="tab">
 <span class="step">3</span>  <span class="title"><b></b></span> 
 </a>
 </li>
 <li data-target="#step4">
 <a href="#tab4" data-toggle="tab">
 <span class="step">4</span>  <span class="title"><b></b></span> 
 </a>
 </li>
 <!-- <li data-target="#step5">
 <a href="#tab5" data-toggle="tab">
 <span class="step">4</span>  <span class="title"><b></b></span> 
 </a>
 </li> -->

 </ul>
 <div class="clearfix"></div>
 </div>
 <div class="tab-content">
 <div class="tab-pane active" id="tab1" style="padding-bottom:20px;overflow-y: auto;">

 <div id="templateContent" class="row " style="margin:0px;min-height:200px;">

 </div>
 </div>
 <div class="tab-pane" id="tab2" style="padding-bottom:20px;overflow-y: auto;">
 <div class="row " style="margin:0px">
 <div id="individualTemplateNameGrid" class="templatesAppfactory templates">

 </div>
 <div id="templatesDevopsRole" class="templatesdevopsrole templates" style="display:none">

 </div>
 <div class="templatesCloudformation templates" style="display:none">

 </div>
 </div>
 </div>
 <div class="tab-pane" id="tab3" style="padding-bottom:20px;">

 <div class="row">
 <div class="col-lg-12">
 <div class="col-lg-2">
 <div class="row  selectedTemplateArea" style="margin-bottom:10px;padding-left:10px;margin-left:0px;margin-right:0px;"> Test
 </div>
 </div>
 <div class="col-lg-10">
 <div class="panel-group smart-accordion-default" id="accordion-Design">
 <div class="panel panel-default divconfigureparameterrunlist">
 <div class="panel-heading">
 <h4 class="panel-title">
 <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseConfigureproviderParameter"> <i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Configure Provider Parameters</a>
 </h4>
 </div>
 <div id="CollapseConfigureproviderParameter" class="panel-collapse collapse in">
 <div class="panel-body" style="padding-left: 20px;">
 <div class="widget-body no-padding">
 <form action="" id="checkout-form">

 <div class="row " style="margin:0px;">

 <div class="col-lg-6 col-md-6">
 <label for="">Choose Operating System:<span style="color:red">*</span></label>
 <select id="instanceOS" class="chooseOS width-100">
 </select>                                                      
 </div>
 <div class="col-lg-6 col-md-6">
 <label for="">Choose Provider:<span style="color:red">*</span></label>
 <select id="providerId" class="chooseOS width-100">
 <option value="">Select Provider</option>
 </select>                                                      
 </div>



 <div class="col-lg-6 col-md-6" style="margin-top:15px;">
 <label for="">Choose Available Images:<span style="color:red">*</span></label>


 <select id="imageId" class="chooseSecurity width-100">
 <option value="">Choose Image </option>
 </select>

 </div>

 <div class="col-lg-6 col-md-6" style="margin-top:15px;">
 <label for="">Choose Region:<span style="color:red">*</span></label>


 <select id="region" class="chooseSecurity width-100">
 <option value="">Select Region</option>
 </select>

 </div> 

 <div class="col-lg-6" style="margin-top:15px;">
 <label for="">Select VPC:<span style="color:red">*</span></label>
 <select id="vpcId" class="chooseSelect chooseImage width-100">
 <option value="">Select VPC</option>                          
 </select>                                                                                            
 </div>

 <div class="col-lg-6" style="margin-top:15px;">
 <label for="">Select Subnet:<span style="color:red">*</span></label>
 <select id="subnetId" class="chooseSelect chooseImage width-100">
 <option value="">Select Subnet</option>                          
 </select>                                                     
 </div>

 <!--   <div class="col-lg-6 col-md-6" style="margin-top:15px;">
 <label for="">Choose Instance Size:<span style="color:red">*</span></label>
 
 
 <select id="intanceTypeControl" class="instanceType chooseInstance width-100">
 </select>
 
 </div> -->

 <div class="col-lg-6 col-md-6" style="margin-top:15px;">
 <label for="">Select KeyPair :<span style="color:red">*</span></label>


 <select id="keypairId" class="instanceType chooseInstance width-100">
 <option value="">Choose KeyPair </option>
 </select>

 </div>

 <!--<div class="col-lg-6" style="margin-top:15px;">
 <label for="">Select Security Group:<span style="color:red">*</span></label>
 <select id="securityGroupId" class="chooseSelect chooseImage width-100">
 <option value="">Select Security Group</option>                          
 </select>                                                                                            
 </div>
 -->

 <div class="col-lg-6" style="margin-top:15px;">
 <label for="name">Instance Size:<span style="color:Red;" class="control-label">&nbsp;*</span></label>
 <select id="instancesize" unique="true" uniqueconditionedby="orgname"  class="chooseOrganization width-100 chooseSelect" style="vertical-align:central"  cdata="catalyst"  cat-validation="required">
 <option value="">Choose Instanace Size</option>
 </select>
 <span data-val-controltovalidate="domainname" id="MainContent_Req_domainname" data-val="true" data-val-evaluationfunction="RequiredFieldValidatorEvaluateIsValid" data-val-initialvalue="" style="visibility:hidden;">Required</span>
 </div> 

 <div class="col-lg-6" style="margin-top:15px;">
 <label for="category">Security Group:<span style="color:Red;" class="control-label">&nbsp;*</span></label>
 <div class="col-lg-6 smart-form multiselect" style="  height: 140px;overflow-y: scroll;border:1px solid gray;padding: 0px;width:100%">       
 <div id="securityGroupIds" multiselect="multiselect" datatype="select" datapath="" class="input-group from-control col-md-12 widthBox" style="width:99%;margin-top:-1px;border:0px" cdata="catalyst" cat-validation="onechecked">
 </div>
 </div>
 </div>
 <!--<div class="col-lg-6" style="margin-top:15px;">
 <label for="">Select Security group:<span style="color:red">*</span></label>
 <select id="securityGroupIds" class="chooseSelect chooseImage width-100">
 <option value="">Select Security Group</option>                          
 </select>                                                                                            
 </div>-->

 <!--To add the Swipe Functionality-->                            
 </div>
 </form><!--end-->
 </div> 
 </div>
 </div>
 </div>

 <div class="panel panel-default divchefrunlist">
 <div class="panel-heading">
 <h4 class="panel-title">
 <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseConfigurechefRunlist" class="collapsed"><i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Configure Chef Runlist</a>
 </h4>
 </div>
 <div id="CollapseConfigurechefRunlist" class="panel-collapse collapse">
 <form action="" id="checkout-form">

 <div class="col-lg-6 col-md-6" style="padding-left: 20px;">
 <label for="">Choose Organization <span style="color:red">*</span></label>
 <select id="orgnameSelect" class="chooseOrgselect2 width-100">
 </select>
 </div>
 <div class="col-lg-12" style="margin-top:10px;padding-left:8px">
 <div class="cookbookShow">

 </div>
 </div>


 </form>
 </div>
 </div>

 <div class="panel panel-default divOrganizationParameter">
 <div class="panel-heading">
 <h4 class="panel-title">
 <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseEditorgParam" class="collapsed"><i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Edit Organization Parameters</a>
 </h4>
 </div>
 <div id="CollapseEditorgParam" class="panel-collapse collapse">
 <div class="panel-body" style="padding-left: 8px;">
 <form action="" id="checkout-form">
 <div class="row" style="margin:0px">
 <div class="col-lg-6 col-md-6">
 <label for="name">Blueprint Name:
 <span style="color:Red;" class="control-label">&nbsp;*</span></label>
 <input  id="blueprintNameInput" maxlength="25" class="form-control" type="text" autofocus="autofocus" >
 <span data-val-controltovalidate="orgname" id="MainContent_Req_orgname" data-val="true" data-val-initialvalue="" style="visibility:hidden;">Required</span>
 </div>

 <div class="col-lg-6 col-md-6">
 <label for="">Business Group <span style="color:red">*</span>
 </label>

 <select id="bgListInput" class="chooseBG width-100">

 </select>

 </div>




 </div>
 <div class="col-lg-6 hidden" style="margin-top:5px;">
 <label for="">Assign Users<span style="color:red">*</span></label>

 <div class="userListLoadingContainer">

 </div>
 <select class="custom-scroll width-100" multiple="" id="userListSelect" style="display:none">

 </select> 

 </div>
 <div class="col-lg-6 col-md-6">
 <label for="category">Project <span style="color:red">*</span>
 </label>

 <select id="projectListInput" class="chooseProject width-100">

 </select>

 </div>


 <div class="col-lg-6 col-md-6">
 <label for="category">Environment <span style="color:red">*</span>
 </label>

 <select  id="envList" class="chooseEnv width-100">

 </select>


 </div>                                                 


 <div class="col-lg-6 col-md-6 fordocker dockerProjPort">
 <label for="category">Select Docker Image <span style="color:red">*</span>
 </label>

 <select id="dockerrepoListInput" class="chooseDockerContainer width-100">

 </select>

 </div>
 <div class="col-lg-6 col-md-6 fordocker dockerProjPort">
 <label for="category">Available Repo Tags <span style="color:red">*</span>
 </label>                 
 <div id="dockerrepotagsdiv">

 </div>       
 </div>
 <div class="col-lg-12 col-md-12">
 <div class="col-lg-6 col-md-6 fordocker dockerProjPort dockerLEFT">

 <label for="category" class="pull-left">Launch Parameters<a id="launchParamDocker" href="javascript:void(0);" onclick="$('[dockerparamkey]').val('');loadLaunchParams();"><i title="Add" class="icon-append fa fa-plus" ></i></a>
 </label>               
 <div class="btn-group pull-left">


 </div> 

 <input type="text" id="dockerlaunchparameters" class="form-control" disabled="disabled" title="To edit click add"/>

 </div>
 </div>
 </form>            
 </div>
 </div>
 </div>
 <!--adding new collapse-->
 <div class="panel panel-default appSeriesNameURL notFordocker">
 <div class="panel-heading">
 <h4 class="panel-title">
 <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseApp" class="collapsed"><i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Configure Application URL</a>
 </h4>
 </div>
 <div id="CollapseApp" class="panel-collapse collapse">

 <div class="row">
 <div class="col-md-12">
 <div class="col-md-12">

 <div class="widget-box">
 <div class="widget-header">
 <h5 class="widget-title" style="color:#4e5964;">
 <strong>Application URL</strong>
 </h5>
 <div class="widget-toolbar no-border">

 <a id="newAppSeries" class="btn btn-minier btn-primary" href="#modalAppNameURL" data-toggle="modal">
 <i class="ace-icon ace-icon fa fa-plus bigger-110"></i>
 New
 </a>                                                

 </div>

 </div>
 <div class="widget-body">
 <div class="widget-main" style="min-height:100px">
 <div class="col-md-12 table-responsive" style="padding-left:0px; padding-right:0px;">
 <table id="appTable" class="hidden" cellpadding="5px" width="100%">
 <thead>
 <tr class="rowCustomStyle">
 <td>Name</td>
 <td>URL</td>
 <td>Action</td>
 </tr>
 </thead>
 <tbody>
 <tr class="hidden rowtemplate">

 <td datafield="appName"></td>
 <td datafield="appURL"></td>
 <td>
 <div class="btn-group tableactionWidth">
 <button class="btn btn-xs btn-danger pull-left" value="Remove" title="Remove"><i class="ace-icon fa fa-trash-o bigger-120"></i></button>
 <a class="btn btn-xs btn-info pull-left" title="Update">
 <i class="ace-icon fa fa-pencil bigger-120"></i>
 </a>
 </div>
 </td>

 </tr>

 </tbody>

 </table>
 <table id="appUrlTable" class="table table-striped table-bordered table-hover dataTable no-footer" cellpadding="5px" width="100%" style="text-align:center";>
 <thead>
 <tr class="rowCustomStyle">

 <td style="width:20%">Name</td>
 <td style="width:40%">URL</td>
 <td style="width:20%" class="">Action</td>
 </tr>
 </thead>
 <tbody>
 <tr><td colspan=3 id="appEntry">No Data Available</td></tr>

 </tbody>

 </table>
 <div id="envtable_tools1"></div>

 <div class="col-md-5">

 </div>
 </div>

 </div>
 <div class="widget-toolbox padding-8 clearfix dataTables_wrapper">
 <div id="tableFooterLeft" class="pull-left"></div>
 <div id="tableFooterRight" class="pull-right"></div>
 </div>


 </div>
 </div>
 </div>
 </div>
 </div>
 </div><!--collapseapp ends here-->
 </div>
 </div>
 </div>
 </div>
 </div>
 </div> <!--tab pane ends here-->
 <div class="tab-pane" id="tab4" style="padding-bottom:20px;overflow-y: auto;">
 
 
 
 <div class="blueprintSaveSuccess blueprintMsgContainer">
 <h3 class="alert alert-success">Blueprint Saved.</h3>
 </div>

 <div class="blueprintSaveFail blueprintMsgContainer">

 <h3 class="alert alert-danger">Unable to save blueprint. Please try again later.</h3>
 </div>
 </div>


 <footer class="footer">
 
 <div style="text-align:center;" class="clearfix form-actions no-padding">

 <div class="btn-group">
 <ul class="pager wizard no-margin" style="margin-left:200px">

 <li class="previous disabled">
 <a style="border-radius:0px" class="btn btn-primary" href="javascript:void(0);"> Previous </a>
 </li>

 <li class="next" id="nextSpecificValue">
 <a style="border-radius:0px;margin-left:5px;" class="btn btn-primary" href="javascript:void(0);"> Next </a>
 </li>
 </ul>
 </div>
 </div>

 </footer>

 </div>
 </div>
 </form>
 </div>

 </div>


 </div>


 </div>


 </article>

 </div>

 </section>

 </div>

 </div>

 </div>

 </article>


 </div>
 <!--app series-->
 <div class="modal fade" id="modalAppNameURL" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
 <div class="modal-dialog">
 <div class="modal-content">
 <form role="form" id="appURLForm" autocomplete="off">
 <div class="modal-header">
 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
 &times;
 </button>
 <h4 class="modal-title">
 <i class="fa fa-th-list txt-color-blue"></i>&nbsp;&nbsp;Add Application URL
 </h4>
 </div>

 <div class="modal-body appSeriesHeight">



 <!--app series-->
 <div class="applicationURLContainer" id="appSeries"> 
 <div class="col-lg-6 col-md-6" style="margin-top:15px;">

 <label for="">Name</label>

 <input placeholder="AppName" type="text" maxlength="8" name="appNameInput" class="form-control appName">
 <b class="tooltip tooltip-top-right">
 <i class="fa fa-user txt-color-teal"></i> Please enter Application</b>


 </div>

 <div class="col-lg-6 col-md-6" style="margin-top:15px">

 <label for="">URL:<span style="color:Red;">&nbsp;*<span class="appUrlss hidden">Enter a Valid URL</span></span></label>

 <input placeholder="http://$host[:port]/appname" name="appNameURL" class="form-control appURL" type="text">
 <b class="tooltip tooltip-top-right">
 <i class="fa fa-user txt-color-teal"></i> Please enter URL</b>
 </div>
 </div>



 </div>
 <div class="modal-footer">
 <label id="nodeAppspinner" class=" hidden"><img  style="margin-left:5px;margin-right:25px;" src="img/select2-spinner.gif"></label>
 <div class="marginForButtons">
 <button id="addAppBtn" class="btn btn-primary" type="submit">
 <i class="fa fa-upload fa-1x"></i>&nbsp;Add
 </button>
 <a class="btn btn-primary" type="submit" data-dismiss="modal">
 <i class="fa fa-undo fa-1x"></i>&nbsp;Cancel
 </a>
 </div>
 </div>
 </form>
 </div><!-- /.modal-content -->
 </div><!-- /.modal-dialog -->
 </div><!-- /.modal for appSeries ends-->
 <!--app series ends here-->
 <!--launch docker-->
 <div class="modal fade bs-example-modal-lg" id="myModalLabelDockerContainer" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
 <div class="modal-dialog modal-lg">
 <div class="modal-content">
 <div class="modal-header">
 <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
 <h4 class="modal-title" id="DockerLaunch">Launch Parameters-Docker Blueprints</h4>
 </div>
 <div class="modal-body dockerModalHeight">
 <section>
 <form id="dockerparamsform" action="">


 <div style="margin:0px;">
 <div class="col-lg-6 col-md-6">
 <label for="category">Container Name<span style="color:red">*</span><span class="dockerparamrequired hidden" style="color:red">&nbsp;Required</span>
 </label>

 <input type="text" id="Containernamefield" name="namefield" class="required form-control" placeholder="" dockerparamkey="--name" onclick="$('.dockerparamrequired').addClass('hidden')">

 </div>
 <div class="col-lg-6 col-md-6">
 <label for="category">Port Mappings
 </label>

 <input type="text" id="Portmappingfield" name="Portmappingfield" class=" form-control" placeholder="Map host ports to container ports" dockerparamkey="-p">

 </div>
 <div class="col-lg-6 col-md-6 dockerModal">
 <label for="category">Volumes
 </label>

 <input type="text" id="Volumesfield" name="Volumesfield" class=" form-control" placeholder="Map host folders to container folders"  dockerparamkey="-v">

 </div>
 <div class="col-lg-6 col-md-6 dockerModal">
 <label for="category">Volumes-from
 </label>

 <input type="text" id="Volumes-fromfield" name="Volumes-fromfield" class=" form-control" placeholder="Comma separated container names" dockerparamkey="--volumes-from">

 </div>
 <div class="col-lg-6 col-md-6 dockerModal">
 <label for="category">Linked Container
 </label>

 <input type="text" id="Linkedcontainerfield" name="Linkedcontainerfield" class=" form-control" placeholder="The name of a container this one links to"  dockerparamkey="--link">

 </div>
 <div class="col-lg-6 col-md-6 dockerModal">
 <label for="category">Startup Command
 </label>

 <input type="text" id="Startupcommandfield" name="Startupcommandfield" class=" form-control" placeholder="Optional startup command for the container" dockerparamkey="-c">

 </div>
 <div class="col-lg-6 col-md-6 dockerModal">
 <label for="category">Additional Startup
 </label>

 <input type="text" id="additionalStartupcommandfield" name="additionalStartupcommandfield" class=" form-control" placeholder="Additional startup command for the container" dockerparamkey="-exec">


 </div>
 <div class="col-lg-6 hidden">
 <label for="category">Removed Linked Containers on Exit
 </label>

 <select class="chooseSelect width-100" id="Removelinkedcontainersonexitfield" placeholder="Should this & linked containers be removed on exit">
 <option>False</option>
 <option>True</option>

 </select>

 </div>
 <div class="col-lg-6 dockerModal hidden">
 <label for="category">Remove on Exit
 </label>

 <select class="chooseSelectExit width-100 " id="Removeonexitfield" placeholder="Should this container be removed when it exits">
 <option>False</option>
 <option>True</option>

 </select>

 </div>
 <div class="col-lg-6 hidden">
 <label for="">Startup Script</label>
 <label class="input input-file" for="file">
 <div class="button"><input type="file" id="Startupscriptfield" name="Startupscriptfield">Browse</div><input type="text" readonly="">
 </label>
 </div> 
 </div>




 </form>
 </section>
 </div>
 <div class="modal-footer">
 <button type="button" class="btn btn-default btn-primary" onclick="if(generateDockerLaunchParams()!=''){$('#myModalLabelDockerContainer').modal('hide');}else{return(false);}">
 <i class="fa fa-save fa-1x" ></i>&nbsp;Add</button>
 <button type="button" class="btn btn-default btn-primary" data-dismiss="modal">
 <i class="fa fa-undo fa-1x"></i>&nbsp;Cancel</button>
 </div>
 </div>
 </div>
 </div>


 <script type="text/javascript">
 $('#launchParamDocker').click(function(){
   $('#dockerparamsform')[0].reset();
   $('.chooseSelectExit').change();
 });

	//for adding the new App Series(Name and URL)
	/*$('.addNewApp').click(function() {
	$('#appSeries').clone().insertAfter('.applicationURLContainer:last');
})*/;
	
	function generateDockerLaunchParams(){
   if($('#Containernamefield').val() == ''){
     $('.dockerparamrequired').removeClass('hidden');
     return('');
   }

   var launchparams = '';
   $('[dockerparamkey]').each(function(){
     if($(this).val() != ''){
       var itms = $(this).val().split(',');
       for(itm in itms)
         launchparams += ' ' + $(this).attr('dockerparamkey') + ' ' + itms[itm];
     }
   });
   $('#dockerlaunchparameters').val(launchparams);
   return(launchparams);
 }

 function loadLaunchParams(){
   if($('#dockerlaunchparameters').val() != ''){
     $('[dockerparamkey]').val('');
     var params = $('#dockerlaunchparameters').val().split(' -');
     for(para in params){
       var subparam = params[para].split(' ');
       if(subparam.length > 0){
         $inp = $('[dockerparamkey="-' + subparam[0] + '"]').first();
         if($inp.val() != '')
           $inp.val($inp.val() + ',' + subparam[1]);
         else
           $inp.val(subparam[1]);
       }
     }
   }
   $('#myModalLabelDockerContainer').modal('show');
 }

 function helperConstructOption(data,keyList,nameKey,valueKey){
   function getOptionAppend(obj,keyList,nameKey,valueKey){
     var str='<option ';
     for(var i=0;i<keyList.length;i++){
       str=str+keyList[i]+'="'+obj[keyList[i]]+'" ';
     }
     str=str + 'value="'+obj[valueKey]+'" >'+obj[nameKey]+'</option>';
     return str;
   }

   var str=''
   for(var i=0;i<data.length;i++){
     str=str+getOptionAppend(data[i],keyList,nameKey,valueKey);			
   }
   return str;
 }

 function getProviderList(){
   $.ajax({
     type: "GET",
     url: "/aws/providers",
     success: function (data) {
       data= typeof data =="string" ? JSON.parse(data) :data;
       console.log(data);
       var str=' <option value="">Select Provider</option>',len=data.length;
       str=str+helperConstructOption(data,['secretKey','accessKey','providerType'],'providerName','_id');
       $('#providerId').html(str);
     },
     failure: function (data) {
       alert(data.toString());
     }
   }); 
 }

 function getImagesWithOSFilter(){

  function getFilteredList(data,value){
    if(!value){
      return data;
    }
    var list=[];
    for(var i=0;i<data.length;i++){
      if(data[i].osName.toLowerCase()===value.toLowerCase()){
        list.push(data[i]);
      }
    }
    console.log(list);
    return list;
  }


  function loadData(){
    var providerVal=$('#providerId').val();
    if(providerVal){
     $.get("/vmimages/providers/"+providerVal,function(data){
      var str=' <option value="">Select Image</option>',data=getFilteredList(data,$('#instanceOS').val()),
      len=data.length;
      str=str + helperConstructOption(data,['providerId','vType','osType','_id'],'name','imageIdentifier');
      $('#imageId').html(str).select2().trigger('change');
    });
   }else{
     $('#imageId').html('<option value="">Select Image</option>').select2().trigger('change');
   }
 }

 $('#providerId').on('change',loadData);
 $('#instanceOS').on('change',loadData);
}

/*function getImageList(){
	$.ajax({
   method: "GET",
   url: "/vmimages",
   success: function(data, success) {
     data = typeof data ==="string" ?JSON.parse(data) :data ;
     var str='<option value="">Choose Image</option>';
     for(var i=0;i<data.length;i++){
       str=str+'<option value="'+data[i]._id+'">'+data[i].name+'</option>';
     }
     $('#imageId').html(str).select2();
   },
   error: function(jqxhr) {
     console.log(jqxhr.responseText);
     alert(jqxhr.responseText);
   },
   failure: function(data) {
     bootbox.alert(data);
   }
 });
} */
function getSecurityCheckedList(){
  var list=[]
  $('#securityGroupIds').find('input[type="checkbox"]:checked').each(function(){
    list.push(this.value);
  });
  return list;
}

function getImageInstances(){
  $('#imageId').on('change',function(){
    $.get("/vmimages/instancesizes/all/list",function(data){
      var vType= $('#imageId').find('option:selected').attr('vType'),str='<option value=""> Select Instance Size</option>';
      var list=[];

      for(var i=0;i<data.length;i++){
        for(var key in data[i]){
          if(vType==key){
            list=data[i][key];
            break;
          }
        }
      }
      for(var i=0;i<list.length;i++){
        str=str+'<option value="'+list[i]+'">'+list[i]+'</option>'
      }
      $('#instancesize').html(str).select2();

    });

  });
}
var regionList;
function getCompleteRegionList(){
  $.get('/vmimages/regions/list',function(data){
  regionList=data;
    }); 
}
getCompleteRegionList();


function getSecurityGroup(){

function bringAllOpenFirst(data){
var temp,index;
for(var i=0;i<data.length;i++){
	if(data[i].GroupName=="all_open"){
		temp=data[i];
		index=i;
		break;
	}
}
if(temp){

data[index]=data[0];
data[0]=temp;
}
return data;
}

  function populateData(){
    var $provider=$('#providerId');
    var accessKey=$provider.find("option:selected").attr('accessKey'),
    secretKey=$provider.find("option:selected").attr('secretKey'),
    region=$('#region').val(),
    vpcId=$('#vpcId').val();
    if(accessKey && secretKey && region && vpcId){
      $.ajax({
        url:'/aws/providers/vpc/'+vpcId+'/securitygroups',
        method:"post",
        data:{"accessKey":accessKey,"secretKey":secretKey,"region":region},
        success:function(list){
         // debugger;
        var str='',getTemplate=function(val,name){
          return '<label class="toggle font-sm" style="padding-left:4px;"><input onclick="if($(this).is(&quot;:checked&quot;)) {$(this).closest(&quot;label&quot;).'+
          'css(&quot;background-color&quot;,&quot;#eeeeee&quot;);$(this).css(&quot;border-color&quot;,&quot;#3b9ff3&quot;);}else{$(this).closest(&quot;label&quot;).css(&quot;background-color&quot;,&quot;#ffffff&quot;);$(this).css(&quot;border-'+
            'color&quot;,&quot;red&quot;);}" type="checkbox" name="checkbox-toggle" rowid="1ae4f099-7adc-4089-81c6-db2248774142"'+
      'value="'+val+'" style="width:100%"><i data-swchoff-text="NO" data-swchon-text="YES"></i>'+name+'</label>';
    },list=bringAllOpenFirst(list),len=list.length;
    for(var i=0;i<len;i++){
      str=str+getTemplate(list[i].GroupId,list[i].GroupId+' | '+list[i].GroupName);
    }
    $('#securityGroupIds').html('').append(str);

  },
  error:function(xhr){
    bootbox.alert(xhr.responseText);
  }

});
}
else{
  $('#securityGroupIds').html('');
}
}

$('#vpcId').on('change',populateData);
}

function getkeypairList(){
	function getRegionName(regionValue){
		for(var i=0;i<regionList.length;i++){
			if(regionList[i].region.toLowerCase()==regionValue.toLowerCase()){
				return regionList[i].region_name;
			}
		}
	}
  $('#providerId').on('change',function(){

    var key=$(this).val();
    if(key){
      $.get('/aws/providers/'+key,function(data){
        var keylist=data.keyPairs;
        var str='<option value="">Select KeyPairs</option>';

        for(var i=0;i<keylist.length;i++){
          str=str+'<option value="'+keylist[i]._id+'">'+keylist[i].keyPairName+'</option>';
        }
        $('#keypairId').html(str).select2();

        /*bring Region list from providers*/
        var str1='<option value="">Select Region</option>';
        for(var i=0;i<keylist.length;i++){
          str1=str1+'<option value="'+keylist[i].region+'">'+getRegionName(keylist[i].region)+' | '+keylist[i].region+'</option>';
        }
        $('#region').html(str1).select2();

      });
    }

  });
}

function getVPC(){

  function populateData(){
    var $provider=$('#providerId');
    var accessKey=$provider.find("option:selected").attr('accessKey'),
    secretKey=$provider.find("option:selected").attr('secretKey'),
    region=$('#region').val();
    if(accessKey && secretKey && region){
      $.ajax({
        url:"/aws/providers/describe/vpcs",
        method:"post",
        data:{"accessKey":accessKey,"secretKey":secretKey,"region":region},
        success:function(data){
          console.log(data);
          var str='';
          var filteredData=[];
          for(var i=0;i<data.Vpcs.length;i++){
            if(data.Vpcs[i].State.toLowerCase()=="available"){
              filteredData.push(data.Vpcs[i]);
            }
          }
          for(var i=0;i<filteredData.length;i++){
            if(filteredData[i].IsDefault){
              str=str+'<option selected value="'+filteredData[i].VpcId+'">'+filteredData[i].VpcId+' ('+filteredData[i].CidrBlock+') Default</option>';
            }else{
              str=str+'<option value="'+filteredData[i].VpcId+'">'+filteredData[i].VpcId+' ('+filteredData[i].CidrBlock+') '+
              (filteredData[i].Tags.length?filteredData[i].Tags[0].Value:"")+'</option>';
            }
          }
          $('#vpcId').html(str).select2().trigger('change');
        },
        error:function(xhr){
          bootbox.alert(xhr.responseText);
        }

      });
}
else{
  $('#vpcId').html('<option value="">Select VPC</option>').select2()
}
}

$('#providerId').on('change',populateData);
$('#region').on('change',populateData);
}

function getSubnet(){
  function populateData(){
    var $provider=$('#providerId');
    var accessKey=$provider.find("option:selected").attr('accessKey'),
    secretKey=$provider.find("option:selected").attr('secretKey'),
    region=$('#region').val(),
    vpcId=$('#vpcId').val();
    if(accessKey && secretKey && region && vpcId){
      $.ajax({
        url:"/aws/providers/vpc/"+vpcId+"/subnets",
        method:"post",
        data:{"accessKey":accessKey,"secretKey":secretKey,"region":region},
        success:function(data){
         // debugger;
         console.log(data);
         var str='<option value="">Select Subnet</option>';
         var filteredData=[];
         for(var i=0;i<data.Subnets.length;i++){
          if(data.Subnets[i].State.toLowerCase()=="available"){
            filteredData.push(data.Subnets[i]);
          }
        }

         // str=str+ helperConstructOption(filteredData,[],'SubnetId','SubnetId');

         for(var i=0;i<filteredData.length;i++){
          str=str+'<option value="'+filteredData[i].SubnetId+'">'+filteredData[i].SubnetId+' ('+filteredData[i].AvailabilityZone+') '+
          (filteredData[i].Tags.length?filteredData[i].Tags[0].Value:"")+'</option>';
          
        }

        $('#subnetId').html(str).select2();
      },
      error:function(xhr){
        bootbox.alert(xhr.responseText);
      }

    });
}
else{
  $('#subnetId').html('<option value="">Select Subnet</option>').select2()
}
}

$('#vpcId').on('change',populateData);
}

function resetForm(){
	$('input').val('');
	$('select').val('').select2();
	$('[multiselect]').empty();
}
/*function getRegionList(){
  $('#providerId').on('change',function(){

    var key=$(this).val();
    if(key){
      $.get('/aws/providers/'+key,function(data){
        var keylist=data.keyPairs;

 // var regionList=$(this).find("option:selected").attr('keyPairs');
   // regionList=regionList ?regionList.split(',') :[];
   var str='<option value="">Select Region</option>';

   for(var i=0;i<keylist.length;i++){
    str=str+'<option value="'+keylist[i].region+'">'+keylist[i].region+'</option>';
  }
  $('#region').html(str).select2();

});
    }

  }*/
  $(document).ready(function(){

    getProviderList();
    getImageInstances();
    getSecurityGroup();
    getkeypairList();
    getVPC();
    getSubnet();
    getImagesWithOSFilter();

    console.log("Orgname===>" + localStorage.getItem('selectedOrgName'));
    $.get('../aws/ec2/amiids',function(data){
     var $instanceOS = $('#instanceOS');
     $instanceOS.append('<option value="">Select Operating System</option>')
     for(var i=0;i<data.length;i++) {
       $option = $('<option data-amiid="'+data[i].amiid+'" data-amiid-username="'+data[i].username+'" data-instanceOS="'+data[i].osType+'" value="'+data[i].name+'">'+data[i].name+'</option>');
       $option.data('supportedInstanceType',data[i].supportedInstanceType);
       $instanceOS.append($option);
     }
     var $instanceType = $('#intanceTypeControl');
     $instanceOS.change(function(e){
       $instanceType.empty();

       $selectedOption = $(this).find('option:selected');
       var supportedInstanceType = $selectedOption.data('supportedInstanceType');
       console.log(supportedInstanceType);
       if(typeof supportedInstanceType != 'undefined')
       {
         for(var i=0;i<supportedInstanceType.length;i++) {
           var $option = $('<option></option>').val(supportedInstanceType[i]).html(supportedInstanceType[i]);
           $instanceType.append($option);
         }
       }
       $instanceType.select2(); 


     });
     $instanceOS.select2();
     $instanceOS.trigger('change');

   }); 
	
	$(".chooseOrgselect2").select2();    
	$(".chooseOS").select2();
	$(".chooseSecurity").select2();
	$(".chooseInstance").select2();
	//$(".chooseImage").select2();
	$(".chooseBG").select2();
	$(".chooseProject").select2();
	$(".chooseEnv").select2();
	$(".chooseDockerContainer").select2();
	$(".chooseSelectExit").select2();
	$('select').select2();
	/*$.ajax({
	url: "/d4dMasters/readmasterjsonnew/22",
	dataType: "json",
	type: "GET",
	cache: "true",
	
	//async: false,
	
	success: function(data) {
	//alert(data);
	//console.log("Image Data>>>>>>>>>>>> "+data);
	var data = JSON.parse(JSON.stringify(data));
	//alert(data);
	var $imgListInput = $('#imagename');
	// console.log("Image Json>>>>>>>>>>  "+data);
	for (var i = 0; i < data.length; i++) {
	//alert(data[i].imagename);
	$imgListInput.append($('<option></option>').val(data[i].rowid).html(data[i].imagename));
	}
	
	}
});*/
	$.ajax({
   url: "/d4dMasters/readmasterjsonnew/16",
   dataType: "json",
   type:"GET",
   cache: "true",
   success: function(data){
     var rowLength = JSON.stringify(data.length);
     var containerTemp = "";
     var selectedrow = false;
     var getDesignTypeImg; var getDesignTypeRowID;
	//alert(JSON.stringify(data));
	for(var i=0; i<rowLength; i+=1){

   getDesignTypeImg= data[i]['designtemplateicon_filename'];
   getDesignTypeRowID= data[i]['rowid'];
	// for(var x=0;x < data.masterjson.rows.row[i].field.length;x++){


	//     if(data.masterjson.rows.row[i].field[x].name == "rowid"){
	//       getDesignTypeRowID = data.masterjson.rows.row[i].field[x].values.value;
	//     }
	//  if(data.masterjson.rows.row[i].field[x].name == "designtemplateicon_filename"){
	//       getDesignTypeImg = data.masterjson.rows.row[i].field[x].values.value;
	
	//     }
	
	
	// }
	containerTemp += '<div class="" style="width:222px;float:left">'+
	' <div id=grid'+i+' class="blueprintdiv appfactory" data-'+
	'templateType="'+data[i]['templatetypename']+'">'+
	'<div style="">'+
	'<img  style="height:25px;padding:2px" alt="" src="img/app-store-'+
	'icons/Logoheader.png"><span style="padding-top:4px;position:absolute;'+
	'padding-left: 4px;">'+
	'<b>'+data[i]['templatetypename']+'</b>'+
	'</span></div>'+
	'<div style="padding-top:10px;padding-left:27px;">'+
	'<img alt="JBoss Stack" '+
	//'src="/d4dMasters/image/'+getDesignTypeRowID+'__designtemplateicon__'+getDesignTypeImg+'">'+
	'src="/d4dMasters/image/'+getDesignTypeRowID+'__designtemplateicon__'+getDesignTypeImg+'" style="height:60px;width:auto;">'+
	'</div></div></div>';
	
}

$("#templateContent").append(containerTemp);   
$("#templateContent #grid0").addClass("role-Selected");
}
});
	
	$('#templateContent').on("click",'.blueprintdiv', function () {
   $('#templateContent .role-Selected').removeClass('role-Selected');
   $(this).addClass('role-Selected');

 });
	$('#individualTemplateNameGrid').on("click",'.productdiv2', function () {
		if(!$(this).hasClass('role-Selected')){
			$('#individualTemplateNameGrid').find('.role-Selected').removeClass('role-Selected');
			$(this).addClass('role-Selected');
			resetForm();			
   }
 });
});
	
  </script>


  <script type="text/javascript">
  var reqBody;
  var $wizard = $('#bootstrap-wizard-1').bootstrapWizard({
   'tabClass': 'form-wizard',
   'onNext': function(tab, navigation, index) {

     console.log(navigation, index)
     if (index === 1) {
       $("#tabheader").html('Choose Templates');
       var $selectedItem = $('.role-Selected');
       if (!$selectedItem.length) {
         alert('please choose a blueprint design');
         return false;
       }
       var $clone = $selectedItem.clone().removeClass('role-Selected');
       var selectedText = $clone.attr("data-templateType");
       var getID = parseInt($clone.attr("id").replace("grid", ""), 10);	
       $.ajax({
         url: "/d4dMasters/readmasterjsonnew/17",
         dataType: "json",
         type: "GET",
         cache: "true",
         success: function(data) {
           var rowGridLength = (data.length);
           var getIndividualData = "";
           var getTempName;
           var getRowID, getImage;
	//alert(JSON.stringify(data));
	for (var z = 0; z < rowGridLength; z += 1) {
	//iterate thhrough columns to get correct column and value
	var selectedrow = false;
	var currField = null;
	
	getTempName = data[z]['templatename'];
	
	
	getRowID = data[z]['rowid'];
	getImage = data[z]['templatesicon_filename'];
	getTemplateType = data[z]['templatetypename'];
	
	if(selectedText != getTemplateType)
   continue;

 gettemplatescookbooks = data[z]['templatescookbooks'].replace(/"/g, "");
 dockercontainerpathstitle = data[z]['dockercontainerpathstitle'];
 dockercontainerpaths = data[z]['dockercontainerpaths'];
 dockerreponame = data[z]['dockerreponame'];
	//To be removed and converted to reference when the new master model is implemented.
	dockerusername = '';
	dockercred = '';
	dockeremail = '';
	
	//alert(JSON.stringify(data));
	// for (var x = 0; x < data.masterjson.rows.row[z].field.length; x++) {
	//     if (data.masterjson.rows.row[z].field[x].name == "templatesicon_filename") {
	//         getImage = data.masterjson.rows.row[z].field[x].values.value;
	//         //alert(getImage);
	//     }
	//     if (data.masterjson.rows.row[z].field[x].name == "rowid") {
	//         getRowID = data.masterjson.rows.row[z].field[x].values.value;
	//     }
	//     if (data.masterjson.rows.row[z].field[x].name == "templatetypename") {
	//         getTemplateType = data.masterjson.rows.row[z].field[x].values.value;
	//     }
	//     if (data.masterjson.rows.row[z].field[x].name == "templatescookbooks") {
	//         gettemplatescookbooks = data.masterjson.rows.row[z].field[x].values.value;
	//         //clearing additional double quotes
	//         gettemplatescookbooks = gettemplatescookbooks.replace(/"/g, "");
	//     }
	
	//     if (data.masterjson.rows.row[z].field[x].name == "templatename") {
	//         getTempName = data.masterjson.rows.row[z].field[x].values.value;
	//     }
	//     if (data.masterjson.rows.row[z].field[x].name == "templatetypename") {
	//         if (data.masterjson.rows.row[z].field[x].values.value == selectedText) {
	//             selectedrow = true;
	//         }
	//     }
	
	//     //For docker 
	//     if (data.masterjson.rows.row[z].field[x].name == "dockercontainerpathstitle") {
	//         dockercontainerpathstitle = data.masterjson.rows.row[z].field[x].values.value;
	//     }
	//     if (data.masterjson.rows.row[z].field[x].name == "dockercontainerpaths") {
	//         dockercontainerpaths = data.masterjson.rows.row[z].field[x].values.value;
	//     }
	//     if (data.masterjson.rows.row[z].field[x].name == "dockerreponame") {
	//         dockerreponame = data.masterjson.rows.row[z].field[x].values.value;
	//         //
	
	//     }
	
	// }
	console.log('here end');
	
	
	getIndividualData += '<div class="col-sm-3 col-lg-2 col-md-3">' +
	'<div class="productdiv2" data-templateId="' + getTempName + '" data-' +
	'templateComponent="component' + z + '" ' +
	'dockercontainerpathstitle="' + dockercontainerpathstitle + '" ' +
	'dockercontainerpaths="' + dockercontainerpaths + '" ' +
	'dockerreponame="' + dockerreponame + '" ' +
	'data-templateName="' + getTempName + '" data-' +
	'templateType="' + getTemplateType + '" templatetype="' + getTemplateType + '" templatename="' + getTempName + '" templatescookbooks="' + gettemplatescookbooks + '">' +
	'<ul class="list-unstyled system-prop" style="text-align:center;">' +
	'<li><img style="height:40px;width:auto;" alt="" ' +
	'src="/d4dMasters/image/' + getRowID + '__templatesicon__' + getImage + '">' +
	'</li><li style="font-size:12px;"><u><b>' + getTempName + '</b></u></li>';
	//If standard template
	if (getTemplateType != "Docker") {
   var cb = gettemplatescookbooks.split(',');
   var licb = '';
	//alert(cb.length);
	for (var cbi = 0; cbi < cb.length; cbi++) {
   licb += '<li style="font-size:10px;" blueprinttype="other">' + cb[cbi] + '</li>';
 }
	} else //when template type is docker
	{
	//  alert(dockerreponame);
	var cb = dockercontainerpathstitle.split(',');
	var cbpath = dockercontainerpaths.split(',');
	var licb = '';
	//alert(cb.length);
	for (var cbi = 0; cbi < cb.length; cbi++) {
   licb += '<li style="font-size:10px;" path="' + cbpath[cbi] + '" title="Container" blueprinttype="dockercontainer">' + cb[cbi] + '</li>';
 }
}

getIndividualData += licb + '</ul></div></div>';


}
$("#individualTemplateNameGrid").html("");
	//$("#individualTemplateNameGrid").append(getParent);
	$("#individualTemplateNameGrid").append(getIndividualData).find('.productdiv2').first().click();
	//$("#grid0").addClass("role-Selected");
}


});
	//console.log('in here')
	//alert('here');
	// var $selectedItem = $('.role-Selected');
	// if (!$selectedItem.length) {
	//     alert('please choose a blueprint design')
	//     return false;
	// }
	// var $clone = $selectedItem.clone().removeClass('role-Selected');
	$('#tab' + (index + 1)).find('.temp').empty().append($clone);
	$('.' + $selectedItem.attr('data-templateType')).find('.productdiv2:first').trigger('click');
	
} else if (index == 2) {
	$("#tabheader").html('Choose Template');
	//   var $selectedTemplateArea = $('.selectedTemplateArea')
	//   var $selectedItem = $selectedTemplateArea.find('.productdiv2');
	//   console.log($selectedItem.length);
	//   if(!$selectedItem.length) {
	//     alert('please choose a template');
	//     return false;
	
	// }
	//alert('kickin 2');
	
	//If a docker type of template selected then select the Org 
	var $selectedItem = $('.role-Selected');
	// alert('in ' + $selectedItem.length);
	if (!$selectedItem.length) {
   alert('please choose a blueprint design');
   return false;
 }
	//Selection of Orgname from localstorage 
	//   $('#orgnameSelect').val($('li[class*="orgSelected"]').text().trim());
	$('#orgnameSelect').val(localStorage.getItem('selectedOrgId'));
	console.log('role-Selected before ==> ',$('#tab2 .role-Selected').length);
	if ($('.productdiv2.role-Selected').length > 0) {
	//Setting controls connected to docker to hidden
	$('.fordocker').hide();
	$('.notFordocker').show();
	
	$('.divconfigureparameterrunlist').show();
	$('.divchefrunlist').show();
	
	if ($('.productdiv2.role-Selected').first().attr('templatetype') == "Docker") {
	//Checking if docker then only Edit organization paramerters are to be shown
	if(!$('#CollapseEditorgParam').hasClass('in')){
   $('a[href="#CollapseEditorgParam"]').click();
 }
 $('.divconfigureparameterrunlist').hide();
 $('.divchefrunlist').hide();
	//When docker stepping to 4th tab
	
	$('#orgnameSelect').trigger('change');
	//$('a[href="#tab3"]').first().trigger('click');
	
	//populating the docker repo titles
	var $dockerrepotitles = $('.productdiv2.role-Selected').attr('dockercontainerpathstitle').split(',');
	var $dockerrepopaths = $('.productdiv2.role-Selected').attr('dockercontainerpaths').split(',');
	var $dockerreponame = $('.productdiv2.role-Selected').attr('dockerreponame');
	var $dockerrepoListInput = $('#dockerrepoListInput');
	$dockerrepoListInput.empty();
	
	$dockerrepotitles.forEach(function(k, v) {
   var $opt = $('<option value="' + $dockerrepotitles[v] + '" repopath="' + $dockerrepopaths[v] + '">' + $dockerrepotitles[v] + '</option>');
   $dockerrepoListInput.append($opt);
 });
	
	//Setting the appropriate tags
	//Attaching the change event to pull tags for the select repo
	$dockerrepoListInput.change(function(e) {
	//tutum/centos
	//alert('Docker Query -> ' +  '/d4dmasters/getdockertags/' + encodeURIComponent($(this).find('option:selected').attr('repopath')) + '/' + $dockerreponame);
	$.get('/d4dmasters/getdockertags/' + encodeURIComponent($(this).find('option:selected').attr('repopath')) + '/' + $dockerreponame, function(data) {
	//Sample json given below
	//[{"layer": "cddde0cd", "name": "latest"}, {"layer": "3baf8932", "name": "6.4"}, {"layer": "d1c0a07f", "name": "6.5"}, {"layer": "a9dd9e89", "name": "centos5"}, {"layer": "02398e09", "name": "centos6"}, {"layer": "4e5b3b2f", "name": "centos7"}]
	
	if (data) {
   var tagJson = JSON.parse(data);
   var $dockerrepotagsdiv = $('#dockerrepotagsdiv');

   $dockerrepotagsdiv.empty();
   var dockerrepotags = [];
   tagJson.forEach(function(k, v) {
	//<p class="bg-success"><i style="padding-left:10px;padding-right:10px" class="ace-icon fa fa-check"></i>CentOS</p>
	if (v < 3) {
   $('#dockerrepotagsdiv').append('<div class="codelistitem" style="margin-top:2px;padding-top:2px;border:1px solid #eeeeee; background-color:#eeeeee !important;height:26px;"><p class="bg-success"><i style="padding-left:10px;padding-right:10px" class="ace-icon fa fa-check"></i>' + tagJson[v].name + '</p></div>');
   if (dockerrepotags == '')
     dockerrepotags += tagJson[v].name;
   else
     dockerrepotags += ',' + tagJson[v].name;
 }
	//limiting the number to the top 5
});
   $('.productdiv2.role-Selected').first().attr('dockerrepotags', dockerrepotags);
   $('.productdiv2.role-Selected').first().attr('dockerimagename', $dockerrepoListInput.val());
 }
});
});
	//dockerrepotagsul
	$dockerrepoListInput.trigger('change');
	
	//End Setting appropriate tags
	//polulate the docker tags
	var $dockerrepotagsul = $('#dockerrepotagsul');
	$('.fordocker').show();
	$('.notFordocker').hide();
	//return (true);
} else {
	
	if(!$('#CollapseConfigureproviderParameter').hasClass('in')){
   $('a[href="#CollapseConfigureproviderParameter"]').click();
 }
}
}

console.log('role-Selected after ==> ',$('#tab2 .role-Selected').length);

var $clone = $selectedItem.clone().removeClass('role-Selected');
var selectedText = $clone.attr("data-templateType");
if ($selectedItem.attr('data-templateType') == 'desktopProvisoning') {
	wizard.show(4);
	return false;
}
if ($('#tab2 .role-Selected').length > 0) {
	console.log('cloning');
	$('#tab3 .selectedTemplateArea').empty().append($('#tab2 .role-Selected').clone());
}
	//force clicking orgnameSelect
	$('#orgnameSelect').trigger('change');
  $(".chooseBG").change();
  $('.chooseProject').select2('data', null)
  $(".chooseEnv").change();
  $(".chooseDockerContainer").change();
	
	
} else if (index == 3) {
	$("#tabheader").html('Create Blueprint');
	var $selectedTemplateArea = $('.selectedTemplateArea');
	var $selectedItem = $selectedTemplateArea.find('.productdiv2');
	console.log($selectedItem.length);
	if (!$selectedItem.length) {
   alert('please choose a template');
   return false;
 }

 if ($('#orgnameSelect').val() === 'choose') {
   alert('please choose an Organization');
   return false;
 }


 reqBody = {};
 reqBody.templateId = $selectedItem.attr('data-templateId');
 reqBody.templateType = $selectedItem.attr('data-templateType');
 reqBody.templateComponents = $selectedItem.attr('data-templateComponent').split(',');
 reqBody.dockercontainerpathstitle = $selectedItem.attr('dockercontainerpathstitle');
 reqBody.dockercontainerpaths = $selectedItem.attr('dockercontainerpaths');
 reqBody.dockerlaunchparameters = $('#dockerlaunchparameters').val();
 reqBody.dockerreponame = $('.productdiv2.role-Selected').attr('dockerreponame');
	//dockerreponame
	/*if(!$('.deploymentsCookbookList').length) {
	alert('Please wait while we are fetching cookbooks.');
	return false;
}*/
	//Get all the runlist 
	var cbs = [];
	var $ccrs = $('.cookbookShow').data('$ccrs');
    cbs = $ccrs.getSelectedRunlist();
	reqBody.runlist = cbs.join(); //$('#cookbookSelect').val();
	//reqBody.chefServerId = $('#cookbookSelect').data('chefServerId',);
	var $ccrs = $('.cookbookShow').data('$ccrs');
	reqBody.chefServerId = $ccrs.getChefServerId();
	reqBody.instanceType = $('select.instanceType').val();
	reqBody.instanceOS = $('#instanceOS').val();
	console.log(reqBody);
	
	
	console.log("reqBody ==>", reqBody);
	if (!reqBody || reqBody == "undefined") {
   console.log('resetting');
   var reqBody = {};
 }
	//reqBody.runlist = $('#cookbookSelect').val();
	var $ccrs = $('.cookbookShow').data('$ccrs');
	var cbs = [];
	cbs = $ccrs.getSelectedRunlist();
	reqBody.runlist = cbs; //$('#cookbookSelect').val();
	//reqBody.chefServerId = $('#cookbookSelect').data('chefServerId');
	reqBody.chefServerId = $ccrs.getChefServerId();
	console.log("instanceType ==>", $('select.instanceType').val());
	reqBody.instanceType = $('select.instanceType').val();
	
	var $instanceOsoptionsSelected = $('#instanceOS').find('option:selected');
	console.log($('#instanceOS').val());
	console.log($instanceOsoptionsSelected);
	
	reqBody.instanceOS = $instanceOsoptionsSelected.attr('data-instanceOS');
	reqBody.instanceAmiid = $instanceOsoptionsSelected.attr('data-amiid');
	reqBody.instanceUsername = $instanceOsoptionsSelected.attr('data-amiid-username');
	// reqBody.instanceOS = $('#instanceOS').val();
	reqBody.templateId = $('.productdiv2.role-Selected').attr('data-templateId');
	reqBody.templateType = $('.productdiv2.role-Selected').attr('data-templateType');
	reqBody.templateComponents = $('.productdiv2.role-Selected').attr('data-templateComponent').split(',');
	
	//    reqBody.dockercontainerpathstitle = $('.productdiv2.role-Selected').attr('dockercontainerpathstitle');
	reqBody.dockercontainerpaths = $('#dockerrepoListInput :selected').attr('repopath'); //$('.productdiv2.role-Selected').attr('dockercontainerpaths');
	reqBody.dockerrepotags = $('.productdiv2.role-Selected').attr('dockerrepotags');
	reqBody.dockerimagename= $('#dockerrepoListInput').val();
	reqBody.dockerlaunchparameters = $('#dockerlaunchparameters').val();
	reqBody.dockerreponame = $('.productdiv2.role-Selected').attr('dockerreponame');
	//alert(reqBody.dockerreponame);
	reqBody.iconpath = $('.productdiv2.role-Selected').find('img[src*="__templatesicon__"]').first().attr('src');
	reqBody.orgId = $('#orgnameSelect').val();
	reqBody.bgId = $('#bgListInput').val();
	reqBody.projectId = $('#projectListInput').val();
	reqBody.envId = $('#envList').val();
	var imageIdentifier=$('#imageId').val();
	var imageId=$('#imageId').find('option:selected').attr('_id');
	var securityGroupIds=getSecurityCheckedList();
	var providerId=$('#providerId').val();
	var keyPairId = $('#keypairId').val();
	var instanceType=$('#instancesize').val();
	var vpcId=$('#vpcId').val();
	var subnetId=$('#subnetId').val();
	var region=$('#region').val();
 // var instanceOS=$('#instanceOS').data('instanceOS')

 // reqBody.providerId=providerId;
 reqBody.keyPairId=keyPairId;
 reqBody.securityGroupIds=securityGroupIds;
 reqBody.instanceType=instanceType;
 reqBody.instanceAmiid=imageIdentifier;
 reqBody.instanceUsername='root';
 reqBody.vpcId=vpcId;
 reqBody.subnetId=subnetId;

 reqBody.name = $('#blueprintNameInput').val();
if(($('.role-Selected').data('templatetype')).toLowerCase()!="docker"){
 if(!reqBody.instanceOS){
  alert('Please Select Operating System');
  return false;

}

if(!providerId){
 alert("Please Select Provider");
 return false;
}

if(!imageId){
 alert("Please Select Image");
 return false;
}

if(!region){
  alert("Please Select Region");
  return false;
}

if(!vpcId){
	alert("Please Select VPC");
	return false;
}


if(!subnetId){
  alert("Please Select Subnet");
  return false;
}

if(!keyPairId){
 alert("Please Select KEyPAir");
 return false;
}
if(!instanceType){
  alert("Please Select Instance Size");
  return false;

}

if(!securityGroupIds.length){
  alert("Please Select Security Group");
  return false;
}

}

if (!reqBody.name) {
 alert("Please enter a blueprint name");
 return false;
 $('#blueprintNameInput').focus();

}
if (!reqBody.bgId || reqBody.bgId === 'choose') {
 alert("Please choose a business group");
 return false;
}
if (!reqBody.projectId || reqBody.projectId === 'choose') {
 alert("Please choose a project");
 return false;
}

if (!reqBody.envId || reqBody.envId === 'choose') {
 alert("Please choose an environment");
 return false;
}
$('#userListSelect').find('option').attr('selected','selected');
reqBody.users = $('#userListSelect').val();

if (!reqBody.users) {
 alert("Please choose users");
 return false;
}
	//alert(JSON.stringify(reqBody));
	var appUrls = []; 
	var $appUrlTableBody = $('#appUrlTable tbody');
	var $trs = $appUrlTableBody.find('tr');
	//alert($trs.length);
	$trs.each(function(e){
   var $this = $(this);
   appUrls.push($this.data('appUrlData'));
 });	
	reqBody.appUrls = appUrls;
	
	$('.blueprintMsgContainer').hide();
	
	
	$.post('/organizations/'+reqBody.orgId+'/businessgroups/'+reqBody.bgId+'/projects/' + reqBody.projectId + '/environments/' + reqBody.envId + '/providers/'+providerId+ '/images/'+imageId+'/blueprints', {
   blueprintData: reqBody
 }, function(data) {
   console.log(data);
   $('.blueprintSaveSuccess').show();
   var wizard = $wizard.data('bootstrapWizard');
   wizard.disablePreviouBtn();
 }).error(function(xhr){
   $('.blueprintSaveFail').find('h3').first().html(xhr.responseText);
   $('.blueprintSaveFail').show();
 });
 console.log('final', reqBody);

} 
},
'onPrevious': function(tab, navigation, index) {
	//console.log(index);
	if (index === 0) {
   $("#tabheader").html('Choose Template Type');
 }
 else if (index === 1) {
   $("#tabheader").html('Choose Templates');
 }
 else if (index === 2) {
   $("#tabheader").html('Choose Template');
 }
 else if (index === 3) {
   $("#tabheader").html('Create Blueprint');
 }

}
});
	
	
	var $rolesCards = $('.blueprintdiv')
	
	$('.blueprintdiv').on("click", function() {
	//alert("Inside");
	$rolesCards.removeClass('role-Selected');
	if ($(this).hasClass('role-Selected')) {
   $(this).removeClass('role-Selected');
 } else {
   $(this).addClass('role-Selected');
 }
	// $('.templates').hide();
	// console.log($(this).attr('data-templateType'));
	// $('.'+$(this).attr('data-templateType')).show();
	//$('.next a').attr('disabled',false);
});
	
	var $selectedTemplate = $('.productdiv2').click(function(e) {
   $selectedTemplate.removeClass('role-Selected');
   console.log("this ==> ",this); 
   var $this = $(this);
   $('.selectedTemplateArea').empty().append($this.clone(false).css({
     'cursor': 'auto'
   }));

   $this.addClass('role-Selected');
 });
	
	$.ajax({
   type: "get",
   dataType: "json",

   async: false,
   url: "../organizations/getTreeNew",
   success: function(data) {
     
     console.log(data);
     data = JSON.parse(JSON.stringify(data));
     var $orgListInput = $('#orgnameSelect');
	//$orgListInput.append($('<option></option>').val('choose').html('Choose'));
	$bgList = $('#bgListInput');
	var $envList = $('#envList');

	for (var i = 0; i < data.length; i++) {
   
   console.log(data[i].businessGroups);
   $orgListInput.append($('<option></option>').val(data[i].rowid).html(data[i].name).data('bglist', data[i].businessGroups).data('envList', data[i].environments));
 }
 $orgListInput.change(function(e) {
   
   var orgName = $(this).val();
   
   if (orgName == 'choose') {
     return;
   }
   var $selectedOrgOption = $(this).find(":selected");
   $bgList.empty();
   $bgList.append($('<option></option>').val('choose').html('Choose'));
	//alert('in' + JSON.stringify($selectedOrgOption.data('bglist')));
	
	var getBGs = $selectedOrgOption.data('bglist');
	if(getBGs != null){
   for (var i = 0; i < getBGs.length; i++) {
     $bgList.append($('<option></option>').val(getBGs[i].rowid).html(getBGs[i].name).data('projList', getBGs[i].projects));
   }
 }

	//alert('out');
	$envList.empty();
	var getEnv = $selectedOrgOption.data('envList');
	if(getEnv != null){
	//alert(JSON.stringify(getEnv));
	$envList.append($('<option></option>').val('choose').html('Choose'));
	//alert(getEnv.length);
	for (var i = 0; i < getEnv.length; i++) {
   $envList.append($('<option></option>').val(getEnv[i].rowid).html(getEnv[i].name));
 }
}

var $cookbookShow = $('.cookbookShow').empty();
$cookbookShow.append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />');
	//alert('here');
	var tcb = [];
	var $card = $('#tab3').find('div[class*="productdiv2"]').first();
	if($card.length){
   var templatescookbooks = $card.attr('templatescookbooks');
   if(templatescookbooks){
     tcb = templatescookbooks.split(',');
   }
 }
 /*var tcb = $('#tab3').find('div[class*="productdiv2"]').first().attr('templatescookbooks').split(',');*/

 console.log(tcb);
 console.log('tcbdhd == >',tcb);
 var $ccrs = $chefCookbookRoleSelector(orgName, function(data) {

 },tcb);
 $cookbookShow.empty();
 $cookbookShow.append($ccrs);
 $cookbookShow.data('$ccrs',$ccrs)



});
	
	var $projectList = $('#projectListInput');
	$bgList.change(function(e) {
   var bgName = $(this).val();
   if (bgName == 'choose') {
     return;
   }
   var $selectedOrgOption = $(this).find(":selected");
   $projectList.empty();
   $projectList.append($('<option></option>').val('choose').html('Choose'));
   var getProjs = $selectedOrgOption.data('projList');
	// alert(getProjs.length);
	for (var i = 0; i < getProjs.length; i++) {

   $projectList.append($('<option></option>').val(getProjs[i].rowid).html(getProjs[i].name));
 }
});
	
}
});
	
	
	(function() {

   var $loadingContainer = $('.userListLoadingContainer').empty().append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />').show();
   $.get('../users', function(userList) {
     var $userListSelect = $('#userListSelect').empty();
     userList = JSON.parse(userList);
     userList.sort(function(a, b) {
       var keyA = Object.keys(a);
       var keyB = Object.keys(b);

       if (keyA[0] < keyB[0]) return -1;
       if (keyA[0] > keyB[0]) return 1;
       return 0;
     });
     for (var i = 0; i < userList.length; i++) {
       var keys = Object.keys(userList[i]);
       var $option = $('<option></option>').append(keys[0]).val(keys[0]);
       $userListSelect.append($option);
     }
     $loadingContainer.hide();
     $userListSelect.show();
   }).error(function() {
     $loadingContainer.empty().append('Unable to load users. Please try again later.');
   });
 })();

 $(document).ready(function () {
   $("#blueprintNameInput").focus();
 });
 </script>
 <script>
 $('#newAppSeries').click(function(e){
   $('#appURLForm').trigger("reset");

 });
 $('#addAppBtn').click(function(e){
   var rowCount1 = $('#appUrlTable').find('tbody > tr').length;
	//alert(rowCount1);    
	if(rowCount1===2){
   $('#newAppSeries').addClass('hidden');
   return; 
 }
});
 
 $('#appURLForm').submit(function(e){
  var regexpURL = /(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/; 

  var $row = $('<tr/>');
  var appName = $(this).find('.appName').val();
  var appUrl = $(this).find('.appURL').val();
  if(!(appName)) {
    alert("Please Enter Name");
    return false;
  }
  if(!(appUrl)){
    alert('Please Enter URL');
    return false;
  }

  if(!regexpURL.test(appUrl)){
    alert('Please Enter a Valid URL');
    return false;
  }

  $row.data('appUrlData',{
    name:appName,
    url:appUrl
  })


  var $tdName =$('<td/>');
  $tdName.append(appName);
  var $tdURL =$('<td/>');
  $tdURL.append(appUrl);

  var $tdAction =$('<td/>');
  $tdAction.append('<div class="btn-group"><button class="btn btn-danger pull-left btn-sg tableactionbutton deleteURL" value="Remove" title="Remove"><i class="ace-icon fa fa-trash-o bigger-120"></i></button></div>');

            //<button class="btn btn-xs btn-info pull-left EditURL" title="Update"><i class="ace-icon fa fa-pencil bigger-120"></i></button>
            $tdAction.find('.deleteURL').click(function(){
              $row.remove();
              var rowCount2 = $('#appUrlTable').find('tbody > tr').length;
              if(rowCount2===1){
                $('#appEntry').removeClass('hidden');
                return;
              }
              if(rowCount2<3){
                //alert(rowCount2);
                $('#newAppSeries').removeClass('hidden');
                return;
              }
            });

            $row.append($tdName).append($tdURL).append($tdAction);
            $('#appUrlTable').find('tbody').append($row);
            $('#modalAppNameURL').modal('hide');
            $('#appEntry').addClass('hidden');
            return false;

          });
  </script>

