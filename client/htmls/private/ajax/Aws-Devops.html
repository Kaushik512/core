<div class="row">

    <article class="col-sm-12 col-md-12 col-lg-12">

        <div class="widget-body" style="font-size:12px;">

            <ul id="myTab3" class="nav nav-tabs tabs-pull-left">
                <!--<li class="active">
                    <a href="#l1" data-toggle="tab">Domains</a>
                </li>-->
                <li class="pull-left active">
                    <a href="#l2" data-toggle="tab">Create Blueprint</a>
                </li>
                <!--<li class="pull-left">
                    <a href="#l3" data-toggle="tab">App Factory</a>
                </li>
                <li class="pull-left">
                    <a href="#l4" data-toggle="tab">Enviornments</a>
                </li>
                <li class="pull-left">
                    <a href="#l5" data-toggle="tab">Usage</a>
                </li>-->
            </ul>

            <div id="myTabContent3" class="nav tab-content">


                <div class="tab-pane fade in active" id="l2">


                    <section id="widget-grid" class="">


                        <div class="row">


                            <article class="col-sm-12 col-md-12 col-lg-12">


                                <div class="jarviswidget jarviswidget-color-darken" id="wid-id-1" data-widget-editbutton="false" data-widget-deletebutton="false">



                                    <div role="content">


                                        <div class="jarviswidget-editbox">


                                        </div>

                                        <div class="widget-body">

                                            <div class="row">
                                                <form id="wizard-1" novalidate="novalidate">
                                                    <div id="bootstrap-wizard-1" class="col-sm-12">
                                                        <div class="form-bootstrapWizard">
                                                            <ul class="bootstrapWizard form-wizard" style="margin-left:13%;display:none">
                                                                <li class="active" data-target="#step1">
                                                                    <a href="#tab1" data-toggle="tab"> <span class="step">1</span>  
                                                                        <span class="title"><b></b></span> 
                                                                    </a>
                                                                </li>
                                                                <li data-target="#step2">
                                                                    <a id="addlink" data-target='#tab2' data-toggle="tab" onclick="">

                                                                        <span class="step">2</span>  
                                                                        <span class="title"><b></b></span>
                                                                    </a>
                                                                </li>
                                                                <li data-target="#step3">
                                                                    <a href="#tab3" data-toggle="tab">
                                                                        <span class="step">3</span>  <span class="title"><b></b></span> 
                                                                    </a>
                                                                </li>
                                                                <li data-target="#step4">
                                                                    <a href="#tab4" data-toggle="tab">
                                                                        <span class="step">4</span>  <span class="title"><b></b></span> 
                                                                    </a>
                                                                </li>
                                                                <!-- <li data-target="#step5">
                                                                    <a href="#tab5" data-toggle="tab">
                                                                        <span class="step">4</span>  <span class="title"><b></b></span> 
                                                                    </a>
                                                                </li> -->

                                                            </ul>
                                                            <div class="clearfix"></div>
                                                        </div>
                                                        <div class="tab-content">
                    <div class="tab-pane active" id="tab1" style="padding-bottom:20px;overflow-y: auto;">

                        <div id="templateContent" class="row " style="margin:0px;min-height:200px;">
                        
                        </div>
                    </div>
                    <div class="tab-pane" id="tab2" style="padding-bottom:20px;overflow-y: auto;">
                        <div class="row " style="margin:0px">
                            <div id="individualTemplateNameGrid" class="templatesAppfactory templates">


                            </div>

                            <div id="templatesDevopsRole" class="templatesdevopsrole templates" style="display:none">

                            </div>
                        </div>
                    </div>
                    <div class="tab-pane" id="tab3" style="padding-bottom:20px;">

                        <div class="row">
                          <div class="col-sm-2 col-xs-6">
                             <div class="row  selectedTemplateArea" style="margin-bottom:10px;padding-left:10px;margin-left:0px;margin-right:0px;"> Test
                             </div>
                          </div>
                          <div class="col-sm-10 col-xs-12">
                            <div class="panel-group smart-accordion-default" id="accordion-Design">
                              <div class="panel panel-default divconfigureparameterrunlist">
                                  <div class="panel-heading">
                                      <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseConfigureproviderParameter"> <i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Configure Provider Parameters</a>
                                      </h4>
                                  </div>
                                  <div id="CollapseConfigureproviderParameter" class="panel-collapse collapse in">
                                    <div class="panel-body">
                                       <div class="widget-body no-padding">
                                            <div action="" id="checkout-form" class="smart-form1" novalidate="novalidate">

                                                <div class="row " style="margin:0px;">
                                                    
                                                   <section class="col col-6">
                                                    <label for="">Choose Operating System <span style="color:red">*</span>
                                                    </label>
                                                    <label class="select">

                                                       <select id="instanceOS" class="chooseOS width-100">
                                                            <option value="linux">Cent OS</option>
                                                            
                                                      </select>

                                                    </label>                                          
                                                </section>
                                                <section class="col col-6">
                                                    <label for="category">Choose Security Group <span style="color:red">*</span>
                                                    </label>
                                                    <label class="select"> 
                                                        <select class="chooseSecurity width-100">
                                                            <option value="0">default-d4d</option>
                                                            <!--<option value="1">default-d4d</option>-->
                                                            <option value="2">Vpc-1</option>
                                                            <option value="3">Vpc-2</option>
                                                            <option value="4">Default VPC</option>

                                                        </select>
                                                    </label>
                                                
                                            </section>
                                            <section class="col col-6">
                                                <label for="category">Choose Instance Size <span style="color:red">*</span>
                                                </label>
                                                <label class="select"> 
                                                    <select class="instanceType chooseInstance width-100">
                                                        <option value="t1.micro">t1.micro</option>
                                                        
                                                        <option value="m1.small">m1.small</option>
                                                        <option value="m1.medium">m1.medium</option>
                                                        <option value="m1.large">m1.large</option>
                                                        <option value="m1.xlarge">m1.xlarge</option>
                                                    </select>
                                                </label> 

                                            </section>
                                            <!--To add the Swipe Functionality-->                            
                                            </div>
                                            </div>
                                        </div> 
                                    </div>
                                  </div>
                              </div>

                              <div class="panel panel-default divchefrunlist">
                                      <div class="panel-heading">
                                          <h4 class="panel-title">
                                            <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseConfigurechefRunlist" class="collapsed"><i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Configure Chef Runlist</a>
                                          </h4>
                                      </div>
                                      <div id="CollapseConfigurechefRunlist" class="panel-collapse collapse">
                                          <div action="" id="checkout-form" class="smart-form1" novalidate="novalidate">
                                                <div class="row " style="margin:0px;">
                                                    <section class="col col-6">
                                                        <label for="">Choose Organization <span style="color:red">*</span>
                                                        </label>
                                                        <label class="select"> 
                                                           <select id="orgnameSelect" class="chooseOrgselect2 width-100">
                                                           </select>
                                                       </label> 
                                                    </section>
                                                    <section class="col col-12">
                                                       <div class="cookbookShow">

                                                       </div>
                                                   </section>
                                                   
                                                </div>
                                            </div>
                                      </div>
                              </div>

                              <div class="panel panel-default divOrganizationParameter">
                                  <div class="panel-heading">
                                      <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion-Design" href="#CollapseEditorgParam" class="collapsed"><i class="fa fa-fw fa-plus-circle txt-color-blue"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i>Edit Organization Parameters</a>
                                      </h4>
                                  </div>
                                  <div id="CollapseEditorgParam" class="panel-collapse collapse">
                                      <div class="panel-body">
                                            <div action="" id="checkout-form" class="smart-form" novalidate="novalidate">

                                                <div class="row " style="margin:0px;">

                                                    <section class="col col-sm-6">
                                                        <label for="category">Blueprint Name <span style="color:red">*</span>
                                                        </label>
                                                        <label class="input">
                                                            <!-- <i class="icon-append fa fa-building"></i>  -->
                                                            <input type="text" id="blueprintNameInput"/>
                                                        </label>                                          
                                                    </section>

                                                    <section class="col col-sm-6">
                                                        <label for="category">Business Group <span style="color:red">*</span>
                                                        </label>
                                                        <label class="select"> 
                                                            <select id="bgListInput" class="chooseBG width-100">

                                                            </select>
                                                        </label>   
                                                    </section>
                                                </div>
                                            <div class="row " style="margin:0px;">
                                               <section class="col col-sm-6">
                                                <label class="label">Assign Users  <span style="color:red">*</span></label>
                                                <label class="select select-multiple">
                                                    <div class="userListLoadingContainer">
                                                        
                                                    </div>
                                                        <select class="custom-scroll" multiple="" id="userListSelect" style="display:none">

                                                        </select> 
                                                </label>
                                                </section> 

                                          
                                              <section class="col col-sm-6">
                                                        <label for="category">Project <span style="color:red">*</span>
                                                        </label>
                                                        <label class="select"> 
                                                          <select id="projectListInput" class="chooseProject width-100">

                                                          </select>
                                                      </label>   
                                                  </label>
                                              </section>
                                              <section class="col col-sm-6 offset6" style="">
                                                <label for="category">Environment <span style="color:red">*</span>
                                                </label>
                                                <label class="select"> 
                                                    <select  id="envList" class="chooseEnv width-100">

                                                    </select>
                                                </label>
                                                </label>
                                              </section>
                                            </div>
                   
                                           <section class="col col-6 fordocker">
                                                <label for="category">Select Docker Container <span style="color:red">*</span>
                                                </label>
                                                <label class="select"> 
                                                    <select id="dockerrepoListInput" class="chooseDockerContainer width-100">

                                                    </select>
                                                </label>   
                                            </section>
                                            <section class="col col-6 fordocker">
                                                <label for="category">Available Repo Tags <span style="color:red">*</span>
                                                </label>                 
                                                <div id="dockerrepotagsdiv">

                                                </div>       
                                            </section>
                                            </div>            
                                       </div>
                                  </div>
                              </div>
                            </div>
                          </div>
                        </div>
                    </div>


                                    <div class="col-lg-7">
                                                                    <h3>Support for this provider will be available in the next release...</h3>
                                                                </div>

                                                        </div>
                                                    </div>
                                                </form>
                                            </div>

                                        </div>


                                    </div>


                                </div>


                            </article>

                        </div>

                    </section>

                </div>

            </div>

        </div>

    </article>
    

</div>
<script type="text/javascript">

   
$(document).ready(function(){
    $(".chooseOrgselect2").select2();
    $(".chooseOS").select2();
    $(".chooseSecurity").select2();
    $(".chooseInstance").select2();
    $(".chooseBG").select2();
    $(".chooseProject").select2();
    $(".chooseEnv").select2();
    $(".chooseDockerContainer").select2();
   $.ajax({
    url: "/d4dMasters/readmasterjson/16",
    dataType: "json",
    type:"GET",
    cache: "true",
    success: function(data){
        var rowLength = JSON.stringify(data.masterjson.rows.row.length);
        var containerTemp = "";
        var selectedrow = false;
        var getDesignTypeImg; var getDesignTypeRowID;
        for(var i=0; i<rowLength; i+=1){
             getDesignTypeImg= "";
             getDesignTypeRowID= "";
            for(var x=0;x < data.masterjson.rows.row[i].field.length;x++){
               

                if(data.masterjson.rows.row[i].field[x].name == "rowid"){
                  getDesignTypeRowID = data.masterjson.rows.row[i].field[x].values.value;
                }
             if(data.masterjson.rows.row[i].field[x].name == "designtemplateicon_filename"){
                  getDesignTypeImg = data.masterjson.rows.row[i].field[x].values.value;
                  
                }
                    

            }
        containerTemp += '<div class="" style="width:222px;float:left">'+
                            ' <div id=grid'+i+' class="blueprintdiv appfactory" data-'+
                            'templateType="'+data.masterjson.rows.row[i].field[0].values.value+'">'+
                            '<div style="">'+
                            '<img  style="height:25px;padding:2px" alt="" src="img/app-store-'+
                            'icons/Logoheader.png"><span style="padding-top:4px;position:absolute;'+
                            'padding-left: 4px;">'+
                            '<b>'+data.masterjson.rows.row[i].field[0].values.value+'</b>'+
                            '</span></div>'+
                            '<div style="padding-top:10px;padding-left:27px;">'+
                             '<img alt="JBoss Stack" '+
            //'src="/d4dMasters/image/'+getDesignTypeRowID+'__designtemplateicon__'+getDesignTypeImg+'">'+
            'src="/d4dMasters/image/'+getDesignTypeRowID+'__designtemplateicon__'+getDesignTypeImg+'" style="height:60px;width:auto;">'+
                            '</div></div></div>';
                           
         }

         $("#templateContent").append(containerTemp);   
         $("#templateContent #grid0").addClass("role-Selected");
    }


});

// $("#nextSpecificValue").on("click", function(){
    
   
// });
//var $rolesCards = $('.blueprintdiv')

$('#templateContent').on("click",'.blueprintdiv', function () {
    $('#templateContent .role-Selected').removeClass('role-Selected');
        $(this).addClass('role-Selected');
    
    });
$('#individualTemplateNameGrid').on("click",'.productdiv2', function () {
  console.log(this);
    $('#individualTemplateNameGrid .role-Selected').removeClass('role-Selected');
        $(this).addClass('role-Selected');
    
    });
});




</script>


<script type="text/javascript">
   var reqBody;
   var wizard = $('#bootstrap-wizard-1').bootstrapWizard({
       'tabClass': 'form-wizard',
       'onNext': function(tab, navigation, index) {

           console.log(navigation, index)
           if (index === 1) {

               var $selectedItem = $('.role-Selected');
               if (!$selectedItem.length) {
                   alert('please choose a blueprint design');
                   return false;
               }
               var $clone = $selectedItem.clone().removeClass('role-Selected');
               var selectedText = $clone.attr("data-templateType");
               var getID = parseInt($clone.attr("id").replace("grid", ""), 10);

               // var getParent = '<div class="" style="width:222px;float:left">'+
               //                   ' <div class="blueprintdiv appfactory" data-'+
               //                   'templateType="">'+
               //                   '<div style="">'+
               //                   '<img  style="height:25px;padding:2px" alt="JBoss Stack" src="img/app-store-'+
               //                   'icons/Logoheader.png"><span style="padding-top:4px;position:absolute;'+
               //                   'padding-left: 4px;">'+
               //                   '<b>'+selectedText+'</b>'+
               //                   '</span></div>'+
               //                   '<div style="padding-top:10px;padding-left:27px;">'+
               //                   '<img  style="" alt="JBoss Stack" src="img/app-store-icons/Appfactory.png">'+
               //                   '</div></div></div><div cls=="clearfix"></div>';

               $.ajax({
                   url: "/d4dMasters/readmasterjson/17",
                   dataType: "json",
                   type: "GET",
                   cache: "true",
                   success: function(data) {
                       var rowGridLength = (data.masterjson.rows.row.length);
                       var getIndividualData = "";
                       var getTempName;
                       var getRowID, getImage;
                       for (var z = 0; z < rowGridLength; z += 1) {
                           //iterate thhrough columns to get correct column and value
                           var selectedrow = false;
                           var currField = null;
                           getTempName = '';
                           getRowID = '';
                           getImage = '';
                           getTemplateType = '';
                           gettemplatescookbooks = '';
                           dockercontainerpathstitle = '';
                           dockercontainerpaths = '';
                           dockerreponame = '';
                           for (var x = 0; x < data.masterjson.rows.row[z].field.length; x++) {
                               if (data.masterjson.rows.row[z].field[x].name == "templatesicon_filename") {
                                   getImage = data.masterjson.rows.row[z].field[x].values.value;
                                   //alert(getImage);
                               }
                               if (data.masterjson.rows.row[z].field[x].name == "rowid") {
                                   getRowID = data.masterjson.rows.row[z].field[x].values.value;
                               }
                               if (data.masterjson.rows.row[z].field[x].name == "templatetypename") {
                                   getTemplateType = data.masterjson.rows.row[z].field[x].values.value;
                               }
                               if (data.masterjson.rows.row[z].field[x].name == "templatescookbooks") {
                                   gettemplatescookbooks = data.masterjson.rows.row[z].field[x].values.value;
                               }

                               if (data.masterjson.rows.row[z].field[x].name == "templatename") {
                                   getTempName = data.masterjson.rows.row[z].field[x].values.value;
                               }
                               if (data.masterjson.rows.row[z].field[x].name == "templatetypename") {
                                   if (data.masterjson.rows.row[z].field[x].values.value == selectedText) {
                                       selectedrow = true;
                                   }
                               }

                               //For docker 
                               if (data.masterjson.rows.row[z].field[x].name == "dockercontainerpathstitle") {
                                   dockercontainerpathstitle = data.masterjson.rows.row[z].field[x].values.value;
                               }
                               if (data.masterjson.rows.row[z].field[x].name == "dockercontainerpaths") {
                                   dockercontainerpaths = data.masterjson.rows.row[z].field[x].values.value;
                               }
                               if (data.masterjson.rows.row[z].field[x].name == "dockerreponame") {
                                   dockerreponame = data.masterjson.rows.row[z].field[x].values.value;
                               }

                           }


                           if (selectedrow) {
                               getIndividualData += '<div class="col-sm-3 col-lg-2 col-md-3">' +
                                   '<div class="productdiv2" data-templateId="' + getTempName + '" data-' +
                                   'templateComponent="component' + z + '" ' +
                                   'dockercontainerpathstitle="' + dockercontainerpathstitle + '" ' +
                                   'dockercontainerpaths="' + dockercontainerpaths + '" ' +
                                   'dockerreponame="' + dockerreponame + '" ' +
                                   'data-templateName="' + getTempName + '" data-' +
                                   'templateType="' + getTemplateType + '" templatetype="' + getTemplateType + '" templatename="' + getTempName + '" templatescookbooks="' + gettemplatescookbooks + '">' +
                                   '<ul class="list-unstyled system-prop" style="text-align:center;">' +
                                   '<li><img style="height:40px;width:auto;" alt="" ' +
                                   'src="/d4dMasters/image/' + getRowID + '__templatesicon__' + getImage + '">' +
                                   '</li><li style="font-size:12px;"><u><b>' + getTempName + '</b></u></li>';
                               //If standard template
                               if (getTemplateType != "Docker") {
                                    var cb = $chefCookbookRoleSelector.getRunlistNames(gettemplatescookbooks.split(','));
                                   var licb = '';
                                   //alert(cb.length);
                                   for (var cbi = 0; cbi < cb.length; cbi++) {
                                       licb += '<li style="font-size:10px;" blueprinttype="other">' + cb[cbi] + '</li>';
                                   }
                               } else //when template type is docker
                               {
                                   var cb = dockercontainerpathstitle.split(',');
                                   var cbpath = dockercontainerpaths.split(',');
                                   var licb = '';
                                   //alert(cb.length);
                                   for (var cbi = 0; cbi < cb.length; cbi++) {
                                       licb += '<li style="font-size:10px;" path="' + cbpath[cbi] + '" title="Container" blueprinttype="dockercontainer">' + cb[cbi] + '</li>';
                                   }
                               }

                               getIndividualData += licb + '</ul></div></div>';

                           }
                       }
                       $("#individualTemplateNameGrid").html("");
                       //$("#individualTemplateNameGrid").append(getParent);
                       $("#individualTemplateNameGrid").append(getIndividualData).find('.productdiv2').first().click();
                       //$("#grid0").addClass("role-Selected");
                   }


               });
               //console.log('in here')
               //alert('here');
               // var $selectedItem = $('.role-Selected');
               // if (!$selectedItem.length) {
               //     alert('please choose a blueprint design')
               //     return false;
               // }
               // var $clone = $selectedItem.clone().removeClass('role-Selected');
               $('#tab' + (index + 1)).find('.temp').empty().append($clone);
               console.log('triggering');
               $('.' + $selectedItem.attr('data-templateType')).find('.productdiv2:first').trigger('click');

           } else if (index == 2) {
               //   var $selectedTemplateArea = $('.selectedTemplateArea')
               //   var $selectedItem = $selectedTemplateArea.find('.productdiv2');
               //   console.log($selectedItem.length);
               //   if(!$selectedItem.length) {
               //     alert('please choose a template');
               //     return false;

               // }
               //alert('kickin 2');

               //If a docker type of template selected then select the Org 
               var $selectedItem = $('.role-Selected');
               // alert('in ' + $selectedItem.length);
               if (!$selectedItem.length) {
                   alert('please choose a blueprint design');
                   return false;
               }

               $('#orgnameSelect').val($('li[class*="orgSelected"]').text().trim());
               console.log('role-Selected before ==> ',$('#tab2 .role-Selected').length);
               if ($('.productdiv2.role-Selected').length > 0) {
                   //Setting controls connected to docker to hidden
                   $('.fordocker').hide();

                   $('.divconfigureparameterrunlist').show();
                   $('.divchefrunlist').show();

                   if ($('.productdiv2.role-Selected').first().attr('templatetype') == "Docker") {
                      //Checking if docker then only Edit organization paramerters are to be shown
                        if(!$('#CollapseEditorgParam').hasClass('in')){
                          $('a[href="#CollapseEditorgParam"]').click();
                        }
                      $('.divconfigureparameterrunlist').hide();
                      $('.divchefrunlist').hide();
                       //When docker stepping to 4th tab

                       $('#orgnameSelect').trigger('change');
                       //$('a[href="#tab3"]').first().trigger('click');

                       //populating the docker repo titles
                       var $dockerrepotitles = $('.productdiv2.role-Selected').attr('dockercontainerpathstitle').split(',');
                       var $dockerrepopaths = $('.productdiv2.role-Selected').attr('dockercontainerpaths').split(',');
                       var $dockerreponame = $('.productdiv2.role-Selected').attr('dockerreponame');
                       var $dockerrepoListInput = $('#dockerrepoListInput');
                       $dockerrepoListInput.empty();

                       $dockerrepotitles.forEach(function(k, v) {
                           var $opt = $('<option value="' + $dockerrepotitles[v] + '" repopath="' + $dockerrepopaths[v] + '">' + $dockerrepotitles[v] + '</option>');
                           $dockerrepoListInput.append($opt);
                       });

                       //Setting the appropriate tags
                       //Attaching the change event to pull tags for the select repo
                       $dockerrepoListInput.change(function(e) {
                           //tutum/centos
                           console.log('Docker Query -> ', '/d4dmasters/getdockertags/' + encodeURIComponent($(this).find('option:selected').attr('repopath')) + '/' + $dockerreponame);
                           $.get('/d4dmasters/getdockertags/' + encodeURIComponent($(this).find('option:selected').attr('repopath')) + '/' + $dockerreponame, function(data) {
                               //Sample json given below
                               //[{"layer": "cddde0cd", "name": "latest"}, {"layer": "3baf8932", "name": "6.4"}, {"layer": "d1c0a07f", "name": "6.5"}, {"layer": "a9dd9e89", "name": "centos5"}, {"layer": "02398e09", "name": "centos6"}, {"layer": "4e5b3b2f", "name": "centos7"}]

                               if (data) {
                                   var tagJson = JSON.parse(data);
                                   var $dockerrepotagsdiv = $('#dockerrepotagsdiv');

                                   $dockerrepotagsdiv.empty();
                                   var dockerrepotags = [];
                                   tagJson.forEach(function(k, v) {
                                       //<p class="bg-success"><i style="padding-left:10px;padding-right:10px" class="ace-icon fa fa-check"></i>CentOS</p>
                                       if (v < 3) {
                                           $('#dockerrepotagsdiv').append('<div class="codelistitem" style="margin-top:2px;padding-top:2px;border:1px solid #eeeeee; background-color:#eeeeee !important;height:26px;"><p class="bg-success"><i style="padding-left:10px;padding-right:10px" class="ace-icon fa fa-check"></i>' + tagJson[v].name + '</p></div>');
                                           if (dockerrepotags == '')
                                               dockerrepotags += tagJson[v].name;
                                           else
                                               dockerrepotags += ',' + tagJson[v].name;
                                       }
                                       //limiting the number to the top 5
                                   });
                                   $('.productdiv2.role-Selected').first().attr('dockerrepotags', dockerrepotags);
                                   $('.productdiv2.role-Selected').first().attr('dockerreponame', $dockerrepoListInput.val());
                               }
                           });
                       });
                       //dockerrepotagsul
                       $dockerrepoListInput.trigger('change');

                       //End Setting appropriate tags
                       //polulate the docker tags
                       var $dockerrepotagsul = $('#dockerrepotagsul');
                       $('.fordocker').show();
                       //return (true);
                     } else {
                     
                        if(!$('#CollapseConfigureproviderParameter').hasClass('in')){
                          $('a[href="#CollapseConfigureproviderParameter"]').click();
                        }
                     }
                  }

               console.log('role-Selected after ==> ',$('#tab2 .role-Selected').length);
               
               var $clone = $selectedItem.clone().removeClass('role-Selected');
               var selectedText = $clone.attr("data-templateType");
               if ($selectedItem.attr('data-templateType') == 'desktopProvisoning') {
                   wizard.show(4);
                   return false;
               }
               if ($('#tab2 .role-Selected').length > 0) {
                   console.log('cloning');
                   $('#tab3 .selectedTemplateArea').empty().append($('#tab2 .role-Selected').clone());
               }
               //force clicking orgnameSelect
               $('#orgnameSelect').trigger('change');


           } else if (index == 3) {

               var $selectedTemplateArea = $('.selectedTemplateArea');
               var $selectedItem = $selectedTemplateArea.find('.productdiv2');
               console.log($selectedItem.length);
               if (!$selectedItem.length) {
                   alert('please choose a template');
                   return false;
               }

               if ($('#orgnameSelect').val() === 'choose') {
                   alert('please choose an Organization');
                   return false;
               }


               reqBody = {};
               reqBody.templateId = $selectedItem.attr('data-templateId');
               reqBody.templateType = $selectedItem.attr('data-templateType');
               reqBody.templateComponents = $selectedItem.attr('data-templateComponent').split(',');
               reqBody.dockercontainerpathstitle = $selectedItem.attr('dockercontainerpathstitle');
               reqBody.dockercontainerpaths = $selectedItem.attr('dockercontainerpaths');
               /*if(!$('.deploymentsCookbookList').length) {
                alert('Please wait while we are fetching cookbooks.');
                return false;
              }*/
               //Get all the runlist 
               var cbs = [];
               $('.deploymentSelectedRunList input').each(function() {
                   cbs.push($(this).val());
               });
               reqBody.runlist = cbs.join(); //$('#cookbookSelect').val();
               //reqBody.chefServerId = $('#cookbookSelect').data('chefServerId',);
               reqBody.chefServerId = $('.deploymentSelectedRunList').first().data('chefServerId');
               reqBody.instanceType = $('select.instanceType').val();
               reqBody.instanceOS = $('#instanceOS').val();
               console.log(reqBody);


               console.log("reqBody ==>", reqBody);
               if (!reqBody || reqBody == "undefined") {
                   console.log('resetting');
                   var reqBody = {};
               }
               //reqBody.runlist = $('#cookbookSelect').val();
               var cbs = [];
               $('.deploymentSelectedRunList input').each(function() {
                   cbs.push($(this).val());
               });
               reqBody.runlist = cbs; //$('#cookbookSelect').val();
               //reqBody.chefServerId = $('#cookbookSelect').data('chefServerId');
               reqBody.chefServerId = $('.deploymentSelectedRunList').first().data('chefServerId');
               console.log("instanceType ==>", $('select.instanceType').val());
               reqBody.instanceType = $('select.instanceType').val();
               reqBody.instanceOS = $('#instanceOS').val();
               reqBody.templateId = $('.productdiv2.role-Selected').attr('data-templateId');
               reqBody.templateType = $('.productdiv2.role-Selected').attr('data-templateType');
               reqBody.templateComponents = $('.productdiv2.role-Selected').attr('data-templateComponent').split(',');
               //    reqBody.dockercontainerpathstitle = $('.productdiv2.role-Selected').attr('dockercontainerpathstitle');
               reqBody.dockercontainerpaths = $('#dockerrepoListInput :selected').attr('repopath'); //$('.productdiv2.role-Selected').attr('dockercontainerpaths');
               reqBody.dockerrepotags = $('.productdiv2.role-Selected').attr('dockerrepotags');
               reqBody.dockerreponame = $('#dockerrepoListInput').val();


               reqBody.iconpath = $('.productdiv2.role-Selected').find('img[src*="__templatesicon__"]').first().attr('src');
               reqBody.orgId = $('#orgnameSelect').val();
               reqBody.projectId = $('#projectListInput').val();
               reqBody.envId = $('#envList').val();
               reqBody.name = $('#blueprintNameInput').val();
               //alert('in');
               if (!reqBody.name) {
                   alert("Please enter a blueprint name");
                   return false;
               }
               if (!reqBody.projectId || reqBody.projectId === 'choose') {
                   alert("Please choose a project");
                   return false;
               }

               if (!reqBody.envId || reqBody.envId === 'choose') {
                   alert("Please choose an environment");
                   return false;
               }
               reqBody.users = $('#userListSelect').val()

               if (!reqBody.users) {
                   alert("Please choose users");
                   return false;
               }
               //alert(JSON.stringify(reqBody));


               console.log('pushing');
               console.log(reqBody);
               $.post('../projects/' + reqBody.projectId + '/environments/' + reqBody.envId + '/blueprints', {
                   blueprintData: reqBody
               }, function(data) {
                   console.log(data);
               });
               console.log('final', reqBody);

           } 


           $('#bootstrap-wizard-1').find('.form-wizard').children('li').eq(index - 1).addClass(
               'complete');
           $('#bootstrap-wizard-1').find('.form-wizard').children('li').eq(index - 1).find('.step')
               .html('<i class="fa fa-check"></i>');
           //$('#tab'+(index)).removeClass('active');
           //$('#tab'+(index+1)).addClass('active');
           //return true;


       },
       'onPrevious': function(tab, navigation, index) {
           //console.log(index);
           $('#bootstrap-wizard-1').find('.form-wizard').children('li').eq(index + 1).removeClass(
               'complete');
           $('#bootstrap-wizard-1').find('.form-wizard').children('li').eq(index + 1).find('.step')
               .html(index + 2);

       }
   });


   var $rolesCards = $('.blueprintdiv')

    $('.blueprintdiv').on("click", function() {
       //alert("Inside");
       $rolesCards.removeClass('role-Selected');
       if ($(this).hasClass('role-Selected')) {
           $(this).removeClass('role-Selected');
       } else {
           $(this).addClass('role-Selected');
       }
       // $('.templates').hide();
       // console.log($(this).attr('data-templateType'));
       // $('.'+$(this).attr('data-templateType')).show();
       //$('.next a').attr('disabled',false);
   });

   var $selectedTemplate = $('.productdiv2').click(function(e) {
       $selectedTemplate.removeClass('role-Selected');
       console.log("this ==> ",this); 
       var $this = $(this);
       $('.selectedTemplateArea').empty().append($this.clone(false).css({
           'cursor': 'auto'
       }));

       $this.addClass('role-Selected');
   });

   $.ajax({
       type: "get",
       dataType: "json",

       async: false,
       url: "../organizations/getTree",
       success: function(data) {
           var $orgListInput = $('#orgnameSelect');
           $orgListInput.append($('<option></option>').val('choose').html('Choose'));
           $bgList = $('#bgListInput');
           var $envList = $('#envList');
           for (var i = 0; i < data.length; i++) {
               $orgListInput.append($('<option></option>').val(data[i].name).html(data[i].name).data('bglist', data[i].businessGroups).data('envList', data[i].environments));
           }
           $orgListInput.change(function(e) {
               // alert('trigged org selection');
               var orgName = $(this).val();
               if (orgName == 'choose') {
                   return;
               }
               var $selectedOrgOption = $(this).find(":selected");
               $bgList.empty();
               $bgList.append($('<option></option>').val('choose').html('Choose'));
               var getBGs = $selectedOrgOption.data('bglist');
               for (var i = 0; i < getBGs.length; i++) {
                   $bgList.append($('<option></option>').val(getBGs[i].name).html(getBGs[i].name).data('projList', getBGs[i].projects));
               }

               $envList.empty();
               var getEnv = $selectedOrgOption.data('envList');
               for (var i = 0; i < getEnv.length; i++) {
                   $envList.append($('<option></option>').val(getEnv[i]).html(getEnv[i]));
               }

               var $cookbookShow = $('.cookbookShow').empty();
               $cookbookShow.append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />');

               var $ccrs = $chefCookbookRoleSelector(orgName, function(data) {
                   //To do additional selections
                   //alert('finished adding');
                   var tcb = $('#tab3').find('div[class*="productdiv2"]').first().attr('templatescookbooks').split(',');
                   for (var key in tcb) {
                       //alert(tcb[key]);
                       //   var $optiontcb =  $('<option selected></option>').append(tcb[key]).val(tcb[key]);

                       // $cookbooksList.append($optiontcb);
                       //  checkarray.push(tcb[key]);
                       if (tcb[key].indexOf('recipe') >= 0)
                           $('.deploymentsCookbookList li input[value="' + tcb[key] + '"]').first().trigger('click');
                       else
                           $('.deploymentRoleList li input[value="' + tcb[key] + '"]').first().trigger('click');

                   }
                   $('.btnItemAdd').first().trigger('click');
                   //alert('finished clicking');
               });
               $cookbookShow.empty();
               $cookbookShow.append($ccrs);



           });

           var $projectList = $('#projectListInput');
           $bgList.change(function(e) {
               var bgName = $(this).val();
               if (bgName == 'choose') {
                   return;
               }
               var $selectedOrgOption = $(this).find(":selected");
               $projectList.empty();
               $projectList.append($('<option></option>').val('choose').html('Choose'));
               var getProjs = $selectedOrgOption.data('projList');
               for (var i = 0; i < getProjs.length; i++) {
                   $projectList.append($('<option></option>').val(getProjs[i]).html(getProjs[i]));
               }
           });

       }
   });


   (function() {

       var $loadingContainer = $('.userListLoadingContainer').empty().append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />').show();
       $.get('../users', function(userList) {
           var $userListSelect = $('#userListSelect').empty();
           userList.sort(function(a, b) {
               var keyA = Object.keys(a);
               var keyB = Object.keys(b);

               if (keyA[0] < keyB[0]) return -1;
               if (keyA[0] > keyB[0]) return 1;
               return 0;
           });
           for (var i = 0; i < userList.length; i++) {
               var keys = Object.keys(userList[i]);
               var $option = $('<option></option>').append(keys[0]).val(keys[0]);
               $userListSelect.append($option);
           }
           $loadingContainer.hide();
           $userListSelect.show();
       }).error(function() {
           $loadingContainer.empty().append('Unable to load users. Please try again later.');
       });
   })();


</script>

