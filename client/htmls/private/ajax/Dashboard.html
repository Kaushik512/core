<link rel="stylesheet" type="text/css" media="screen" href="css/Dashboard.css">
<div class="row">
  <div class="col-lg-6 col-md-6">
    <label for="">Choose AWS Providers:<span style="color:red">*</span>
        <span>
            <img class="awsproviderspinner" src="img/select2-spinner.gif" style="display:none"></img>
        </span>
    </label>
    <div class="input-groups">
        <select id="chooseAwsProviderID" name="" class="required width-100 form-control">
           
        </select>
    </div>
  </div>
</div>
<div class="row">
  <section class="content">
    <div class="row">
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3 class="total-instances">&nbsp;</h3>
            <p>Total <br>No. of Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-laptop"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-teal">
          <div class="inner">
            <h3 class="managed-instances">&nbsp;</h3>
            <p>Total <br>No. of Managed Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-cube"></i>
          </div>
          <a class="small-box-footer" href="#">
            More Info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-purple">
          <div class="inner">
            <h3>30%</h3>
            <p>Total <br>Average Usages/Utilizations</p>
          </div>
          <div class="icon">
            <i class="fa fa-pie-chart"></i>
          </div>
          <a class="small-box-footer" href="#">
            Usages More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-yellow">
          <div class="inner">
            <h3>$300</h3>
            <p>Total <br>Spend in Current month</p>
          </div>
          <div class="icon">
            <i class="fa fa-dollar"></i>
          </div>
          <a class="small-box-footer" href="#">
           Spend More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      
      <!-- <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-orange">
          <div class="inner">
            <h3 class="unmanaged-instances">&nbsp;</h3>
            <p>Total <br>No. of Unmanaged Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-cubes"></i>
          </div>
          <a class="small-box-footer" href="#">
            More Info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-maroon">
          <div class="inner">
            <h3 class="total-providers">&nbsp;</h3>
            <p>Total <br>No. of Providers</p>
          </div>
          <div class="icon">
            <i class="fa fa-sitemap"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div> -->
      <!-- <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-teal">
          <div class="inner">
            <h3 class="ec2-active-instances">&nbsp;</h3>
            <p>EC2 <br>Active Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-cube"></i>
          </div>
          <a class="small-box-footer" href="#">
            AWS More Info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div> -->
    </div><!-- /.row -->
    <!-- =========================================================== -->
    <div class="row">
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3>72</h3>
            <p>Total <br>No. of VMWare Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-desktop"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            VMWare More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3 class="ec2-total-instances">&nbsp;</h3>
            <p>Total <br>No. of AWS Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-cubes"></i>
          </div>
          <a class="small-box-footer" href="#">
            AWS More Info<i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3>54</h3>
            <p>Total <br>No. of Azure Instances </p>
          </div>
          <div class="icon">
            <i class="fa fa-tablet"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            Azure More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3>54</h3>
            <p>Total <br>No. of Openstack Instances </p>
          </div>
          <div class="icon">
            <i class="fa fa-tablet"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            Openstack More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      
    </div>

    <!-- =========================================================== -->
    <div class="row">
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-yellow">
          <div class="inner">
            <h3>$300</h3>
            <p>Total <br>Spend in Current month</p>
          </div>
          <div class="icon">
            <i class="fa fa-dollar"></i>
          </div>
          <a class="small-box-footer" href="#">
           Spend More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-purple">
          <div class="inner">
            <h3>30%</h3>
            <p>Total <br>Average Usages</p>
          </div>
          <div class="icon">
            <i class="fa fa-pie-chart"></i>
          </div>
          <a class="small-box-footer" href="#">
            Usages More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-red">
          <div class="inner">
            <h3>50%</h3>
            <p>New vs Terminated<br>Instances Daily Trends</p>
          </div>
          <div class="icon">
            <i class="fa fa-shield"></i>
          </div>
          <a class="small-box-footer" href="#">
            More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-blue">
          <div class="inner">
            <h3>50%</h3>
            <p>Total<br>No. of Alerts</p>
          </div>
          <div class="icon">
            <i class="fa fa-shield"></i>
          </div>
          <a class="small-box-footer" href="#">
            Alerts More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      
    </div>
    <div class="row">
	    <div class="col-lg-3 col-xs-6">
	        <div class="small-box bg-green">
	          <div class="inner">
	            <h3>30
	            </h3>
	            <p>Total<br>No. of Builds</p>
	          </div>
	          <div class="icon">
	            <i class="fa fa-location-arrow"></i>
	          </div>
	          <a class="small-box-footer" href="#">
	            Builds More Info <i class="fa fa-arrow-circle-right"></i>
	          </a>
	        </div>
	      </div>
	      <div class="col-lg-3 col-xs-6">
	        <div class="small-box bg-green">
	          <div class="inner">
	            <h3>14</h3>
	            <p>Total<br>No. of Builds Passed</p>
	          </div>
	          <div class="icon">
	            <i class="fa fa-location-arrow"></i>
	          </div>
	          <a class="small-box-footer" href="#">
	            Builds More Info <i class="fa fa-arrow-circle-right"></i>
	          </a>
	        </div>
	      </div>
	      <div class="col-lg-3 col-xs-6">
	        <div class="small-box bg-green">
	          <div class="inner">
	            <h3>12</h3>
	            <p>Total<br>No. of Builds Deployed</p>
	          </div>
	          <div class="icon">
	            <i class="fa fa-location-arrow"></i>
	          </div>
	          <a class="small-box-footer" href="#">
	            Builds More Info <i class="fa fa-arrow-circle-right"></i>
	          </a>
	        </div>
	      </div>
	      <div class="col-lg-3 col-xs-6">
	        <div class="small-box bg-fuchsia">
	          <div class="inner">
	            <h3>98%</h3>
	            <p>Total<br>Uptime</p>
	          </div>
	          <div class="icon">
	            <i class="fa fa-location-arrow"></i>
	          </div>
	          <a class="small-box-footer" href="#">
	            Builds More Info <i class="fa fa-arrow-circle-right"></i>
	          </a>
	        </div>
	      </div>

    </div>
  </section>
</div>
<script type="text/javascript">
	/*$(document).ready(function() {
    $.get('../allproviders/list', function(dataforallproviders) {


    }).fail(function() {});  
  
  });*/
</script>
<script type="text/javascript">
  $(document).ready(function() {
    //$('#chooseAwsProviderID').select2();
    $.get('../allproviders/list', function(dataforallproviders) {
      //console.log(dataforallproviders.awsProviders);
      var $chooseAwsProviderID = $('#chooseAwsProviderID');
      for(var i=0; i< dataforallproviders.awsProviders.length; i++){
        //alert(dataforallproviders.awsProviders[i].providerName);
        $chooseAwsProviderID.empty();
        $chooseAwsProviderID.append('<option value="">Choose Server</option>');
        $chooseAwsProviderID.append('<option data-providerName = "'+dataforallproviders.awsProviders[i].providerName+'" value='+dataforallproviders.awsProviders[i].providerName+'>'+dataforallproviders.awsProviders[i].providerName+'</option>');
      }

      $chooseAwsProviderID.change(function(e) {
          if ($('#chooseAwsProviderID :selected').text() == 'Choose Server') {
              $('.content').hide();
          } else {
            $('.content').show();
            for(var i=0; i< dataforallproviders.awsProviders.length; i++){
              if($('#chooseAwsProviderID :selected').text() == dataforallproviders.awsProviders[i].providerName){
                var accessKey = dataforallproviders.awsProviders[i].accessKey;
                var secretKey = dataforallproviders.awsProviders[i].secretKey;
                var regions = ["us-east-1", "us-west-1", "us-west-2"];
                var count1 = 0;
                var count2 = 0;
                var totalcount = 0;
                var totalactivecount = 0;
                for (var i = 0; i < regions.length; i++) {

                  //For Total Count
                  $.post('../aws/providers/node/list', {
                      // "accessKey": "AKIAI3ETOOEFHJ62G2NQ",
                      // "secretKey": "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",
                      "accessKey": accessKey,
                      "secretKey": secretKey,
                      "region": regions[i]
                  }, function(instancesCount) {
                      totalcount = totalcount + instancesCount.length;
                      count1++;
                      if (count1 === regions.length) {
                          //alert('last');
                          //alert(totalcount);
                          $('.ec2-total-instances').empty();
                          $('.ec2-total-instances').append(totalcount);
                      }
                  }).fail(function(jxhr) {
                      alert("Server behaves unexpectedly");
                  });

                  //For Active Instances Count
                  $.post('../aws/providers/activenode/list', {
                      "accessKey": "AKIAI3ETOOEFHJ62G2NQ",
                      "secretKey": "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",
                      "region": regions[i]
                  }, function(instancesActiveCount) {
                      totalactivecount = totalactivecount + instancesActiveCount.length;
                      count2++;
                      if (count2 === regions.length) {
                          //alert('last');
                          //alert(totalactivecount);
                          $('.ec2-active-instances').empty();
                          $('.ec2-active-instances').append(totalactivecount);
                      }
                  }).fail(function(jxhr) {
                      alert("Server behaves unexpectedly");
                  });
                }
              }
            }
          }
      });


    }).fail(function() {});  
  
  });
</script>
