<link rel="stylesheet" type="text/css" media="screen" href="css/Dashboard.css">
<a href="#modaldashboardConfigure" data-toggle="modal" class="createAppConfigure">
    <i class="fa fa-th fa-cogs" style="margin-right: 5px; color: rgb(64, 186, 241); font-size: 18px;"></i>
</a>
<div class="modal fade" id="modaldashboardConfigure" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
  <div class="modal-dialog">
      <div class="modal-content">
        <form role="form" id="appCardForm" autocomplete="off">
          <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                  X
              </button>
              <h4 class="modal-title">
                  <i class="fa fa-th-list txt-color-blue"></i>&nbsp;&nbsp;Save data for Dashboard
              </h4>
          </div>
          <div class="modal-body">
            <form id="formdashboardapplication">
              <div class="">
                <div style="margin:5px 0px 0px;" class="row">
                    <div style="padding-left:0px;" class="col-lg-6">
                        <label for="name">Managed Instances:<span style="color:red">*</span>
                        </label>
                        <input type="text" autofocus="" style="height:36px;" class="form-control" id="managedinstancesInput">
                    </div>
                    <div style="padding-left:0px;" class="col-lg-6">
                        <label for="name">Average Usages:
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="averageUsagesInput">
                    </div>

                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total Builds:<span style="color:red">*</span>
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="totalbuildsInput">
                    </div>
                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total Builds Passed:
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="totalpassedbuildsInput">
                    </div>

                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total Builds Deployed:<span style="color:red">*</span>
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="totaldeployedbuildsInput">
                    </div>
                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total Uptime:
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="totaluptimeInput">
                    </div>

                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total Vmware Instances:<span style="color:red">*</span>
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="vmwareinstancesInput">
                    </div>
                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total AWS Instances:
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="awsinstancesInput">
                    </div>

                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total Azure Instances:<span style="color:red">*</span>
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="azureinstancesInput">
                    </div>
                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total Openstack Instances:
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="openstackinstancesInput">
                    </div>

                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total Instances Daily Trends:<span style="color:red">*</span>
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="dailytrendsInput">
                    </div>
                    <div style="padding-left:0px;margin-top:10px" class="col-lg-6">
                        <label for="name">Total No of Alerts:
                        </label>
                        <input type="text" style="height:36px;" class="form-control" id="alertsInput">
                    </div>


                </div>
            </div>
            </form>
          </div>
           <div class="modal-footer">
              <div class="btn-group" style="margin-left:200px;">  
              <a class="btn btn-default" data-dismiss="modal">
                  <i class="ace-icon fa fa-times bigger-110"></i>
                  Cancel
              </a>                               
               <a class="btn btn-primary dashboardSaveBtn" style="margin-left:10px;">
                  <i class="ace-icon fa fa-save bigger-110"></i>
                  Save
              </a>
              </div>
            </div>
           </form>
      </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div>
<!-- <div class="row">
  <div class="col-lg-6 col-md-6">
    <label for="">Choose AWS Providers:<span style="color:red">*</span>
        <span>
            <img class="awsproviderspinner" src="img/select2-spinner.gif" style="display:none"></img>
        </span>
    </label>
    <div class="input-groups">
        <select id="chooseAwsProviderID" name="" class="required width-100 form-control">
           
        </select>
    </div>
  </div>
</div> -->
<div class="row">
  <section class="content">
    <div class="row">
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3 id="totalInstances">&nbsp;</h3>
            <p>Total <br>No. of Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-laptop"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-teal">
          <div class="inner">
            <h3 id="managedInstances">&nbsp;</h3>
            <p>Total <br>No. of Managed Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-cube"></i>
          </div>
          <a class="small-box-footer" href="#">
            More Info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-yellow">
          <div class="inner">
            <h3 id="totalCosts">&nbsp;</h3>
            <p>Total <br>Spend in Today</p>
          </div>
          <div class="icon">
            <i class="fa fa-dollar"></i>
          </div>
          <a class="small-box-footer" href="#">
           Spend More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>

      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-purple">
          <div class="inner">
            <h3 id="totalUsages">&nbsp;</h3>
            <p>Total <br>Average Usages/Utilizations</p>
          </div>
          <div class="icon">
            <i class="fa fa-pie-chart"></i>
          </div>
          <a class="small-box-footer" href="#">
            Usages More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      
      <!-- <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-orange">
          <div class="inner">
            <h3 class="unmanaged-instances">&nbsp;</h3>
            <p>Total <br>No. of Unmanaged Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-cubes"></i>
          </div>
          <a class="small-box-footer" href="#">
            More Info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-maroon">
          <div class="inner">
            <h3 class="total-providers">&nbsp;</h3>
            <p>Total <br>No. of Providers</p>
          </div>
          <div class="icon">
            <i class="fa fa-sitemap"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div> -->
      <!-- <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-teal">
          <div class="inner">
            <h3 class="ec2-active-instances">&nbsp;</h3>
            <p>EC2 <br>Active Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-cube"></i>
          </div>
          <a class="small-box-footer" href="#">
            AWS More Info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div> -->
    </div><!-- /.row -->
    <!-- =========================================================== -->

    <div class="row">
      <div class="col-lg-3 col-xs-6">
          <div class="small-box bg-green">
            <div class="inner">
              <h3 id="totalBuilds">&nbsp;</h3>
              <p>Total<br>No. of Builds</p>
            </div>
            <div class="icon">
              <i class="fa fa-location-arrow"></i>
            </div>
            <a class="small-box-footer" href="#">
              Builds More Info <i class="fa fa-arrow-circle-right"></i>
            </a>
          </div>
        </div>
        <div class="col-lg-3 col-xs-6">
          <div class="small-box bg-green">
            <div class="inner">
              <h3 id="totalbuildsPassed">&nbsp;</h3>
              <p>Total<br>No. of Builds Passed</p>
            </div>
            <div class="icon">
              <i class="fa fa-map-o"></i>
            </div>
            <a class="small-box-footer" href="#">
              Builds More Info <i class="fa fa-arrow-circle-right"></i>
            </a>
          </div>
        </div>
        <div class="col-lg-3 col-xs-6">
          <div class="small-box bg-green">
            <div class="inner">
              <h3 id="totalbuildsDeployed">&nbsp;</h3>
              <p>Total<br>No. of Builds Deployed</p>
            </div>
            <div class="icon">
              <i class="fa fa-ship"></i>
            </div>
            <a class="small-box-footer" href="#">
              Builds More Info <i class="fa fa-arrow-circle-right"></i>
            </a>
          </div>
        </div>
        <div class="col-lg-3 col-xs-6">
          <div class="small-box bg-fuchsia">
            <div class="inner">
              <h3 id="totalUptime">&nbsp;</h3>
              <p>Total<br>Uptime</p>
            </div>
            <div class="icon">
              <i class="fa fa-line-chart"></i>
            </div>
            <a class="small-box-footer" href="#">
              Uptime More Info <i class="fa fa-arrow-circle-right"></i>
            </a>
          </div>
        </div>
    </div>

    <!-- =========================================================== -->
    <div class="row">
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3 id="totalvmwareInstances">&nbsp;</h3>
            <p>Total <br>No. of VMWare Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-desktop"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            VMWare More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3 id="totalawsInstances">&nbsp;</h3>
            <p>Total <br>No. of AWS Instances</p>
          </div>
          <div class="icon">
            <i class="fa fa-cubes"></i>
          </div>
          <a class="small-box-footer" href="#">
            AWS More Info<i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3 id="totalazureInstances">&nbsp;</h3>
            <p>Total <br>No. of Azure Instances </p>
          </div>
          <div class="icon">
            <i class="fa fa-tablet"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            Azure More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3 id="totalopenstackInstances">&nbsp;</h3>
            <p>Total <br>No. of Openstack Instances </p>
          </div>
          <div class="icon">
            <i class="fa fa-futbol-o"></i>
          </div>
          <a class="small-box-footer" href="index.html">
            Openstack More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      
    </div>

    <!-- =========================================================== -->
    <div class="row">
      
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-red">
          <div class="inner">
            <h3 id="totaldailyTrends"></h3>
            <p>New vs Terminated<br>Instances Daily Trends</p>
          </div>
          <div class="icon">
            <i class="fa fa-shield"></i>
          </div>
          <a class="small-box-footer" href="#">
            More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-blue">
          <div class="inner">
            <h3 id="totalAlerts"></h3>
            <p>Total<br>No. of Alerts</p>
          </div>
          <div class="icon">
            <i class="fa fa-tags"></i>
          </div>
          <a class="small-box-footer" href="#">
            Alerts More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-fuchsia">
          <div class="inner">
            <h3>&nbsp;</h3>
            <p><br>&nbsp;</p>
          </div>
          <div class="icon">
            <i class="fa fa-certificate"></i>
          </div>
          <a class="small-box-footer" href="#">
          More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-green">
          <div class="inner">
            <h3>&nbsp;</h3>
            <p><br>&nbsp;</p>
          </div>
          <div class="icon">
            <i class="fa fa-bullseye"></i>
          </div>
          <a class="small-box-footer" href="#">
            More info <i class="fa fa-arrow-circle-right"></i>
          </a>
        </div>
      </div>
      
    </div>
    
  </section>
</div>
<script type="text/javascript">
	/*$(document).ready(function() {
    $.get('../allproviders/list', function(dataforallproviders) {


    }).fail(function() {});  
  
  });*/
</script>
<script type="text/javascript">
  $(document).ready(function() {
    
    //Total Instances API
    $.get('../dashboard/providers/totalinstances', function(totalinstances) {
      $('#totalInstances').empty();
      $('#totalInstances').append(totalinstances[0].totalinstancecount);
    }).fail(function() {});

    //Total Costs API
    $.get('../dashboard/providers/totalcosts', function(totalcosts) {
      $('#totalCosts').empty();
      var totalcostcount = '$'+totalcosts[0].totalcostcount;
      $('#totalCosts').append(totalcostcount);
    }).fail(function() {});



    //Total managedinstances API
    $.get('../dashboard/providers/totalmanagedinstances', function(totalmanagedinstances) {
      $('#managedInstances').empty();
      var totalmanagedinstancesCount = totalmanagedinstances[0].totalmanagedinstancescount;
      $('#managedInstances').append(totalmanagedinstancesCount);
    }).fail(function() {});


    //Total Usages API
    $.get('../dashboard/providers/totalusages', function(totalusages) {
      $('#totalUsages').empty();
      var totalusagesCount = totalusages[0].totalusagecount+'%';
      $('#totalUsages').append(totalusagesCount);
    }).fail(function() {});

    //Total Builds API
    $.get('../dashboard/providers/totalbuilds', function(totalbuilds) {
      $('#totalBuilds').empty();
      var totalbuildsCount = totalbuilds[0].totaltotalbuildcount;
      $('#totalBuilds').append(totalbuildsCount);
    }).fail(function() {});

    
    //Total totalbuildspassed API
    $.get('../dashboard/providers/totalbuildspassed', function(totalbuildspassed) {
      $('#totalbuildsPassed').empty();
      var totalbuildspassedCount = totalbuildspassed[0].totalpassedbuildcount;
      $('#totalbuildsPassed').append(totalbuildspassedCount);
    }).fail(function() {});

    //Total totalbuildspassed API
    $.get('../dashboard/providers/totalbuildsdeployed', function(totalbuildsdeployed) {
      $('#totalbuildsDeployed').empty();
      var totalbuildsdeployedCount = totalbuildsdeployed[0].totaldeployedbuildcount;
      $('#totalbuildsDeployed').append(totalbuildsdeployedCount);
    }).fail(function() {});

    //Total uptime API
    $.get('../dashboard/providers/totaluptime', function(totaluptime) {
      $('#totalUptime').empty();
      var totaluptimeCount = totaluptime[0].totaluptimecount+'%';
      $('#totalUptime').append(totaluptimeCount);
    }).fail(function() {});

    //Total vmwareinstances API
    $.get('../dashboard/providers/totalvmwareinstances', function(totalvmwareinstances) {
      $('#totalvmwareInstances').empty();
      var totalvmwareinstancesCount = totalvmwareinstances[0].totalvmwareinstancescount;
      $('#totalvmwareInstances').append(totalvmwareinstancesCount);
    }).fail(function() {});

    //Total awsinstances API
    $.get('../dashboard/providers/totalawsinstances', function(totalawsinstances) {
      $('#totalawsInstances').empty();
      var totalawsinstancesCount = totalawsinstances[0].totalawsinstancescount;
      $('#totalawsInstances').append(totalawsinstancesCount);
    }).fail(function() {});

    //Total azureinstances API
    $.get('../dashboard/providers/totalazureinstances', function(totalazureinstances) {
      $('#totalazureInstances').empty();
      var totalazureinstancesCount = totalazureinstances[0].totalazureinstancescount;
      $('#totalazureInstances').append(totalazureinstancesCount);
    }).fail(function() {});


    //Total awsinstances API
    $.get('../dashboard/providers/totalopenstackinstances', function(totalopenstackinstances) {
      $('#totalopenstackInstances').empty();
      var totalopenstackinstancesCount = totalopenstackinstances[0].totalopenstackinstancescount;
      $('#totalopenstackInstances').append(totalopenstackinstancesCount);
    }).fail(function() {});

    //Total totaldailyTrends API
    $.get('../dashboard/providers/totaldailytrends', function(totaldailyTrends) {
      $('#totaldailyTrends').empty();
      var totaldailyTrendsCount = totaldailyTrends[0].totaldailytrendcount+'%';
      $('#totaldailyTrends').append(totaldailyTrendsCount);
    }).fail(function() {});

    //Total totalAlerts API
    $.get('../dashboard/providers/totalalerts', function(totalAlerts) {
      $('#totalAlerts').empty();
      var totalAlertsCount = totalAlerts[0].totalalertcount;
      $('#totalAlerts').append(totalAlertsCount);
    }).fail(function() {});


    function dashboardEntry(){
      var dataDashboard = {};
      var managedinstancesInput = $('#managedinstancesInput').val();
      var averageUsagesInput = $('#averageUsagesInput').val();

      var totalbuildsInput = $('#totalbuildsInput').val();
      var totalpassedbuildsInput = $('#totalpassedbuildsInput').val();

      var totaldeployedbuildsInput = $('#totaldeployedbuildsInput').val();
      var totaluptimeInput = $('#totaluptimeInput').val();

      var vmwareinstancesInput = $('#vmwareinstancesInput').val();
      var awsinstancesInput = $('#awsinstancesInput').val();

      var azureinstancesInput = $('#azureinstancesInput').val();
      var openstackinstancesInput = $('#openstackinstancesInput').val();

      var dailytrendsInput = $('#dailytrendsInput').val();
      var alertsInput = $('#alertsInput').val();


      dataDashboard.managedinstancesCount = managedinstancesInput;
      dataDashboard.averageUsagesCount = averageUsagesInput;

      dataDashboard.totalbuildsCount = totalbuildsInput;
      dataDashboard.totalpassedbuildsCount = totalpassedbuildsInput;

      dataDashboard.totaldeployedbuildsCount = totaldeployedbuildsInput;
      dataDashboard.totaluptimeCount = totaluptimeInput;

      dataDashboard.vmwareinstancesCount = vmwareinstancesInput;
      dataDashboard.awsinstancesCount = awsinstancesInput;

      dataDashboard.azureinstancesCount = azureinstancesInput;
      dataDashboard.openstackinstancesCount = openstackinstancesInput;

      dataDashboard.dailytrendsCount = dailytrendsInput;
      dataDashboard.alertsCount = alertsInput;

      alert(JSON.stringify(dataDashboard));
      $.ajax({
        url: '/dashboard/providers/dashboardmongopush',
        data: JSON.stringify(dataDashboard),
        type: 'POST',
        contentType: "application/json",
        success: function(dashboardmongo) {
          console.log("dashboardmongo ########"+dashboardmongo);
        },
        error: function(jqxhr) {
          console.log("Error occured in dashboardmongopush");
        }
      });
    }
    $('.dashboardSaveBtn').on("click", function() {
      dashboardEntry();
    });


    //$('#chooseAwsProviderID').select2();
    /*$.get('../allproviders/list', function(dataforallproviders) {
      //console.log(dataforallproviders.awsProviders);
      var $chooseAwsProviderID = $('#chooseAwsProviderID');
      for(var i=0; i< dataforallproviders.awsProviders.length; i++){
        //alert(dataforallproviders.awsProviders[i].providerName);
        $chooseAwsProviderID.empty();
        $chooseAwsProviderID.append('<option value="">Choose Server</option>');
        $chooseAwsProviderID.append('<option data-providerName = "'+dataforallproviders.awsProviders[i].providerName+'" value='+dataforallproviders.awsProviders[i].providerName+'>'+dataforallproviders.awsProviders[i].providerName+'</option>');
      }

      $chooseAwsProviderID.change(function(e) {
          if ($('#chooseAwsProviderID :selected').text() == 'Choose Server') {
              $('.content').hide();
          } else {
            $('.content').show();
            for(var i=0; i< dataforallproviders.awsProviders.length; i++){
              if($('#chooseAwsProviderID :selected').text() == dataforallproviders.awsProviders[i].providerName){
                var accessKey = dataforallproviders.awsProviders[i].accessKey;
                var secretKey = dataforallproviders.awsProviders[i].secretKey;
                var regions = ["us-east-1", "us-west-1", "us-west-2"];
                var count1 = 0;
                var count2 = 0;
                var totalcount = 0;
                var totalactivecount = 0;
                for (var i = 0; i < regions.length; i++) {

                  //For Total Count
                  $.post('../aws/providers/node/list', {
                      // "accessKey": "AKIAI3ETOOEFHJ62G2NQ",
                      // "secretKey": "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",
                      "accessKey": accessKey,
                      "secretKey": secretKey,
                      "region": regions[i]
                  }, function(instancesCount) {
                      totalcount = totalcount + instancesCount.length;
                      count1++;
                      if (count1 === regions.length) {
                          //alert('last');
                          //alert(totalcount);
                          $('.ec2-total-instances').empty();
                          $('.ec2-total-instances').append(totalcount);
                      }
                  }).fail(function(jxhr) {
                      alert("Server behaves unexpectedly");
                  });

                  //For Active Instances Count
                  $.post('../aws/providers/activenode/list', {
                      "accessKey": "AKIAI3ETOOEFHJ62G2NQ",
                      "secretKey": "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",
                      "region": regions[i]
                  }, function(instancesActiveCount) {
                      totalactivecount = totalactivecount + instancesActiveCount.length;
                      count2++;
                      if (count2 === regions.length) {
                          //alert('last');
                          //alert(totalactivecount);
                          $('.ec2-active-instances').empty();
                          $('.ec2-active-instances').append(totalactivecount);
                      }
                  }).fail(function(jxhr) {
                      alert("Server behaves unexpectedly");
                  });
                }
              }
            }
          }
      });
    }).fail(function() {});  */
  
  });
</script>
