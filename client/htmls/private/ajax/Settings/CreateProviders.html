<script>
  // $(".tree-view").hide();

</script>
<style type="text/css">
 #createProvider .marginbottom{
  margin-bottom: 10px;
}
#createProvider .width-60{
  width:60%;
}
#createProvider .width-20{
  width:20%;
}
</style>
<div class="row" id="createProvider">
 <div class="col-md-12">
  <div class="col-md-12">
   <form action="" id="myForm54">
    <div class="widget-box">
     <div class="widget-header">
      <h4 class="widget-margin" style="color:black;">Add New Provider<span id="spnprovider"></span></h4>
    </div>
    <div class="widget-body">
      <div class="widget-main" style="min-height:300px">
       <div>
        <section id="widget-grid" class="">
         <!-- START ROW -->
         <div class="row">
          <!-- NEW COL START -->
          <article class="col-sm-12 col-md-12 col-lg-12">
           <!-- Widget ID (each widget will need unique ID)-->
           <div class="jarviswidget" id="wid-id-3" data-widget-editbutton="false" data-widget-custombutton="false">
            <!-- widget div-->
            <div>
             <!-- widget content -->
             <div class="row">                                                        
              <div class="col-lg-6">
               <label for="">Name:<span style="color:Red;" class="control-label">&nbsp;*</span></label>
               <!-- <i class="icon-append fa fa-building"></i> -->
               <input name="ctl00$MainContent$orgname" value="Default" id="providername" class="form-control" type="text"  cdata="catalyst" cat-validation="required,max15">
               <span data-val-controltovalidate="domainname" id="MainContent_Req_domainname" data-val="true" data-val-evaluationfunction="RequiredFieldValidatorEvaluateIsValid" data-val-initialvalue="" style="visibility:hidden;">Required</span>
             </div>                                                         


             <div class="col-lg-6">
              <label for="name">Provider Type:<span style="color:Red;" class="control-label">&nbsp;*</span></label>
              <select id="providertype" unique="true" uniqueconditionedby="orgname"  class="chooseOrganization width-100" sourcepath="1" datapath="masterjson.rows.row" valuelinkfield="costcode" style="vertical-align:central"  cdata="catalyst"  cat-validation="required">
               <option value="">Select Provider</option>
               <option value="aws">AWS</option>
             </select>
             <span data-val-controltovalidate="domainname" id="MainContent_Req_domainname" data-val="true" data-val-evaluationfunction="RequiredFieldValidatorEvaluateIsValid" data-val-initialvalue="" style="visibility:hidden;">Required</span>
           </div>   

         </div>

         <div class="row">
          
        <!-- -->
        <div class="col-lg-6">
         <label for="">Access Key:<span style="color:Red;" class="control-label">&nbsp;*</span></label>
         <!-- <i class="icon-append fa fa-building"></i> -->
         <input name="ctl00$MainContent$orgname" value="AKIAI6TVFFD23LMBJUPA" id="accesskey" class="form-control" type="text"  cdata="catalyst" cat-validation="required">

         <span data-val-controltovalidate="orgname" id="MainContent_Req_orgname" data-val="true" data-val-evaluationfunction="RequiredFieldValidatorEvaluateIsValid" data-val-initialvalue="" style="visibility:hidden;">Required</span>
       </div>
       <div class="col-lg-6">
         <label for="">Secret Key:<span style="color:Red;" class="control-label">&nbsp;*</span></label>
         <!-- <i class="icon-append fa fa-building"></i> -->
         <input name="ctl00$MainContent$orgname" value="qZOZuI2Ys0/Nc7txsc0V2eMMVnsEK6+Qa03Vqiyw" id="secretkey" class="form-control" type="text"  cdata="catalyst" cat-validation="required">

         <span data-val-controltovalidate="orgname" id="MainContent_Req_orgname" data-val="true" data-val-evaluationfunction="RequiredFieldValidatorEvaluateIsValid" data-val-initialvalue="" style="visibility:hidden;">Required</span>
       </div>

     </div>
     <div class="row">
        <div class="col-lg-6">
            <label for="name">Region:<span style="color:Red;" class="control-label">&nbsp;*</span></label>
            <select id="region" unique="true" uniqueconditionedby="orgname"  class="chooseOrganization width-100" sourcepath="1" datapath="masterjson.rows.row" valuelinkfield="costcode" style="vertical-align:central"  cdata="catalyst"  cat-validation="required">
             <option value="">Select Region</option>
             <option value="us-west-2">us-west-2</option>
           </select>
           <span data-val-controltovalidate="domainname" id="MainContent_Req_domainname" data-val="true" data-val-evaluationfunction="RequiredFieldValidatorEvaluateIsValid" data-val-initialvalue="" style="visibility:hidden;">Required</span>
         </div>

         <div class="col-lg-6 smart-form" style="">
          <label for="category">Security Group:<span style="color:Red;" class="control-label">&nbsp;*</span></label>
          <div id="securitygroup" multiselect="multiselect" datatype="select" datapath="" class="input-group from-control col-md-12 widthBox" sourcepath="21" cdata="catalyst" cat-validation="onechecked">

          </div>
        </div>

       
     </div>
   </div>
   <!-- end widget div -->
 </div>
 <!-- end widget -->             
</article>
<!-- END COL -->
</div>
<!-- END ROW -->
</section>
<!-- end widget grid -->
</div>
</div>
</div>
<div class="widget-toolbox clearfix">
  <div class="btn-group pull-right">
   <button id="btnsubmit" class="btn btn-primary btn-mini" disabled style="margin-right:11px;" onclick="providerTest();">
     <i class="ace-icon fa fa-check bigger-110"></i>
     Save
   </button>
   <a class="btn btn-primary btn-mini" onclick="window.history.back();" id="btncancel">
     <i class="ace-icon fa fa-undo bigger-110"></i>
     Cancel
   </a>
 </div>
</div>
</div>
</form>
</div>
</div>
</div>
<!--row ends here-->
<!--Popup for selecting a cloud provider before proceeding-->
<script>
   //Form Name
   function cancelClicked() {
     $("#popupSelectProvider").modal('hide');
     $(".modal-backdrop.fade.in").detach();
     $('#btncancel').click();
   }
   function setfolderpath(){ //Uncomment below line to set the folder path to uploaded files.
       var folderpath = ''; //'/' + $('#dockerreponame').val() + "/dockerfiles/";
    //   alert(folderpath);
    $('#folderpath').val(folderpath);
  }
  
function appendLoader(){
   $('#btnsubmit').attr('disabled','disabled').parent().prepend('<label id="masterssavespinner" class="" style="float:left;"><img  style="margin-left:5px;margin-right:25px;margin-top:8px;" src="img/select2-spinner.gif" /></label>');
}
  function loadSecurityGroupID(accesskey,secretkey){
appendLoader();
 
    $.ajax({
      method: "POST",
      url: "/providers/securitygroups",
      data:{ "accesskey": accesskey, "secretkey": secretkey, "region": "us-west-2" }
    }).done(function( msg ) {

      var str='',getTemplate=function(val){
     return '<label class="toggle font-sm"><input onclick="if($(this).is(&quot;:checked&quot;)) {$(this).closest(&quot;label&quot;).'+
     'css(&quot;background-color&quot;,&quot;#eeeeee&quot;);$(this).css(&quot;border-color&quot;,&quot;#3b9ff3&quot;);}else{$(this).closest(&quot;label&quot;).css(&quot;background-color&quot;,&quot;#ffffff&quot;);$(this).css(&quot;border-'+
      'color&quot;,&quot;red&quot;);}" type="checkbox" name="checkbox-toggle" rowid="1ae4f099-7adc-4089-81c6-db2248774142"'+
    'value="'+val+'" style="width:100%"><i data-swchoff-text="NO" data-swchon-text="YES"></i>'+val+'</label>';
  },len=msg.length;
  for(var i=0;i<4;i++){
    console.log(getTemplate(msg[i].GroupId));
    str=str+getTemplate(msg[i].GroupId);
  }
  $('#securitygroup').html('').append(str);
  $('#btnsubmit').removeAttr('disabled');
  $('#masterssavespinner').remove();
});

}

function inLineReady() {
 $("input[type='text']").on("click", function () {
   $(this).select();
   $("#msgOrgName").hide();
 });
 $("#popupSelectProvider").modal({ keyboard: false, backdrop: "static" });
 var ten = 9;
       readformnew('9'); //9 is for Provider
       //

       $('#content').css("opacity", "1 !important");
       //Force opening the left navigation menu
       if ($('#navSettings').is(":visible") == false) {
         $('#navSettings').css("display", '');
         $('#navSettings > ul > li').first().addClass('open');
         $('#navSettings > ul > li > ul').css("display", "none");
         $('#navSettings > ul > li > ul').first().css("display", "block");
       }
       //redrawing the breadcrumb and selecting the tree
       $('#Settings  li').removeClass('active');
       $('#Settings  li').each(function () {

         if ($(this).text().trim() == "Docker"){

           $(this).addClass('active');
         }
       });

       $('#content').css('opacity','1 !important');
      // drawBreadCrumb1();
      enableUniqueCheckingForInputs(9);


    }

    inLineReady();

  </script>
  <script>
   $(document).ready(function () {

    function checkForSecurityGroup(){
      var accesskey=$('#accesskey').val(),
      secretkey=$('#secretkey').val();
      if(accesskey && secretkey && accesskey!=='' && secretkey!==''){
        loadSecurityGroupID(accesskey,secretkey);

      }else{
        $('#btnsubmit').attr('disabled','disabled');

      }
    }

    $('#providertype').select2();
    $('#region').select2();
    $("#providername").focus();

    $('#accesskey').blur(checkForSecurityGroup);
    $('#secretkey').blur(checkForSecurityGroup);

    $('#myForm54').submit(function() {
      $(this).validate();
      if(isFormValid()){
        saveform(9);
      }else{
        alert("invalid form data");
      }
           return false; // for demo
         });
  });
/*
   function providerTest(){
     var inputData = new Object();
     var formID=9;
     var securityList=[];
     
     $('[name="securitygroup"]').each(function(){
      $(this).is(":checked") && securityList.push($(this).val().trim());
    });


     inputData.accesskey = $('#accesskey').val().trim();
     console.log(inputData.accesskey);


     inputData.secretkey = $('#secretkey').val().trim();
     console.log(inputData.secretkey);

//inputData.region = $('#region').val().trim();
console.log(inputData.region);

//inputData.providername=$("#providername").val().trim();
console.log(inputData.providername);

//inputData.providertype=$("#providertype").val().trim();
console.log(inputData.providertype);

//inputData.securitygroupids=securityList;
console.log(securityList);
   //  inputData.type=instancesizes;

   //inputData.instanceUserName='root';
 //  saveform(9);

/* $.ajax({
        url: serviceURL + "savemasterjsonrownew/" + formID + "/" + null + "/" + '%2f',
        data: inputData,
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(data, success) {
           console.log(data);
           alert('success');
        },
        error: function(jqxhr) {
           alert(jqxhr.status);
        },
        failure: function(data) {
            alert(data);
        }
    });

*/
/*
$.ajax({
 url: '/providers/securitygroups',
 type: 'POST',
 dataType: 'json',
 data: inputData,
 async:false,
 success: function (data) {
                         //alert("Success...");
                         if(validateForm())
                          saveform(9);
                      },
                      error: function (err) {
                       bootbox.alert("Invalid UserName or Password.");
                     }
                   });

*/

//}
</script>