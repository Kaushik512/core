
		<div class="row">
			<div class="col-md-12">
				<div class="col-md-12">
					<div class="widget-box">
						<div class="widget-header">
							<h5 class="widget-title" style="color:#4e5964;">
		                   		 <strong>ServiceNow CMDB Management</strong>
		                    </h5>
		                    <div class="widget-toolbar no-border">
		                    	<div>
                            		<a id="newConfig" class="btn btn-minier btn-primary" href="#ajax/Settings/ConfigCMDB.html">
		                                <i class="ace-icon ace-icon fa fa-plus bigger-110"></i>
		                                New
                            		</a>
		                    	</div>
		                    </div>
						</div>
						<div class="widget-body">
							<div class="widget-main" style="min-height:300px">
								<div class="col-md-12 table-responsive" style="padding-left:0px; padding-right:0px;">
									<table id="cmdbtable" class="tableData table table-striped table-bordered table-hover dataTable no-footer tableCenter" cellpadding="5px" width="100%" style="text-align:center">
                                		<thead>
                                    		<tr class="rowCustomStyle">
		                                        <td>ServiceNow Server Name</td>
		                                        <td>User Name</td>
		                                        <td>URL</td>
		                                        <td>Organization</td>
		                                        <td class="">Action</td>
                                    		</tr>
                               			 </thead> 
                               			 <tbody>
			                               	  
                               			 </tbody>        
                            		</table>
                        		</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script>
          $(document).ready(function () {

          	

          	if (!$.fn.dataTable.isDataTable('#cmdbtable')) {
				//var $taskListArea = $('.taskListArea').empty();
				 $trackDatatable = $('#cmdbtable').DataTable({
				    "pagingType": "full_numbers",
				    "bInfo": false,
				    "bLengthChange": false,
				    "paging": false,
				    "bFilter": false,
				    "aoColumns": [{
				        "bSortable": false
				    }, {
				        "bSortable": false
				    }, {
				        "bSortable": false
				    }, {
				        "bSortable": false
				    }, {
				        "bSortable": false
				    }]

				});
				}
			});

          	$.get('/cmdb/list', function(data) {
          	    console.log("In CMDBList::" + data);
                createTableFromJson(data);
          	});

            function createTableFromJson(data){
            	 var $taskbody = $('#cmdbtable').find('tbody');
          	    // $taskbody.empty();

          	    for (i = 0; i < data.length; i++) {

          	        if (data[i].servicenowusername) {

          	            var $tr = $('<tr style="line-height:2.3" class="cmdbRow" id="' + data[i].rowid + '"></tr>');
          	            $tr.append('<td scope="col" style="font-size:12px;">' + data[i].configname + '</td>');

          	            $tr.append('<td scope="col" style="font-size:12px;">' + data[i].servicenowusername + '</td>');

          	            $tr.append('<td scope="col" style="font-size:12px;">' + data[i].url + '</td>');

          	            $tr.append('<td scope="col" style="font-size:12px;">' + data[i].orgname[0] + '</td>');

          	            //$tr.append('<td scope="col" style="font-size:12px;">'+data[i].chefserver+'</td>');

          	            var $td = $('<td></td>');

          	            var $div = $('<div class="btn-group tableactionWidthCheficon"></div');

          	            var $removeButton = '<a class="btn btn-danger pull-left btn-sg ' + 'tableactionbutton removeAction" value="Remove" title="Remove" '
          	                //+'onclick="deleteItem("10", "rowid","'+ data[i].rowid +'",this);"'
          	                + '><i class="ace-icon fa fa-trash-o ' + 'bigger-120"></ i></a>';

          	            var $updateButton = '<a class="btn btn-info pull-left ' + 'tableactionbutton tableactionbuttonpadding btn-sg updateAction" ' + 'title="Update" href="#ajax/Settings/ConfigCMDB.html?' + data[i]._id + '"><i class="ace-icon fa fa-pencil bigger-120"></i></a>';

          	            var $importButton = '<a class="btn btn-sg btn-primary tableactionbutton ' + 'tableactionbuttonpadding importAction" title="Import Nodes" ' + 'href="#ajax/Settings/servicenowSync.html?' + data[i]._id + '"><i class="ace-' + 'icon fa fa-download bigger-120"></i></a>';

          	            $div.append($removeButton);
          	            $div.append($updateButton);
          	            $div.append($importButton);

          	            $td.append($div);
          	            $tr.append($td);

          	            $taskbody.append($tr);
          	            $trackDatatable.row.add($tr).draw();
          	            
          	            $div.find("a.removeAction").on('click', function(e) {
          	            
          	                console.log($(this));
          	                var $tr = $(this).parents('tr');
          	                var id = $tr.attr('id');
          	                console.log(id);
          	                //alert(id);
          	                //alert($tr.length);

          	                $.ajax({
          	                    url: '/servicenow/removeItem/id/' + id,
          	                    type: 'DELETE',
          	                    success: function() {
          	                        console.log("removed tr:", $tr)
          	                        $trackDatatable.row($tr).remove().draw(false);
          	                        console.log('remove action complete');
          	                    }
          	                });

          	                return false;
          	            });
          	        }

          	    }

            }
          

		</script>