<script>
    $(".login-info").hide();
   
</script>
<script src="/private/js/settingscommon.js"></script> 
<h4 style="color:black;">Tracker</h4>

 <form action="" class="smart-form" novalidate="novalidate">
                                                        

 <fieldset>
<div class="row">
    
        <section class="col col-6">
            <label for="category">Organization</label>
            <label class="input">
                <select id="orgname" class="form-control" sourcepath="1" datapath="masterjson.rows.row" linkedfields="['productgroupname']"  cdata="catalyst">
                    <option value="">Select Organization</option>

                </select>
                <span data-val-controltovalidate="domainname" id="MainContent_Req_domainname" data-val="true" data-val-evaluationfunction="RequiredFieldValidatorEvaluateIsValid" data-val-initialvalue="" style="visibility:hidden;">Required</span>
            </label>
        </section>
        <section class="col col-6">
            <label for="category">Business Group</label>
            <label class="input">
                <select id="productgroupname" class="form-control" sourcepath="2" datapath="masterjson.rows.row" linkedto="orgname"  cdata="catalyst">
                    <option value="">Select Business Group</option>
                </select>
                <span data-val-controltovalidate="domainname" id="Span1" data-val="true" data-val-evaluationfunction="RequiredFieldValidatorEvaluateIsValid" data-val-initialvalue="" style="visibility:hidden;">Required</span>
            </label>
         
        </section>
    
</div>
</fieldset>
</form>
<div class="row">
    <hr /><br />
</div>
<div id="page-wrapper">
        <div class="row">
        
      <!--col-lg-3 ends-->





    
     
       <!--heading orange ends-->
        <!--Circle-tile ends--> 
      <!-- col-lg-3 ends-->
        
    <div class="col-lg-3">
    <div class="circle-tile">
    <a href="#">
       <div class="circle-tile-heading light-blue">
       <i class="fa fa-inbox fa-fw fa-3x"></i>
       </div></a>
        <div class="circle-tile-content light-blue">
        <div class="circle-tile-description text-faded"><a href="#ajax/Settings/EnvironmentList.html">ENVIRONMENTS</a></div>
        <div class="circle-tile-number text-faded envCount"  itemid="3">
            
        </div>
        
   </div>
    </div>    
        </div>


    <div class="col-lg-3">
      <div class="circle-tile">
    <a href="#">
       <div class="circle-tile-heading light-black">
       <i class="fa fa-shopping-cart fa-fw fa-3x"></i>
       </div>
    </a>
        <div class="circle-tile-content light-black">
            <div class="circle-tile-description text-faded"><a href="#ajax/Settings/ProjectList.html">Projects</a>
            </div>
        <div class="circle-tile-number text-faded projectCount"  itemid="4">
            
        </div>
        
      
        </div>
        </div>
        </div>    

    <div class="col-lg-3">
    <div class="circle-tile" >
        <a href="#">
    <div class="circle-tile-heading light-blue">
    <i class="fa fa-group fa-fw fa-3x"></i>
    </div></a>
    
        <div class="circle-tile-content light-blue" onclick="$(this).closest('a').trigger('click')">
        <div class="circle-tile-description text-faded"><a href = "#ajax/Settings/OrgList.html"> INSTANCES </a></div>
        <div class="circle-tile-number text-faded organizationcount" itemid="1">
           
        </div>
        
    </div>
        </div> <!--heading dark-blue ends-->
    
    </div>

    <div class="col-lg-3">
    <div class="circle-tile" >
        <a href="#">
    <div class="circle-tile-heading light-black">
    <i class="fa fa-group fa-fw fa-3x"></i>
    </div></a>
    
        <div class="circle-tile-content light-black" onclick="$(this).closest('a').trigger('click')">
        <div class="circle-tile-description text-faded"><a href = "#ajax/Settings/OrgList.html"> USERS </a></div>
        <div class="circle-tile-number text-faded organizationcount" itemid="1">
           
        </div>
        
    </div>
        </div> <!--heading dark-blue ends-->
    
    </div>


      </div> <!--row ends-->
    <div class="row">
        <div class="widget-box" id="divinstancestableview">
            <div class="widget-body">
                <div class="widget-main" style="min-height:300px"> 
                    <div class="col-md-12" style="padding-left:0px; padding-right:0px;padding-top:50px">
                        <div class="table-responsive table-div" >

                                <table id="tabletrackerinstanceview" class="table table-striped table-bordered table-hover dataTable" cellpadding="5px" width="100%" style="border:1px solid #eeeeee !important">
                                    <thead>
                                        <tr class="rowCustomStyle" style="font-weight:bold;">
                                            <td>S.No.</td>
                                            <td>Org Name</td>
                                            <td>BG Name</td>
                                            <td>Project Name</td>
                                            <td>Env Name</td>
                                            <td>Name</td>
                                            <td>IPAddress</td>
                                            <td>Status</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                       
                                    </tbody>
                                    
                                   
                                </tbody>
                                
                            </table>
                        </div>
                   </div>
                </div> 
                
            </div>
            <div class="widget-toolbox padding-8 clearfix">
                   <div id="tableFooterLeft" class="pull-left"></div>
                   <div id="tableFooterRight" class="pull-right"></div>
                </div>
        </div>
    </div><!--table view row ends-->
   
</div>
<style type="text/css">
#content{
	opacity: 2 !important;
}
</style>
<script type="text/javascript">
         var serviceURL = "/d4dMasters/";
         window.selectedOrgName = 'Settings'; 
       	
				$('[itemid]').each(function(){
				    var count = getCount($(this).attr('itemid'));    
				    $(this).html(count);
				});
</script>
<script type="text/javascript">

// $(document.body).on('click', '.card', function () {
      
//       document.querySelector('#flip-toggle').classList.toggle('flip');
//   });

//setting the workzone link to current page
//alert(window.location.href);
//alert('what is this');
var wzlink = window.location.href.split('#')[1];
//alert(wzlink);
$('li[navigation*="Workspace"]').find('a').attr('href','#' + wzlink);

var urlParams = {};
(window.onpopstate = function() {
    var url = window.location.href;
    var indexOfQues = url.lastIndexOf("?");
    if (indexOfQues != -1) {
        var sub = url.substring(indexOfQues + 1);
        console.log(sub);
        var params = sub.split('&')
        for (var i = 0; i < params.length; i++) {
            var paramParts = params[i].split('=');
            urlParams[paramParts[0]] = paramParts[1];
        }
    }

})();
console.log(urlParams);
var projectId = urlParams['projid'];
var envId = urlParams['envid'];
//alert(projectId + ':' + envId);
function addInstanceToDOM(data,index) {
  //Get the Orgname - to be removed eventually
 
  var $rowContainter = $('<tr data-instanceId="' + data._id + '"></tr>');
  $rowContainter.append($('<td></td>').append(index));
      $rowContainter.append($('<td></td>').append(''));
          $rowContainter.append($('<td></td>').append(''));
          
  $rowContainter.append($('<td></td>').append(data.projectId)); //envId , chefNodeName,, instanceIP, instanceState
  $rowContainter.append($('<td></td>').append(data.envId));
  $rowContainter.append($('<td></td>').append(data.chefNodeName));
  $rowContainter.append($('<td></td>').append(data.instanceIP));
  $rowContainter.append($('<td></td>').append(data.instanceState));
  $("#tabletrackerinstanceview").append($rowContainter);


}





$.get('/instances', function(data) {

    
    for (var i = 0; i < data.length; i++) {
        addInstanceToDOM(data[i],i+1);
    }
    //for table view
    if (!$.fn.dataTable.isDataTable('#tabletrackerinstanceview')) {
        var tabletrackerinstanceview = $('#tabletrackerinstanceview').dataTable({
            "pagingType": "full_numbers"
        });
    }
    $('#tabletrackerinstanceview tbody').on('click','tr',function(){
        if($(this).hasClass('rowcustomselected')){
            $(this).removeClass('rowcustomselected');
        }
        else{
            tabletrackerinstanceview.$('tr').removeClass('rowcustomselected');
            $(this).addClass('rowcustomselected');
        }

    });

    


});
</script>
 
    
		<!-- MAIN APP JS FILE -->

         
         
         <script>
         function inLineReady()
         {
          readform(4);
         //Force opening the left navigation menu
          if ($('#navSettings').is(":visible") == false) {
              $('#navSettings').css("display", '');
              $('#navSettings > ul > li').first().addClass('open');
              $('#navSettings > ul > li > ul').css("display", "none");
              $('#navSettings > ul > li > ul').first().css("display", "block");
          }
          //redrawing the breadcrumb and selecting the tree
          $('#ulsettingstree > li').removeClass('active');
          $('#ulsettingstree > li').each(function () {
              if ($(this).text().trim() == "Projects")
                  $(this).addClass('active');
          });
          drawBreadCrumb1();
         }

    inLineReady();
</script>


    
  <!-- end scripts -->
