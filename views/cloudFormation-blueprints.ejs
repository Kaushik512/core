<style type="text/css">
.cloudFormation_blueprintsContainer {
	padding-top: 30px;
}
.cloudFormationBlueprintLaunchResultArea {
	display: none;
}
#bluePrintsListCloudFromation{
  width: 200px;
}

</style>
<div class="cloudFormation_blueprintsContainer"> 
 

<form class="form-horizontal cloudFormationBlueprintListContainer" role="form">
  <div class="form-group">
    <label for="bluePrintsListCloudFromation" class="col-sm-2 control-label">Blueprints</label>
    <div class="col-sm-10">
      <select class="form-control" id="bluePrintsListCloudFromation">
        <option>Choose</option>
        <% if(domains && domains.length) {
        for(var i=0;i<domains.length;i++) {
             if(domains[i].bluePrintsCloudFormation && domains[i].bluePrintsCloudFormation.length) {

                for(var j=0;j<domains[i].bluePrintsCloudFormation.length;j++) {

            %>
            <option data-pid="<%=domains[i].domainPid%>" data-domainName="<%=domains[i].domainName%>" value="<%=domains[i].bluePrintsCloudFormation[j].blueprintName%>"><%=domains[i].bluePrintsCloudFormation[j].blueprintName%></option>
       <%}}}}%>
      </select>
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <input type="button" class="btn btn-default cloudFormationBluePrintLaunchBtn" value="Launch" />
    </div>
  </div>
</form>
<div class="cloudFormationBlueprintLaunchResultArea"></div>

</div>

<script type="text/javascript">

(function(){
	$('.cloudFormationBluePrintLaunchBtn').click(function(e){
      
      var $selectedOptionTag = $('#bluePrintsListCloudFromation').find(':selected');  
      if(!$selectedOptionTag.length) {
         return;  
      }
       console.log($selectedOptionTag.get(0));
      if($selectedOptionTag.val() === 'Choose') {
        return;
      }


      $('.cloudFormationBlueprintListContainer').hide();
      var $appStoreLaunchResultArea = $('.cloudFormationBlueprintLaunchResultArea').empty().append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />').show();
      

     
     
      $.post('/aws/cloudformation/blueprints/launch',{
        pid:$selectedOptionTag.attr('data-pid'),
        domainName:$selectedOptionTag.attr('data-domainName'),
        blueprintName:$selectedOptionTag.val()
      },function(data){
        var $message = $('<div class="instance-result"><div class="alert alert-success fade in instanceSuccess" id="stackMessage" style="margin: 10px 25px;"><strong>Congratulations!</strong>&nbsp;Stack Created Successfully.<br/><strong>Stack Id : </strong><span>'+data+'</span></div></div>'); 
        $appStoreLaunchResultArea.empty().append($message);

      }).error(function(){
         var $message = $('<div class="instance-result"><div class="alert alert-danger fade in instanceSuccess" id="stackMessage" style="margin: 10px 25px"><strong>Error!</strong>&nbsp;Unable to create stack.</div></div>');  
            $appStoreLaunchResultArea.empty().append($message);
      });    
 
    });
   

})();
</script>