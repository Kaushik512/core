<style>

.domain-role-thumbnail {
border-radius: 5px;
    float: left;
    margin-bottom: 20px;
    margin-right: 20px;
    max-height: 145px;
    max-width: 109px;
    width: 41%;
}
.domain-roles {
  background-image: linear-gradient(to bottom, #F9F9F9 0%, #EDEBF4 100%);
    border: 1px solid #DDDDDD;
    border-radius: 4px;
    display: block;
    line-height: 1.42857;
    margin-bottom: 20px;
    margin-left: 4px;
    margin-top: 3px;
    max-width: 100px;
    min-height: 145px;
    padding-bottom: 4px;
    padding-left: 4px;
    padding-right: 4px;
    text-align: center;
    transition: all 0.2s ease-in-out 0s;
}
.domain-roles-caption {
  text-align: center;
}
.domain-roles-heading {
  font-size: 12px;
    overflow: hidden;
    padding-bottom: 2px;
    padding-top: 2px;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.instance-inactive {
  color:red;
}
.instance-active {
  color:green;
}
.instance-details-list {
  border-top: 1px solid;
    font-size: 10px;
    padding-top: 10px;
    text-align: center;
    padding-bottom: 10px;
}
.instance-details-item {
  display: block;
}
.instance-bootstrap-list{
  border-top: 1px solid;
    font-size: 10px;
    padding-top: 10px;
    text-align: center;
}
</style>


<% if(!error) {  
 
 function getRolesLink(role,domainName,ip) {
  
  switch(role) {
      case 'JIRA':
      return '<a href="http://'+ip+':8080/">'+role+'</a>'
      case 'Crowd':
      return '<a href="http://'+ip+':8090/">'+role+'</a>';   
      case 'Confluence':
      return '<a href="http://'+ip+':8090/">'+role+'</a>';
      case 'Jenkins':
      return '<a href="http://'+ip+':8080/">'+role+'</a>';
      case 'Nexus':
       return '<a href="http://'+ip+':8081/">'+role+'</a>';
      case 'Rundeck':
       return '<a href="http://'+ip+':8090/">'+role+'</a>';
      case 'Nagios':
       return '<a href="http://'+ip+'/">'+role+'</a>';
      case 'Selenium':
       return '<a href="http://'+ip+':4444/">'+role+'</a>';
      default: 
       return '<span>'+role+'</span>';

     }

}


 console.log('pid==>'+pid);
  if(!domains.length && (pid != '3' && pid != '1' && pid != '4' && pid != '5' && pid != '2')) {
  %><div class="alert alert-info fade in instanceSuccess" style="margin: 10px 25px;">No domains found</div>
<% } else {
 %>
 <div class="panel-group" id="accordion">
  <%
    var firstPanelOpen=false;
    var collapseClassName;

    console.log(pid);
    if(pid === '1') {
  %>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#domainPanelpid1">
          conztanz.relevancelab.com
        </a>&nbsp;<a href="http://conztanz.relevancelab.com/" target="_blank"><img src="img/openLinkBl.png" style="height: 14px ;width: 14px;margin-bottom: 3px;"/></a>
      </h4>
    </div> 
     <div id="domainPanelpid1" class="panel-collapse collapse in">
      <div class="panel-body">
        <ul class="thumbnails list-unstyled">
          <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Planning">Planning</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>i-371f2617</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://conztanz.relevancelab.com/" >JIRA</a></span> 
                <span class="instance-details-item"><a href="http://conztanz.relevancelab.com/" >JIRA Agile</a></span> 
                <span class="instance-details-item"><a href="http://conztanz.relevancelab.com/" >Crowd</a></span> 
                <span class="instance-details-item"><a href="http://conztanz.relevancelab.com/" >Confluence</a></span>
              </div>
              </div>
              </div>
            </li>
            <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Build">Build</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>i-bc271e9c</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://conztanz.relevancelab.com/" >Jenkins</a></span> 
                <span class="instance-details-item"><a href="http://conztanz.relevancelab.com/" >Nexus</a></span> 
                <span class="instance-details-item"><a href="http://conztanz.relevancelab.com/" >Rundeck</a></span> 
                <span class="instance-details-item"><a href="http://conztanz.relevancelab.com/" >DevOps Apps</a></span>
              </div>
              </div>
              </div>
              </li> 


        </ul>
      </div>
    </div>
  </div>

   <% firstPanelOpen = true; 
    } else if(pid === '2') { %>
         <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#domainPanelpid2">
         rlevaldevops.cloudapp.net
        </a>&nbsp;<a href="http://rlevaldevops.cloudapp.net/" target="_blank"><img src="img/openLinkBl.png" style="height: 14px ;width: 14px;margin-bottom: 3px;"/></a>
      </h4>
    </div> 
     <div id="domainPanelpid2" class="panel-collapse collapse in">
      <div class="panel-body">
        <ul class="thumbnails list-unstyled">
          <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Planning">Planning</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>i-n54i09</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://rlevaldevops.cloudapp.net/" >A2A</a></span> 
              </div>
              </div>
              </div>
            </li>
        </ul>
      </div>
    </div>
  </div>
    <% firstPanelOpen = true;
    } 
    else if(pid === '3') {
    %>
      <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#domainPanelpid31">
          rlrnd.relevancelab.com
        </a>&nbsp;<a href="http://192.168.101.43/" target="_blank"><img src="img/openLinkBl.png" style="height: 14px ;width: 14px;margin-bottom: 3px;"/></a>
      </h4>
    </div> 
     <div id="domainPanelpid31" class="panel-collapse collapse in">
      <div class="panel-body">
        <ul class="thumbnails list-unstyled">
          <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Planning">Planning</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>RLD3MONS01</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://192.168.101.43/" >JIRA</a></span> 
                <span class="instance-details-item"><a href="http://192.168.101.43/" >JIRA Agile</a></span> 
                <span class="instance-details-item"><a href="http://192.168.101.42/" >Crowd</a></span> 
              </div>
              </div>
              </div>
            </li>
            <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Build">Build</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>RLD2MGMT01</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://192.168.101.42/" >Jenkins</a></span> 
                <span class="instance-details-item"><a href="http://192.168.101.42/" >Nexus</a></span> 
              </div>
              </div>
              </div>
              </li> 
              <li class="domain-role-thumbnail">
               <div class="domain-roles">
               <div class="domain-roles-caption">
               <div class="domain-roles-heading" title="Monitoring">Monitoring</div>
               <div class="instance-details-list">
               <span class="instance-details-item"> Id : <strong>RLTESTSRV03</strong> </span>
               <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://192.168.101.55/" >Zabbix</a></span> 
              </div>
              </div>
              </div>
              </li> 


        </ul>
      </div>
    </div>
  </div>

   <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#domainPanelpid32">
          rleval.relevancelab.com
        </a>&nbsp;<a href="http://192.168.103.34/" target="_blank"><img src="img/openLinkBl.png" style="height: 14px ;width: 14px;margin-bottom: 3px;"/></a>
      </h4>
    </div> 
     <div id="domainPanelpid32" class="panel-collapse collapse">
      <div class="panel-body">
        <ul class="thumbnails list-unstyled">
          <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Planning">Planning</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>i-611f2zf7</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://192.168.103.34/" >JIRA</a></span> 
                <span class="instance-details-item"><a href="http://192.168.103.34/" >JIRA Agile</a></span> 
                <span class="instance-details-item"><a href="http://192.168.103.34/" >Confluence</a></span> 
              </div>
              </div>
              </div>
            </li>
            <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Build">Build</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>i-b5201g9c</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://192.168.103.33/" >Jenkins</a></span> 
                <span class="instance-details-item"><a href="http://192.168.103.33/" >Orch</a></span> 
                <span class="instance-details-item"><a href="http://192.168.103.35/" >Rundeck</a></span> 
              </div>
              </div>
              </div>
              </li> 
              <li class="domain-role-thumbnail">
               <div class="domain-roles">
               <div class="domain-roles-caption">
               <div class="domain-roles-heading" title="Monitoring">Monitoring</div>
               <div class="instance-details-list">
               <span class="instance-details-item"> Id : <strong>i-n2675g9c</strong> </span>
               <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://192.168.101.55/" >Zabbix</a></span> 
              </div>
              </div>
              </div>
              </li> 


        </ul>
      </div>
    </div>
  </div>


    <%
    firstPanelOpen = true; 
     } else if(pid === '4') {
    %>
    <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#domainPanelpid4">
         rlopenstack.relevancelab.com
        </a>&nbsp;<a href="http://192.168.150.240" target="_blank"><img src="img/openLinkBl.png" style="height: 14px ;width: 14px;margin-bottom: 3px;"/></a>
      </h4>
    </div> 
     <div id="domainPanelpid4" class="panel-collapse collapse in">
      <div class="panel-body">
        <ul class="thumbnails list-unstyled">
          <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Planning">Planning</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>i-19m2w6</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://192.168.150.240" >JIRA</a></span> 
              </div>
              </div>
              </div>
            </li>
        </ul>
      </div>
    </div>
  </div>

   <% firstPanelOpen = true; 
} else if(pid === '5') { %><!-- ends here if -->
 <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#domainPanelpid5">
         rlcloudstack.relevancelab.com
        </a>&nbsp;<a href="http://192.168.101.44" target="_blank"><img src="img/openLinkBl.png" style="height: 14px ;width: 14px;margin-bottom: 3px;"/></a>
      </h4>
    </div> 
     <div id="domainPanelpid5" class="panel-collapse collapse in">
      <div class="panel-body">
        <ul class="thumbnails list-unstyled">
          <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="Planning">Planning</div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong>i-s295i2</strong> </span>
              <span class="instance-details-item"> Instance : <span class="instance-active">active</span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
                <span class="instance-details-item"><a href="http://192.168.101.44" >JIRA</a></span> 
              </div>
              </div>
              </div>
            </li>
        </ul>
      </div>
    </div>
  </div> 

 <% 
   firstPanelOpen = true; 
 }
 for(var i=0;i<domains.length;i++) {
   var domain = domains[i];
   
   if(domain.domainInstances && domain.domainInstances.length) {
    collapseClassName = ''
    if(!firstPanelOpen) {
     
      collapseClassName = 'in';
      firstPanelOpen = true;
    }
   %>
   
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" href="#domainPanel<%=i%>">
          <%=domain.domainName%>
        </a>&nbsp;<a id="domainPanelAnchor<%=i%>" href="#" target="_blank" style="display:none"><img src="img/openLinkBl.png" style="height: 14px ;width: 14px;margin-bottom: 3px;"/></a>
      </h4>
    </div> 
   
   <div id="domainPanel<%=i%>" class="panel-collapse collapse <%=collapseClassName%>">
      <div class="panel-body">
        <ul class="thumbnails list-unstyled">
         <% var instances = domain.domainInstances;
            for(var j=0;j<instances.length;j++) {
          %>
          <li class="domain-role-thumbnail">
            <div class="domain-roles">
            <div class="domain-roles-caption">
              <div class="domain-roles-heading" title="<%=instances[j].instanceRole%>"><%=instances[j].instanceRole%></div>
              <div class="instance-details-list">
              <span class="instance-details-item"> Id : <strong><%=instances[j].instanceId%></strong> </span>
              <%
                if(instances[j].instanceRole === 'Planning') {
               %><script>
                 console.log('i m here');
                $('#domainPanelAnchor<%=i%>').attr('href','http://<%=instances[j].instanceIP%>:8080');
                $('#domainPanelAnchor<%=i%>').show();
               </script>
               <%}

               var classInstanceStatus = 'instance-inactive' 
               var instanceStatusText = 'inactive'
               if(instances[j].instanceActive) {
                 classInstanceStatus = 'instance-active';
                 instanceStatusText = 'active';
               }
              %>
              <span class="instance-details-item"> Instance : <span class="<%=classInstanceStatus%>"><%=instanceStatusText%></span> </span>
              
              </div>
              <div class="instance-bootstrap-list">
               <% 
                if(instances[j].bootStrapStatus) {
                 for(var k=0;k<instances[j].runlist.length;k++) {
                  var d = getRolesLink(instances[j].runlist[k],domain.domainName,instances[j].instanceIP);
                 %>
                 <span class="instance-details-item"><%-d%></span> 
                 <%}
               } else {
               %><span class="instance-inactive">Bootstrapping Failed</span>
             <% } %>
              </div>
            </div>
          </div>
            </li>
            <%
          }
            %>

 
         </ul> 

      </div>
    </div>
  </div>
  <%}}%>
</div>
<%}}%>


