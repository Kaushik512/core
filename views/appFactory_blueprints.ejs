<style type="text/css">
.appFactory_blueprintsContainer {
	padding-top: 30px;
}
.appFactBlueprintLaunchResultArea {
	display: none;
}
#bluePrintsList{
 width: 200px; 
}

</style>
<div class="appFactory_blueprintsContainer"> 
 

<form class="form-horizontal appFactBlueprintListContainer" role="form">
  <div class="form-group">
    <label for="bluePrintsList" class="col-sm-2 control-label">Blueprints</label>
    <div class="col-sm-10">
      <select class="form-control" id="bluePrintsList">
        <option>Choose</option>
        <% if(domains && domains.length) {
        for(var i=0;i<domains.length;i++) {
             if(domains[i].blueprintsAppFactory && domains[i].blueprintsAppFactory.length) {

                for(var j=0;j<domains[i].blueprintsAppFactory.length;j++) {

            %>
            <option data-pid="<%=domains[i].domainPid%>" data-domainName="<%=domains[i].domainName%>" value="<%=domains[i].blueprintsAppFactory[j].blueprintName%>"><%=domains[i].blueprintsAppFactory[j].blueprintName%></option>
       <%}}}}%>
      </select>
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button type="submit" class="btn btn-default appFactbluePrintLaunchBtn">Launch</button>
    </div>
  </div>
</form>
<div class="appFactBlueprintLaunchResultArea"></div>

</div>

<script type="text/javascript">

(function(){
	$('.appFactbluePrintLaunchBtn').click(function(e){

      var $selectedOptionTag = $('#bluePrintsList').find(':selected');  
      if(!$selectedOptionTag.length) {
         return;  
      }
       console.log($selectedOptionTag.get(0));
      if($selectedOptionTag.val() === 'Choose') {
        return;
      }
         
     $('.appFactBlueprintListContainer').hide();
      var $appStoreLaunchResultArea = $('.appFactBlueprintLaunchResultArea').empty().append('<img class="center-block" style="height:50px;width:50px;margin-top: 10%;margin-bottom: 10%;" src="img/loading.gif" />').show();
 
      $.post('/app_factory/bluePrint/launch',{
        pid:$selectedOptionTag.attr('data-pid'),
        domainName:$selectedOptionTag.attr('data-domainName'),
        blueprintName:$selectedOptionTag.val()
      },function(data){
        var $message = $('<div class="instance-result"><div class="alert alert-success fade in instanceSuccess" id="stackMessage" style="margin: 10px 25px;"><strong>Congratulations!</strong>&nbsp;Stack Created Successfully.<br/><strong>Stack Id : </strong><span>'+data+'</span></div></div>'); 
        $appStoreLaunchResultArea.empty().append($message);

      }).error(function(){
         var $message = $('<div class="instance-result"><div class="alert alert-danger fade in instanceSuccess" id="stackMessage" style="margin: 10px 25px"><strong>Error!</strong>&nbsp;Unable to create stack.</div></div>');  
            $appStoreLaunchResultArea.empty().append($message);
      });   

     
    });
})();
</script>